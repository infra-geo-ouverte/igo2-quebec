{"version":3,"file":"main.c313aa44da75d9e2.js","mappings":"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WG,MAAMuY,2CAA6B,0BAA7BA,gCAjBTb,KACA1X,KACAwY,KACAR,KACAD,KACA7X,KACAzH,MACAA,MACArD,KACAA,KACAqD,MACArD,wBCuBG,MAAMqjB,2CAAmB,0BAAnBA,gCA3BTf,KACA1X,KACA+X,KACAhG,KACAiG,KACA9X,KACA9K,KACAA,KACA6iB,KACA7iB,KACAqD,MAEAigB,MACAxY,KACAzH,MACAA,MACArD,KACAA,KACA6K,KACAxH,gBACA8f,EACAI,SC6EG,MAAMC,2CAAY,0BAAZA,iCAxBA,IACTngB,UAAqC,EACrCA,UAA2B,EAC3BA,UAA4B,EAC5BA,UAAkC,EAClCA,UAA4B,EAC5BA,UAAkC,EAClCA,UAAqC,EACrCA,UAAyB,EACzBA,UAA2B,EAC3BA,SACAA,SACAA,UAA8C,EAC9CA,UAA2C,EAC3CA,SACAA,MACAA,SACAA,OAAwB,CACtB0e,KAAM,8BAETmB,SA3DCZ,KACAM,KACAD,KACA/X,KACAE,KACAzH,MACAA,MACArD,KACAA,KACA6K,KACAgY,KACAA,KACAL,EACAM,EACAzf,MACArD,KACAqD,MACAA,gBACAA,gBACAwf,KACAlG,KACA1f,KACA+C,KACAqD,MACAof,EACAC,EACAW,EACArjB,KACAA,KACAA,KACAA,KACAA,KACAA,KAEA6K,KACAA,KACAA,KACAA,QCvEG,MAAM4Y,2CAAU,0BAAVA,gCAZTnB,KACAL,EACAuB,EACAnB,EACAG,EACAD,MAIAN,KCKG,MAAMyB,GAA2B,CACtCC,YAAY,EACZC,IAAK,CACHC,IAAK,CACHpT,eAAe,EACfqT,IAAK,CACHC,SAAS,EACTC,SAAS,IAGbC,SAAU,CACRC,OAAQ,CAAC,YAAa,yBAExBC,cAAe,CACbC,UAAW,CACTC,WAAW,GAEbC,cAAe,CACbP,SAAS,EACTM,WAAW,GAEbE,SAAU,CACRC,UAAW,8CACXC,MAAO,EACPlS,OAAQ,CACNmS,MAAO,MAGXC,mBAAoB,CAClBC,sBAAsB,GAExBC,gBAAiB,CACfD,sBAAsB,EACtBJ,UAAW,6CACXC,MAAO,EACPV,SAAS,GAEXe,OAAQ,CACNN,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,CACtB0e,KAAM,6BAER,CAAEiB,QAASJ,KAA6BK,SAlFmB,CAC7DsF,UAAW,IACXC,UAAW,EACXC,kBAAmB,EACnBC,6BAA6B,KA+E5BxF,SAtCCyF,KACAC,KACA1G,aAAqB,IACrBpX,eACAA,KACA9K,KACAA,KACAwjB,EACAmF,KACAtG,EACAG,EACAiB,EACAoF,eAA6B,iBAAkB,CAC7C9E,QAASL,uBACToF,qBAAsB,uCC5DxBpF,kBACF3pB,SAGF4uB,OACGI,gBAAgBnB,GAChBoB,MAAMC,GAAOza,QAAQC,IAAIwa,GAAI,mBCdhC,OACA,aACA,gBACA,WACA,eACA,kBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,cACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,aACA,gBACA,YACA,eACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,gBACA,mBACA,gBACA,mBACA,eACA,kBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,cACA,iBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,mBACA,gBACA,WACA,cACA,aACA,gBACA,aACA,gBACA,YACA,eACA,mBACA,sBACA,kBACA,qBACA,aACA,gBACA,aACA,gBACA,WACA,cACA,aACA,gBACA,aACA,gBACA,gBACA,mBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,aACA,gBACA,iBACA,oBACA,gBACA,mBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,kBACA,qBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,cACA,iBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,gBACA,mBACA,cACA,iBACA,aACA,gBACA,cACA,iBACA,cACA,kBACA,qBACA,iBACA,gBACA,mBACA,aACA,gBACA,aACA,gBACA,aACA,kBACA,qBACA,gBACA,aACA,gBACA,mBACA,sBACA,aACA,gBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,oBAIA,cACA,WACA,WACA,CACA,cACA,cACA,8CACA,gCACA7oB,CACA,CACA,WACA,CACA8oB,kBACA,qBACA,EACAA,YACAC,YACAD","names":["HomeComponent","constructor","selectors","core","AboutComponent","PwaService","platform","updates","languageService","configService","confirmDialogService","this","isEnabled","interval","subscribe","checkForUpdate","modalUpdatePWA","message","translate","instant","open","confirm","activateUpdate","then","window","navigator","onLine","document","location","reload","alert","setTimeout","checkForUpdates","versionUpdates","pipe","filter","evt","type","initPwaPrompt","getConfig","IOS","addEventListener","event","preventDefault","promptEvent","listenToUserAction","once","showPrompt","prompt","userChoice","factory","FooterComponent","LegendButtonComponent","dialog","toggleDialog","getDialogById","dialogRef","close","LegendButtonDialogComponent","id","hasBackdrop","closeOnNavigation","ctx","mapState","map","layers$","ngOnInit","mapLayersShownInLegend","layers","layer","showInLayerList","MapOverlayComponent","contextService","mediaService","ngAfterViewInit","context$$","context$","context","handleContextChange","media$$","media$","media","ngOnDestroy","unsubscribe","mapOverlay","overlay","getMedia","includes","push","SearchResultsToolComponent","searchState","elRef","toolState","directionState","BehaviorSubject","GeoJSON","hasFeatureEmphasisOnSelection","store","featureTitle","feature","igo2_common","feature$","stateView","firstBy$","e","state","focused","element","entity","data","topPanelState","value","topPanelState$","next","termSplitter","searchTermSplitter$","searchStore","searchTerm$$","searchTerm$","searchTerm","term","res","all$","get","selected","searchSettingsChange$","settingsChange$","topPanelState$$","igoList","computeElementRef","isScrolledIntoView","adjustTopPanel","focusedOrResolution$$","combineLatest","focusedResult$","viewController","resolution$","bunch","buildResultEmphasis","selectedOrResolution$$","selectedResult$","monitorResultOutOfView","showResultsGeometries$$","searchResultsGeometryEnabled$","searchResultsGeometryEnabled","searchResults","clearFeatureEmphasis","shownResultsGeometries","result","queryResultsOverlay","removeFeature","meta","dataType","igo2_geo","geometry","style","Object","assign","searchOverlayStyle","_a","base","addFeature","debouncedEmpty$$","empty$","debounceTime","empty","debouncedEmpty$","isSelectedResultOutOfView$$","state$","selectedResult","selectedOlFeature","projection","selectedOlFeatureExtent","isSelectedResultOutOfView$","trigger","olGeometry","getGeometry","getExtent","extent","x","y","feature1","Feature","name","Point","abstractResult","computedStyle","zIndexOffset","searchOverlayStyleFocus","focus","_b","searchOverlayStyleSelection","_c","selection","setZIndex","searchResultsOverlay","abstractFocusedResult","abstractSelectedResult","shownResultsEmphasisGeometries","shownResult","getRoute$$","onResultFocus","dataSource","ol","getFeatureById","setStyle","onResultUnfocus","onResultSelect","clear","tryAddFeatureToMap","onSearch","results","newResults","entities$","source","research","concat","load","all","update","nativeElement","querySelector","moreResults","request","getId","scrollTop","offsetTop","offsetHeight","clientHeight","items","getElementsByTagName","selectedItem","i","length","className","elemSource","elem","children","toggleTopPanel","zoomToFeatureExtent","localOlFeature","format","readFeature","dataProjection","featureProjection","docViewTop","docViewBottom","elemTop","getRoute","toolbox","activateTool","stopsStore","clearStops","routingCoordLoaded","storeInitialized$","init","stop","find","position","coord","coordinates","point","es","text","geolocationController","position$","currentPos","currentCoord","ol_proj","join","__decorate","title","icon","igo2_integration","igo2_core","SideResultComponent","mapService","layerService","searchService","center","zoom","setMap","hasToolbox","createAsyncLayer","sourceOptions","osmLayer","_map","opened","_opened","openedChange","emit","isTouchScreen","onPointerSummaryStatusChange","igoSearchPointerSummaryEnabled","onSearchTermChange","replace","trim","selectedFeature","updateAll","updateMany","onSearchSettingsChange","setFeatures","handler","onSearchCoordinate","bind","onOpenGoogleMaps","args","onOpenGoogleStreetView","destroy","removeFeatureFromMap","onContextMenuOpen","mapPosition","getMap","getCoordinateFromPixel","mapProjection","lonlat","contextmenuPoint","mapBrowser","getBoundingClientRect","top","scrollY","left","scrollX","onPointerSearch","reverseSearch","_results","$event","BottomResultComponent","catalogState","projectionService","showSearchBar","panelOpenState","console","log","PortalComponent","route","workspaceState","authService","dataSourceService","capabilitiesService","contextState","queryState","searchSourceService","importService","http","messageService","dialogWindow","storageService","breakpointObserver","pwaService","pageSize","pageSizeOptions","layout","observe","mobileBreakPoint","tap","distinctUntilChanged","hasFooter","hasLegendButton","hasSideSearch","showMenuButton","hasExpansionPanel","hasHomeExtentButton","hasGeolocateButton","showRotationButtonIfNoRotation","forceCoordsNA","getBaseLayersUseStaticIcon","sidenavOpened","sidenavOpened$","auth","isMobile","isTablet","isLandscape","getOrientation","isPortrait","backdropShown","expansionPanelExpanded","workspacePanelExpanded","setPadding","bottom","toastPanelShown","expansionPanelBackdropShown","toastPanelForExpansionOpened","workspace","workspace$","actionbarMode","actionbarWithTitle","workspaceStore","IGO","readQueryParams","tracking","authenticate$","authenticated","contextLoaded","queryParams","params","readLanguageParam","onChangeContext","contextActions","searchCoordinate","contextMenuCoord","openGoogleMaps","openGoogleStreetView","contextMenuStore","onSettingsChange$","setSearchSettingsChange","closeSidenav","workspaceEnabled$","workspaceEmpty","updateMapBrowserClass","activeWks","selectedWorkspace$","options","paginatorOptions","_d","activeWidget$$","activeWorkspaceWidget$","widget","openToastPanelForExpansion","showToastPanelForExpansionToggle","closeToastPanelForExpansion","openSidenav$$","openSidenav$","openSidenav","sidenavMediaAndOrientation$$","orientation$","computeToastPanelOffsetX","breakpoint$","breakpointChanged","initSW","dataDownload","downloadMessage","currentVersion","dataLoadSource","serviceWorker","ready","registration","concatMap","ngsw","datas$","appData","version","cachedDataVersion","assetGroups","assetGroup","urls","files","f","url","delay","zip","remove","toastId","success","timeOut","set","isMatched","currentBreakpoint","mobile","Promise","resolve","toastPanelOffsetX$","getToastPanelExtent","createFeatureProperties","properties","sourceFields","forEach","field","primary","visible","entitySortChange","workspaceEntitySortChange$","workspaceMaximize$$","cancelOngoingAddLayer","addedLayers$$","sub","onBackdropClick","onToggleSidenavClick","toggleSidenav","routeParams","search","deactivateCustomFilterTermStrategy","setSearchTerm","onClearSearch","onBeforeSearch","isReverseSearch","enabledSources","getEnabledSources","padding","toolChanged","tool","searchBar","computeHomeExtentValues","view","homeExtent","homeCenter","homeZoom","entityStore","softClear","qParams","uri","readLayersQueryParams","contextManager","getTool","toolToOpen","toolToOpenOnContextChange","toolOrderToOpen","toolName","activeTool$","setSelectedResult","getClickCoordinate","boundingMapBrowser","pageYOffset","pageXOffset","pixel","proj","searchBarTerm","c","toFixed","header","classList","add","workspaceMaximize$","toastPanelHtmlDisplay","isDesktop","fullExtent","getControlsOffsetY","readToolParams","readSearchParams","readFocusFirst","computeZoomToExtent","lang","languageForce","setLanguage","zoomExtent","extentParams","split","olExtent","zoomToExtent","computeFocusFirst","resultItem","item","click","sf","termDefinedInUrl","entities$$","skipWhile","entities","take","termDefinedInUrlTriggered","exactMatch","activateCustomFilterTermStrategy","searchResultsOlFeatures","totalExtent","searchGeom","matDialogRef$","r","first","matDialogOpened","sidenav","routing","stopCoords","routingOptions","resultSelection","parseInt","routesFeatureStore","count$","zoomToActiveRoute$","d","active","readLayersQueryParamsByType","readVectorQueryParams","getQueryParam","paramValue","fromString","nameParamLayersKey","urlsKey","wmsLayers","wmsUrl","wmtsLayers","wmtsUrl","arcgisLayers","arcgisUrl","iarcgisLayers","iarcgisUrl","tarcgisLayers","tarcgisUrl","layersByService","cnt","urlSrc","extractLayersByService","layerFromUrl","layerOptions","igo2_utils","LAYERS","visibility","computeLayerVisibilityFromUrl","addLayerFromURL","vector","lastIndex","lastIndexOf","fileName","slice","responseType","file","File","lastModified","Date","now","import","features","onFileImportSuccess","error","onFileImportError","outLayersByService","startsWith","substr","endsWith","zIndex","commonSourceOptions","optionsFromCapabilities","optionsFromApi","crossOrigin","arcgisClause","queryable","queryFormat","VERSION","l","addLayer","currentLayerid","visibleOnLayersParams","visibleOffLayersParams","visiblelayers","invisiblelayers","indexOf","toString","controlsAnimations","fesm2015_animations","controlSlideX","controlSlideY","MapComponent","hasHeader","routes","path","component","MenuRoutingModule","router","onSameUrlNavigation","relativeLinkResolution","HeaderModule","common","toolbar","FooterModule","MapOverlayModule","AppSidenavModule","fesm2015_button","tooltip","igo2_context","LegendButtonModule","bootstrap","provide","useValue","imports","IgoAppSearchResultsToolModule","badge","AppSideResultModule","card","expansion","PortalModule","MenuModule","environment","production","igo","app","pwa","enabled","promote","language","prefix","searchSources","nominatim","available","storedqueries","icherche","searchUrl","order","limit","coordinatesreverse","showInPointerSummary","icherchereverse","ilayer","projections","code","alias","def","markerColor","markerOpacity","markerOutlineColor","fillColor","fillOpacity","strokeColor","strokeOpacity","strokeWidth","queryOverlayStyle","HeaderComponent","computeHeader","headerLogo","headerLogoPrint","MenuComponent","AppComponent","renderer","titleService","metaService","getTranslation","getLanguage","readTitleConfig","readThemeConfig","readDescriptionConfig","detectOldBrowser","hasMenu","setTitle","addTag","content","theme","themeClass","addClass","body","description","ie","chrome","firefox","safari","title$","message$","rep","CONFIG_LOADER","AppModule","default","useFactory","configLoader","configOptions","promiseOrTrue","deps","appInitializerFactory","secondPromises","thirdPromises","multi","showDelay","hideDelay","touchendHideDelay","disableTooltipInteractivity","platform_browser","animations","service_worker","registrationStrategy","bootstrapModule","catch","err","webpackContext","module"],"sourceRoot":"webpack:///","sources":["./src/app/pages/menu/menu-pages/home/home.component.ts","./src/app/pages/menu/menu-pages/home/home.component.html","./src/app/pages/menu/menu-pages/about/about.component.ts","./src/app/pages/menu/menu-pages/about/about.component.html","./src/app/services/pwa.service.ts","./src/app/pages/footer/footer.component.ts","./src/app/pages/footer/footer.component.html","./src/app/pages/portal/legend-button/legend-button.component.ts","./src/app/pages/portal/legend-button/legend-button.component.html","./src/app/pages/portal/legend-button/legend-button-dialog.component.html","./src/app/pages/portal/map-overlay/map-overlay.component.html","./src/app/pages/portal/map-overlay/map-overlay.component.ts","./src/app/pages/portal/sideresult/search-results-tool/search-results-tool.component.html","./src/app/pages/portal/sideresult/search-results-tool/search-results-tool.component.ts","./src/app/pages/portal/sideresult/sideresult.component.html","./src/app/pages/portal/sideresult/sideresult.component.ts","./src/app/pages/portal/sideresult/bottomresult.component.html","./src/app/pages/portal/sideresult/bottomresult.component.ts","./src/app/pages/portal/portal.component.html","./src/app/pages/portal/portal.component.ts","./src/app/pages/portal/portal.animation.ts","./src/app/pages/menu/menu-pages/map/map.component.ts","./src/app/pages/menu/menu-pages/map/map.component.html","./src/app/pages/menu/menu-routing/menu-routing.module.ts","./src/app/pages/header/header.module.ts","./src/app/pages/footer/footer.module.ts","./src/app/pages/portal/map-overlay/map-overlay.module.ts","./src/app/pages/portal/sidenav/sidenav.module.ts","./src/app/pages/portal/legend-button/legend-button.module.ts","./src/app/pages/portal/sideresult/search-results-tool/search-results-tool.module.ts","./src/app/pages/portal/sideresult/sideresult.module.ts","./src/app/pages/portal/portal.module.ts","./src/app/pages/menu/menu.module.ts","./src/environments/environment.github.ts","./src/app/pages/header/header.component.ts","./src/app/pages/header/header.component.html","./src/app/pages/menu/menu.component.ts","./src/app/pages/menu/menu.component.html","./src/app/app.component.html","./src/app/app.component.ts","./src/app/app.module.ts","./src/main.ts","./node_modules/moment/locale/ sync ^\\.\\/.*$"],"sourcesContent":["import { Component } from '@angular/core';\n\n@Component({\n  selector: 'app-menu-home',\n  templateUrl: './home.component.html'\n})\nexport class HomeComponent {\n  getHomeComponent: any;\n\n  constructor() { }\n\n}\n","<div class=\"page\">\n    <div class=\"row\">\n        <h1 class=\"d-block themeTitre\">Accueil</h1>\n        <h2>Infrastructure géomatique ouverte 2.0 (IGO2) / Open GIS Infrastructure 2.0</h2>\n        <h4>Qu'est-ce qu'IGO?</h4>\n        <p>IGO2 est une solution Web gratuite en géomatique basée sur Angular - Material, OpenLayers et IGO2lib. IGO2 permet de tirer profit d’une multitude de données géographiques grâce à une interface cartographique accessible par un navigateur Web sur un poste de travail et par un appareil mobile. IGO2 a été initié par l'administration publique du Québec (Canada) et issu d’un travail collaboratif basé sur la philosophie des logiciels libres et ouverts (« open source »). Les membres du public en géomatique et du Web qui soumettent des contributions conservent leurs droits d'auteur s'ils partagent leur code source selon la LICENCE LiLiQ-R de type LGPL.</p>\n        <p style=\"display:inline;\">Téléchargement et code source : <a style=\"display:inline;\" href=\"https://github.com/infra-geo-ouverte/igo2\" target=\"_blank\" rel=\"noreferrer\">https://github.com/infra-geo-ouverte/igo2<!--img class=\"linkExtImg\" src=\"../../../../../assets/images/lien-externe.svg\" alt=\"Cet hyperlien s'ouvrira dans une nouvelle fenêtre.\"--></a></p>\n    </div>\n</div>\n","import { Component } from '@angular/core';\n\n@Component({\n  selector: 'app-about',\n  templateUrl: './about.component.html'\n})\nexport class AboutComponent {\n\n  constructor() { }\n\n}\n","<div class=\"row\">\n    <div class=\"container-fluid page\">\n        <h1 class=\"d-block themeTitre\">En savoir plus</h1>\n        <h2>Notre Mission</h2>\n\n        <h3>Mission 1</h3>\n        <p>Paragraphe : Lorem ipsum dolor sit amet, consectetur adipiscing elit. Tu enim ista lenius, hic Stoicorum more nos vexat. Quo studio Aristophanem putamus aetatem in litteris duxisse? Honesta oratio, Socratica, Platonis etiam. Vitiosum est enim in dividendo partem in genere numerare. <i>Non est igitur voluptas bonum.</i> Duo Reges: constructio interrete. Non autem hoc: igitur ne illud quidem. <b>Magna laus.</b> <b>Quis istum dolorem timet?</b> Quod autem satis est, eo quicquid accessit, nimium est; <b>Sed ille, ut dixi, vitiose.</b> </p>\n\n        <p>Cur tantas regiones barbarorum pedibus obiit, tot maria transmisit? <a href=\"http://loripsum.net/\" target=\"_blank\">Nulla erit controversia.</a> Prave, nequiter, turpiter cenabat; <code>Multoque hoc melius nos veriusque quam Stoici.</code> Contineo me ab exemplis. <b>Sed nimis multa.</b> <code>Nos vero, inquit ille;</code> <mark>Occultum facinus esse potuerit, gaudebit;</mark> </p>\n\n        <ul>\n            <li>Iam doloris medicamenta illa Epicurea tamquam de narthecio proment: Si gravis, brevis;</li>\n            <li>Ergo et avarus erit, sed finite, et adulter, verum habebit modum, et luxuriosus eodem modo.</li>\n            <li>Sedulo, inquam, faciam.</li>\n            <li>Quid enim tanto opus est instrumento in optimis artibus comparandis?</li>\n            <li>Sic, et quidem diligentius saepiusque ista loquemur inter nos agemusque communiter.</li>\n        </ul>\n\n\n        <p><b> Bold Inde igitur, inquit, ordiendum est.</b> Quis hoc dicit? Quamquam te quidem video minime esse deterritum. <i>Bonum incolumis acies: misera caecitas.</i> Indicant pueri, in quibus ut in speculis natura cernitur. Duae sunt enim res quoque, ne tu verba solum putes. <code>Est enim effectrix multarum et magnarum voluptatum.</code> </p>\n\n        <pre> Pre Corporis igitur nostri partes totaque figura et forma et\n        statura quam apta ad naturam sit, apparet, neque est dubium,\n        quin frons, oculi, aures et reliquae partes quales propriae\n        sint hominis intellegatur.\n\n        Pungunt quasi aculeis interrogatiunculis angustis, quibus\n        etiam qui assentiuntur nihil commutantur animo et idem\n        abeunt, qui venerant.\n        </pre>\n\n\n        <ol>\n            <li>Atqui perspicuum est hominem e corpore animoque constare, cum primae sint animi partes, secundae corporis.</li>\n            <li>Nonne videmus quanta perturbatio rerum omnium consequatur, quanta confusio?</li>\n        </ol>\n\n\n        <dl>\n            <dt><dfn>Stoicos roga.</dfn></dt>\n            <dd>Quid enim de amicitia statueris utilitatis causa expetenda vides.</dd>\n            <dt><dfn>Qui convenit?</dfn></dt>\n            <dd>Que Manilium, ab iisque M.</dd>\n            <dt><dfn>Paria sunt igitur.</dfn></dt>\n            <dd>Quamquam ab iis philosophiam et omnes ingenuas disciplinas habemus;</dd>\n            <dt><dfn>Confecta res esset.</dfn></dt>\n            <dd>Cupiditates non Epicuri divisione finiebat, sed sua satietate.</dd>\n        </dl>\n    </div>\n</div>","import { Injectable } from '@angular/core';\nimport { Platform } from '@angular/cdk/platform';\nimport { ConfigService, LanguageService } from '@igo2/core';\nimport { SwUpdate, VersionDetectedEvent } from '@angular/service-worker';\nimport { interval } from 'rxjs';\nimport { ConfirmDialogService } from '@igo2/common';\nimport { filter } from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class PwaService {\n  promptEvent: any;\n  constructor(\n    private platform: Platform,\n    public updates: SwUpdate,\n    public languageService: LanguageService,\n    private configService: ConfigService,\n    private confirmDialogService: ConfirmDialogService\n  ) {\n    if (updates.isEnabled) {\n      interval(60 * 1000 * 2).subscribe(() => updates.checkForUpdate());\n    }\n  }\n\n  private modalUpdatePWA() {\n    const title = this.languageService.translate.instant('pwa.new-version-title');\n    const body = this.languageService.translate.instant('pwa.new-version');\n    const message = `${title} ${body}`;\n    this.confirmDialogService.open(message).subscribe((confirm) => {\n      if (confirm) {\n        this.updates.activateUpdate().then(() => {\n          if (window.navigator.onLine) {\n            document.location.reload();\n          } else {\n            alert(`Hors-ligne / Offline. Vous devez être en ligne pour mettre à jour l\\'application. You must be online to update the application.`);\n            setTimeout(() => {\n              this.modalUpdatePWA();\n            }, 900000);\n          }\n        });\n      }\n    });\n  }\n\n  public checkForUpdates(): void {\n    if (this.updates.isEnabled) {\n      this.updates.versionUpdates.pipe(\n        filter((evt): evt is VersionDetectedEvent => evt.type === 'VERSION_DETECTED'))\n      .subscribe(() => {\n        this.modalUpdatePWA();\n      });\n  }\n  }\n\n  public async initPwaPrompt(): Promise<any> {\n    if (\n      this.configService.getConfig('app') &&\n      this.configService.getConfig('app.pwa') &&\n      this.configService.getConfig('app.pwa.enabled') &&\n      this.configService.getConfig('app.pwa.promote')) {\n      if (!this.platform.IOS) {\n        window.addEventListener('beforeinstallprompt', (event: any) => {\n          event.preventDefault();\n          this.promptEvent = event;\n          this.listenToUserAction();\n        }, { once: true });\n      }\n    }\n  }\n\n  private listenToUserAction() {\n    window.addEventListener('click', () => { this.showPrompt(); }, { once: true });\n  }\n\n  private async showPrompt() {\n    this.promptEvent.prompt();\n    const outcome = await this.promptEvent.userChoice;\n    this.promptEvent = undefined;\n  }\n}\n","import { Component } from '@angular/core';\nimport { LanguageService } from '@igo2/core';\n\n@Component({\n  selector: 'app-footer',\n  templateUrl: './footer.component.html',\n  styleUrls: ['./footer.component.scss']\n})\nexport class FooterComponent {\n\n  constructor(protected languageService: LanguageService) {}\n\n}\n","<div class=\"footer-right\" id=\"footer-id\">\n    <div id=\"scaleLine\"></div>\n    <span class=\"order2\">\n        <span class=\"footer-text\">\n            <a rel=\"noopener noreferrer\" alt=\"('externallinks' | translate)\" href=\"{{'footer.url-conditions' | translate}}\"\n            target=\"_blank\">{{'footer.conditions' | translate}}</a>\n        </span>\n        <span class=\"footer-text\">  |  </span>\n        <span class=\"footer-text\">\n            <a rel=\"noopener noreferrer\" alt=\"('externallinks' | translate)\" href=\"{{'footer.url-ministry' | translate}}\"\n            target=\"_blank\">{{'footer.ministry' | translate}}</a>\n        </span>\n        <span class=\"footer-text\">  |  </span>\n        <span class=\"footer-text\">\n            <a rel=\"noopener noreferrer\" alt=\"('externallinks' | translate)\" href=\"{{'footer.url-gov' | translate}}\"\n            target=\"_blank\">{{'footer.gov' | translate}}</a>\n        </span>\n    </span>\n</div>\n","import { Component, OnInit } from '@angular/core';\nimport { MatDialog, MatDialogState } from '@angular/material/dialog';\nimport { IgoMap, Layer } from '@igo2/geo';\nimport { MapState } from '@igo2/integration';\nimport { Observable } from 'rxjs';\n\n@Component({\n  selector: 'app-legend-button',\n  templateUrl: './legend-button.component.html',\n  styleUrls: ['./legend-button.component.scss']\n})\n\nexport class LegendButtonComponent {\n\n  public dialogRef = null;\n\n  constructor(public dialog: MatDialog) {}\n\n  toggleDialog() {\n    const dialogOpened = this.dialog.getDialogById('legend-button-dialog-container');\n      if (!dialogOpened) {\n        this.dialogRef = this.dialog.open(LegendButtonDialogComponent, {\n          id: 'legend-button-dialog-container',\n          hasBackdrop: false,\n          closeOnNavigation: true\n        });\n      } else {\n        this.dialogRef.close();\n      }\n  }\n}\n\n@Component({\n  selector: 'app-legend-button-dialog',\n  templateUrl: 'legend-button-dialog.component.html'\n})\nexport class LegendButtonDialogComponent implements OnInit {\n\n  public getState: MatDialogState;\n\n  get map(): IgoMap {\n    return this.mapState.map;\n  }\n\n  get layers$(): Observable<Layer[]> {\n    return this.map.layers$;\n  }\n\n  public mapLayersShownInLegend: Layer[];\n\n  constructor(\n    private mapState: MapState\n  ) {}\n\n  ngOnInit() {\n    this.mapLayersShownInLegend = this.map.layers.filter(layer => (\n      layer.showInLayerList !== false\n    ));\n  }\n}\n","<button mat-raised-button qcca-buttons color=\"basic\" mat-button class=\"igo-legend-button\" (click)=\"toggleDialog()\">Légende</button>\n","<div mat-dialog-actions><button mat-button mat-icon-button mat-dialog-close class=\"close\"><mat-icon svgIcon = \"close\"></mat-icon></button></div>\n<h4 mat-dialog-title>Légende</h4>\n\n<igo-layer-legend-list\n  [layers]=\"mapLayersShownInLegend\"\n  [excludeBaseLayers]=\"true\"\n  [allowShowAllLegends]=\"false\"\n  [updateLegendOnResolutionChange]=\"true\"\n  [showAllLegendsValue]=\"false\">\n</igo-layer-legend-list>\n","<ng-container *ngFor=\"let element of mapOverlay; let i = index\">\n  <div class=\"mapOverlayDefault\" [ngClass]=\"element.cssClass\"\n       [style.position]=\"element.fixed ? 'fixed' : 'absolute'\"\n       [style.marginLeft]=\"element.marginLeft\"\n       [style.marginRight]=\"element.marginRight\"\n       [style.marginTop]=\"element.marginTop\"\n       [style.marginBottom]=\"element.marginBottom\"\n       [style.fontSize]=\"element.fontSize\">\n    <a *ngIf=\"element.link; else templateNoLink\"\n        target=\"_blank\" [href]='element.link'>\n        {{ element.text }}\n        <ng-container *ngIf=\"element.imgSrc\">\n          <img [src]=\"element.imgSrc\"\n               [alt]=\"element.alt\"\n               [ngStyle]=\"{ 'width': element.imgSize }\">\n        </ng-container>\n    </a>\n\n\n  <ng-template #templateNoLink>\n    {{ element.text }}\n    <ng-container *ngIf=\"element.imgSrc\">\n      <img [src]=\"element.imgSrc\" [alt]=\"element.alt\" [ngStyle]=\"{ 'width': element.imgSize }\">\n    </ng-container>\n\n  </ng-template>\n  </div>\n</ng-container>\n","import { Component, AfterViewInit, OnDestroy } from '@angular/core';\nimport { Subscription } from 'rxjs';\nimport { Context, ContextService } from '@igo2/context';\nimport { MediaService, ConfigService } from '@igo2/core';\nimport { MapOverlay } from './map-overlay.interface';\n\n@Component({\n  selector: 'app-map-overlay',\n  templateUrl: './map-overlay.component.html',\n  styleUrls: ['./map-overlay.component.scss']\n})\n\nexport class MapOverlayComponent implements AfterViewInit, OnDestroy {\n  public mapOverlay: MapOverlay[] = [];\n  private context$$: Subscription;\n  private media$$: Subscription;\n  private context: Context;\n\n  constructor(\n    private contextService: ContextService,\n    private mediaService: MediaService,\n    private configService: ConfigService\n  ) { }\n\n  ngAfterViewInit() {\n    this.context$$ = this.contextService.context$.subscribe(context => {\n        this.handleContextChange(context);\n        this.context = context;\n        }\n    );\n    this.media$$ = this.mediaService.media$.subscribe(media =>\n      this.handleContextChange(this.context)\n    );\n  }\n\n  ngOnDestroy() {\n    this.context$$.unsubscribe();\n    this.media$$.unsubscribe();\n  }\n\n  private handleContextChange(context: Context) {\n    let mapOverlay = [];\n    if (context !== undefined) {\n      this.mapOverlay = [];\n\n      if (context['mapOverlay']) {\n        mapOverlay = context['mapOverlay'];\n      } else if (this.configService.getConfig('mapOverlay')) {\n        mapOverlay = this.configService.getConfig('mapOverlay');\n      }\n      for (const overlay of mapOverlay) {\n\n        // If no media define use default to desktop, display only if current media is on context definition\n        if ((!overlay.media && this.mediaService.getMedia() === 'desktop') ||\n        (overlay.media && overlay.media.includes(this.mediaService.getMedia()))) {\n          this.mapOverlay.push(overlay);\n        }\n      }\n    }\n\n  }\n}\n","<div *ngIf=\"(!store || store.stateView.empty) && (debouncedEmpty$ | async) \" style=\"margin: 10px;\">\n  <section class=\"mat-typography\">\n    <h5><strong>{{ 'igo.integration.searchResultsTool.noResults' | translate }}</strong></h5>\n    <h6><strong>{{ 'igo.integration.searchResultsTool.doSearch' | translate }}</strong></h6>\n    <div [innerHTML]=\"'igo.integration.searchResultsTool.examples' | translate | sanitizeHtml\"></div>\n</section>\n</div>\n\n<igo-flexible\n  *ngIf=\"store && (store.stateView.empty$ | async)===false\"\n  #topPanel\n  initial=\"100%\"\n  initialMobile=\"100%\"\n  collapsed=\"calc(100% - 58px)\"\n  collapsedMobile=\"calc(100% - 58px)\"\n  expanded=\"60%\"\n  expandedMobile=\"60%\"\n  [state]=\"(feature$ | async) ? topPanelState : 'initial'\">\n\n  <div class=\"igo-content\">\n    <igo-search-results\n      [store]=\"store\"\n      [showIcons]=\"showIcons\"\n      [term]=\"term\"\n      [termSplitter]=\"termSplitter\"\n      [settingsChange$]=\"settingsChange$\"\n      placeholder=\"false\"\n      (resultFocus)=\"onResultFocus($event)\"\n      (resultSelect)=\"onResultSelect($event)\"\n      (resultUnfocus)=\"onResultUnfocus($event)\"\n      (resultMouseenter)=\"onResultFocus($event)\"\n      (resultMouseleave)=\"onResultUnfocus($event)\"\n      (moreResults)=\"onSearch($event)\">\n      <ng-template #igoSearchItemToolbar let-result=\"result\">\n        <igo-search-add-button\n          [map]=\"map\"\n          [layer]=\"result\">\n        </igo-search-add-button>\n      </ng-template>\n    </igo-search-results>\n  </div>\n\n  <!--div igoFlexibleFill class=\"igo-content\">\n    <igo-panel [title]=\"featureTitle\" *ngIf=\"feature$ | async\">\n\n      <button\n        mat-icon-button\n        panelLeftButton\n        class=\"igo-icon-button\"\n        (click)=\"toggleTopPanel()\">\n        <mat-icon [svgIcon]=\"(topPanelState$ | async) === 'collapsed' ? 'arrow-up' : 'arrow-down'\"></mat-icon>\n      </button>\n\n      <button\n        *ngIf=\"feature.geometry\"\n        mat-icon-button\n        panelRightButton\n        class=\"igo-icon-button\"\n        [matTooltip]=\"((isSelectedResultOutOfView$ | async) ? 'igo.integration.searchResultsTool.zoomOnFeatureTooltipOutOfView' : 'igo.integration.searchResultsTool.zoomOnFeatureTooltip') | translate\"\n        matTooltipShowDelay=\"500\"\n        (click)=\"zoomToFeatureExtent()\">\n        <mat-icon\n        [matBadge]=\"(isSelectedResultOutOfView$ | async) ? '!' : ''\"\n        matBadgeColor=\"accent\"\n        matBadgeSize=\"small\"\n        [matBadgeHidden]=\"(isSelectedResultOutOfView$ | async)===false\"     \n        svgIcon=\"magnify-plus-outline\"></mat-icon>\n      </button>\n\n      <igo-feature-details\n        igoFeatureDetailsDirective\n        [feature]=\"feature$ | async\"\n        [map]=\"map\"\n        [toolbox]=\"toolState.toolbox\"\n        (routingEvent)=\"getRoute()\">\n      </igo-feature-details>\n    </igo-panel>\n  </div-->\n\n</igo-flexible>\n","import {\n  Component,\n  ChangeDetectionStrategy,\n  Input,\n  OnInit,\n  ElementRef,\n  OnDestroy\n} from '@angular/core';\nimport { Observable, BehaviorSubject, Subscription, combineLatest } from 'rxjs';\nimport { debounceTime, map } from 'rxjs/operators';\nimport olFormatGeoJSON from 'ol/format/GeoJSON';\nimport olFeature from 'ol/Feature';\nimport olPoint from 'ol/geom/Point';\nimport type { default as OlGeometry } from 'ol/geom/Geometry';\n\nimport pointOnFeature from '@turf/point-on-feature';\nimport * as olProj from 'ol/proj';\nimport { ConfigService } from '@igo2/core';\n\nimport {\n  EntityStore,\n  ToolComponent,\n  FlexibleState,\n  getEntityTitle,\n  FlexibleComponent,\n  EntityState\n} from '@igo2/common';\n\nimport {\n  FEATURE,\n  Feature,\n  FeatureMotion,\n  SearchResult,\n  IgoMap,\n  moveToOlFeatures,\n  Research,\n  featuresAreTooDeepInView,\n  featureToOl,\n  featureFromOl,\n  getCommonVectorStyle,\n  getCommonVectorSelectedStyle,\n  computeOlFeaturesExtent,\n  featuresAreOutOfView,\n  roundCoordTo\n} from '@igo2/geo';\n\nimport { MapState, SearchState, ToolState, DirectionState } from '@igo2/integration';\n\n/**\n * Tool to browse the search results\n */\n@ToolComponent({\n  name: 'searchResults',\n  title: 'igo.integration.tools.searchResults',\n  icon: 'magnify'\n})\n@Component({\n  selector: 'app-search-results-tool',\n  templateUrl: './search-results-tool.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class SearchResultsToolComponent implements OnInit, OnDestroy {\n  /**\n   * to show hide results icons\n   */\n  @Input() showIcons: boolean = true;\n\n  /**\n   * Determine the top panel default state\n   */\n  @Input() topPanelStateDefault: string = 'expanded';\n\n  private hasFeatureEmphasisOnSelection: boolean = false;\n\n  private showResultsGeometries$$: Subscription;\n  private getRoute$$: Subscription;\n  private shownResultsGeometries: Feature[] = [];\n  private shownResultsEmphasisGeometries: Feature[] = [];\n  private focusedResult$: BehaviorSubject<SearchResult> = new BehaviorSubject(\n    undefined\n  );\n  public isSelectedResultOutOfView$ = new BehaviorSubject(false);\n  private isSelectedResultOutOfView$$: Subscription;\n  private abstractFocusedResult: Feature;\n  private abstractSelectedResult: Feature;\n\n  public debouncedEmpty$ :BehaviorSubject<boolean> = new BehaviorSubject(true);\n  private debouncedEmpty$$: Subscription;\n\n  /**\n   * Store holding the search results\n   * @internal\n   */\n  get store(): EntityStore<SearchResult> {\n    return this.searchState.store;\n  }\n\n  /**\n   * Map to display the results on\n   * @internal\n   */\n  get map(): IgoMap {\n    return this.mapState.map;\n  }\n\n  get featureTitle(): string {\n    return this.feature ? getEntityTitle(this.feature) : undefined;\n  }\n\n  get feature$(): Observable<Feature> {\n    return this.store.stateView\n      .firstBy$((e) => e.state.focused)\n      .pipe(\n        map(\n          (element) =>\n          (this.feature = element\n            ? (element.entity.data as Feature)\n            : undefined)\n        )\n      );\n  }\n\n  public feature: Feature;\n\n  public term = '';\n  private searchTerm$$: Subscription;\n\n  public settingsChange$ = new BehaviorSubject<boolean>(undefined);\n\n  public topPanelState$ = new BehaviorSubject<FlexibleState>('initial');\n  private topPanelState$$: Subscription;\n\n  @Input()\n  set topPanelState(value: FlexibleState) {\n    this.topPanelState$.next(value);\n  }\n  get topPanelState(): FlexibleState {\n    return this.topPanelState$.value;\n  }\n\n  get termSplitter(): string {\n    return this.searchState.searchTermSplitter$.value;\n  }\n\n  private format = new olFormatGeoJSON();\n\n  get searchStore(): EntityStore<SearchResult> {\n    return this.searchState.store;\n  }\n\n  constructor(\n    private mapState: MapState,\n    private searchState: SearchState,\n    private elRef: ElementRef,\n    public toolState: ToolState,\n    private directionState: DirectionState,\n    configService: ConfigService\n  ) {\n    this.hasFeatureEmphasisOnSelection = configService.getConfig(\n      'hasFeatureEmphasisOnSelection'\n    );\n  }\n\n  ngOnInit() {\n    this.searchTerm$$ = this.searchState.searchTerm$.subscribe(\n      (searchTerm: string) => {\n        if (searchTerm !== undefined && searchTerm !== null) {\n          this.term = searchTerm;\n        }\n      }\n    );\n\n    for (const res of this.store.stateView.all$().value) {\n      if (this.store.state.get(res.entity).selected === true) {\n        this.topPanelState = 'expanded';\n      }\n    }\n\n    this.searchState.searchSettingsChange$.subscribe(() => {\n      this.settingsChange$.next(true);\n    });\n\n    this.topPanelState$$ = this.topPanelState$.subscribe(() => {\n      const igoList = this.computeElementRef()[0];\n      const selected = this.computeElementRef()[1];\n      if (selected) {\n        setTimeout(() => {\n          // To be sure the flexible component has been displayed yet\n          if (!this.isScrolledIntoView(igoList, selected)) {\n            this.adjustTopPanel(igoList, selected);\n          }\n        }, FlexibleComponent.transitionTime + 50);\n      }\n    });\n\n    if (this.hasFeatureEmphasisOnSelection) {\n      if (!this.searchState.focusedOrResolution$$) {\n        this.searchState.focusedOrResolution$$ = combineLatest([\n          this.focusedResult$,\n          this.map.viewController.resolution$\n        ]).subscribe((bunch: [SearchResult<Feature>, number]) =>\n          this.buildResultEmphasis(bunch[0], 'focused')\n        );\n      }\n\n      if (!this.searchState.selectedOrResolution$$) {\n        this.searchState.selectedOrResolution$$ = combineLatest([\n          this.searchState.selectedResult$,\n          this.map.viewController.resolution$\n        ]).subscribe((bunch: [SearchResult<Feature>, number]) =>\n          this.buildResultEmphasis(bunch[0], 'selected')\n        );\n      }\n    }\n    this.monitorResultOutOfView();\n\n    this.showResultsGeometries$$ = combineLatest([\n      this.searchState.searchResultsGeometryEnabled$,\n      this.store.stateView.all$(),\n      this.focusedResult$,\n      this.searchState.selectedResult$,\n      this.searchState.searchTerm$,\n      this.map.viewController.resolution$\n    ]).subscribe((bunch: [boolean, { entity: SearchResult, state: EntityState }[], SearchResult, SearchResult, string, number]) => {\n\n      const searchResultsGeometryEnabled = bunch[0];\n      const searchResults = bunch[1];\n\n      if (this.hasFeatureEmphasisOnSelection) {\n        this.clearFeatureEmphasis('shown');\n      }\n      this.shownResultsGeometries.map(result => this.map.queryResultsOverlay.removeFeature(result));\n      const featureToHandleGeom = searchResults\n        .filter(result =>\n          result.entity.meta.dataType === FEATURE &&\n          result.entity.data.geometry &&\n          !result.state.selected &&\n          !result.state.focused);\n\n      featureToHandleGeom.map(result => {\n        if (searchResultsGeometryEnabled) {\n          result.entity.data.meta.style =\n            getCommonVectorStyle(\n              Object.assign(\n                {},\n                { feature: result.entity.data as Feature | olFeature<OlGeometry> },\n                this.searchState.searchOverlayStyle,\n                result.entity.style?.base ? result.entity.style.base : {}\n              ));\n          this.shownResultsGeometries.push(result.entity.data as Feature);\n          this.map.queryResultsOverlay.addFeature(result.entity.data as Feature, FeatureMotion.None);\n          if (this.hasFeatureEmphasisOnSelection) {\n            this.buildResultEmphasis(result.entity as SearchResult<Feature>, 'shown');\n          }\n        }\n      });\n    });\n\n    this.debouncedEmpty$$ = this.store.stateView.empty$.pipe(debounceTime(1500)).subscribe(empty => this.debouncedEmpty$.next(empty));\n  }\n\n  private monitorResultOutOfView() {\n    this.isSelectedResultOutOfView$$ = combineLatest([\n      this.map.viewController.state$,\n      this.searchState.selectedResult$\n    ])\n      .pipe(debounceTime(100))\n      .subscribe((bunch) => {\n        const selectedResult = bunch[1] as SearchResult<Feature>;\n        if (!selectedResult) {\n          this.isSelectedResultOutOfView$.next(false);\n          return;\n        }\n        if (selectedResult.data.geometry) {\n          const selectedOlFeature = featureToOl(\n            selectedResult.data,\n            this.map.projection\n          );\n          const selectedOlFeatureExtent = computeOlFeaturesExtent(this.map, [\n            selectedOlFeature\n          ]);\n          this.isSelectedResultOutOfView$.next(\n            featuresAreOutOfView(this.map, selectedOlFeatureExtent)\n          );\n        }\n      });\n  }\n\n  private buildResultEmphasis(\n    result: SearchResult<Feature>,\n    trigger: 'selected' | 'focused' | 'shown' | undefined\n  ) {\n    if (trigger !== 'shown') {\n      this.clearFeatureEmphasis(trigger);\n    }\n    if (!result || !result.data.geometry) {\n      return;\n    }\n    const myOlFeature = featureToOl(result.data, this.map.projection);\n    const olGeometry = myOlFeature.getGeometry();\n    if (featuresAreTooDeepInView(this.map, olGeometry.getExtent() as [number, number, number, number], 0.0025)) {\n      const extent = olGeometry.getExtent();\n      const x = extent[0] + (extent[2] - extent[0]) / 2;\n      const y = extent[1] + (extent[3] - extent[1]) / 2;\n      const feature1 = new olFeature({\n        name: `${trigger}AbstractResult'`,\n        geometry: new olPoint([x, y])\n      });\n      const abstractResult = featureFromOl(feature1, this.map.projection);\n\n      let computedStyle;\n      let zIndexOffset = 0;\n\n      switch (trigger) {\n        case 'focused':\n          computedStyle = getCommonVectorSelectedStyle(\n            Object.assign({},\n              { feature: abstractResult },\n              this.searchState.searchOverlayStyleFocus,\n              result.style?.focus ? result.style.focus : {}));\n          zIndexOffset = 2;\n          break;\n        case 'shown':\n          computedStyle = getCommonVectorStyle(Object.assign({},\n            { feature: abstractResult },\n            this.searchState.searchOverlayStyle,\n            result.style?.base ? result.style.base : {}));\n          break;\n        case 'selected':\n          computedStyle = getCommonVectorSelectedStyle(\n            Object.assign({},\n              { feature: abstractResult },\n              this.searchState.searchOverlayStyleSelection,\n              result.style?.selection ? result.style.selection : {}));\n          zIndexOffset = 1;\n          break;\n      }\n      abstractResult.meta.style = computedStyle;\n      abstractResult.meta.style.setZIndex(2000 + zIndexOffset);\n      this.map.searchResultsOverlay.addFeature(abstractResult, FeatureMotion.None);\n      if (trigger === 'focused') {\n        this.abstractFocusedResult = abstractResult;\n      }\n      if (trigger === 'selected') {\n        this.abstractSelectedResult = abstractResult;\n      }\n      if (trigger === 'shown') {\n        this.shownResultsEmphasisGeometries.push(abstractResult);\n      }\n    } else {\n      this.clearFeatureEmphasis(trigger);\n    }\n  }\n\n  private clearFeatureEmphasis(trigger: 'selected' | 'focused' | 'shown') {\n    if (trigger === 'focused' && this.abstractFocusedResult) {\n      this.map.searchResultsOverlay.removeFeature(this.abstractFocusedResult);\n      this.abstractFocusedResult = undefined;\n    }\n    if (trigger === 'selected' && this.abstractSelectedResult) {\n      this.map.searchResultsOverlay.removeFeature(this.abstractSelectedResult);\n      this.abstractSelectedResult = undefined;\n    }\n    if (trigger === 'shown') {\n      this.shownResultsEmphasisGeometries.map(shownResult => this.map.searchResultsOverlay.removeFeature(shownResult));\n      this.shownResultsEmphasisGeometries = [];\n    }\n  }\n\n  ngOnDestroy() {\n    this.topPanelState$$.unsubscribe();\n    this.searchTerm$$.unsubscribe();\n    if (this.isSelectedResultOutOfView$$) {\n      this.isSelectedResultOutOfView$$.unsubscribe();\n    }\n    if (this.showResultsGeometries$$) {\n      this.showResultsGeometries$$.unsubscribe();\n    }\n    if (this.getRoute$$) {\n      this.getRoute$$.unsubscribe();\n    }\n    if (this.debouncedEmpty$$) {\n      this.debouncedEmpty$$.unsubscribe();\n    }\n  }\n\n  /**\n   * Try to add a feature to the map when it's being focused\n   * @internal\n   * @param result A search result that could be a feature\n   */\n  onResultFocus(result: SearchResult) {\n    this.focusedResult$.next(result);\n    if (result.meta.dataType === FEATURE && result.data.geometry) {\n      result.data.meta.style = getCommonVectorSelectedStyle(\n        Object.assign({},\n          { feature: result.data as Feature | olFeature<OlGeometry> },\n          this.searchState.searchOverlayStyleFocus,\n          result.style?.focus ? result.style.focus : {}));\n\n      const feature = this.map.searchResultsOverlay.dataSource.ol.getFeatureById(result.meta.id);\n      if (feature) {\n        feature.setStyle(result.data.meta.style);\n        return;\n      }\n      this.map.searchResultsOverlay.addFeature(result.data as Feature, FeatureMotion.None);\n    }\n  }\n\n  onResultUnfocus(result: SearchResult) {\n    this.focusedResult$.next(undefined);\n    if (result.meta.dataType !== FEATURE) {\n      return;\n    }\n\n    if (this.store.state.get(result).selected === true) {\n      const feature = this.map.searchResultsOverlay.dataSource.ol.getFeatureById(result.meta.id);\n      if (feature) {\n        const style = getCommonVectorSelectedStyle(\n          Object.assign({},\n            { feature: result.data as Feature | olFeature<OlGeometry> },\n            this.searchState.searchOverlayStyleFocus,\n            result.style?.focus ? result.style.focus : {}));\n        feature.setStyle(style);\n      }\n      return;\n    }\n    this.map.searchResultsOverlay.removeFeature(result.data as Feature);\n  }\n\n  /**\n   * Try to add a feature to the map when it's being selected\n   * @internal\n   * @param result A search result that could be a feature or some layer options\n   */\n  onResultSelect(result: SearchResult) {\n    this.map.searchResultsOverlay.dataSource.ol.clear();\n    this.tryAddFeatureToMap(result);\n    //this.searchState.setSelectedResult(result);\n    /*\n    if (this.topPanelState === 'initial') {\n      if (this.topPanelStateDefault !== 'collapsed') {\n        this.topPanelState = 'expanded';\n      } else {\n        this.topPanelState = 'collapsed';\n      }\n    }*/\n    /*\n    if (this.topPanelState === 'expanded') {\n      const igoList = this.computeElementRef()[0];\n      const selected = this.computeElementRef()[1];\n      if (!this.isScrolledIntoView(igoList, selected)) {\n        this.adjustTopPanel(igoList, selected);\n      }\n    }*/\n  }\n\n  onSearch(event: { research: Research; results: SearchResult[] }) {\n    const results = event.results;\n    const newResults = this.store.entities$.value\n      .filter((result: SearchResult) => result.source !== event.research.source)\n      .concat(results);\n\n    this.store.load(newResults);\n\n    for (const res of this.store.all()) {\n      if (\n        this.store.state.get(res).focused === true &&\n        this.store.state.get(res).selected !== true\n      ) {\n        this.store.state.update(res, { focused: false }, true);\n      }\n    }\n\n    setTimeout(() => {\n      const igoList = this.elRef.nativeElement.querySelector('igo-list');\n      let moreResults;\n      event.research.request.subscribe((source) => {\n        if (!source[0] || !source[0].source) {\n          moreResults = null;\n        } else if (source[0].source.getId() === 'icherche') {\n          moreResults = igoList.querySelector('.icherche .moreResults');\n        } else if (source[0].source.getId() === 'ilayer') {\n          moreResults = igoList.querySelector('.ilayer .moreResults');\n        } else if (source[0].source.getId() === 'nominatim') {\n          moreResults = igoList.querySelector('.nominatim .moreResults');\n        } else {\n          moreResults = igoList.querySelector('.' + source[0].source.getId() + ' .moreResults');\n        }\n\n        if (\n          moreResults !== null &&\n          !this.isScrolledIntoView(igoList, moreResults)\n        ) {\n          igoList.scrollTop =\n            moreResults.offsetTop +\n            moreResults.offsetHeight -\n            igoList.clientHeight;\n        }\n      });\n    }, 250);\n  }\n\n  computeElementRef() {\n    const items = document.getElementsByTagName('igo-search-results-item');\n    const igoList = this.elRef.nativeElement.getElementsByTagName(\n      'igo-list'\n    )[0];\n    let selectedItem;\n    // eslint-disable-next-line\n    for (let i = 0; i < items.length; i++) {\n      if (items[i].className.includes('igo-list-item-selected')) {\n        selectedItem = items[i];\n      }\n    }\n    return [igoList, selectedItem];\n  }\n\n  adjustTopPanel(elemSource, elem) {\n    if (!this.isScrolledIntoView(elemSource, elem)) {\n      elemSource.scrollTop =\n        elem.offsetTop +\n        elem.children[0].offsetHeight -\n        elemSource.clientHeight;\n    }\n  }\n\n  toggleTopPanel() {\n    if (this.topPanelState === 'expanded') {\n      this.topPanelState = 'collapsed';\n    } else {\n      this.topPanelState = 'expanded';\n    }\n  }\n\n  zoomToFeatureExtent() {\n    if (this.feature.geometry) {\n      const localOlFeature = this.format.readFeature(this.feature, {\n        dataProjection: this.feature.projection,\n        featureProjection: this.map.projection\n      });\n      moveToOlFeatures(this.map, [localOlFeature], FeatureMotion.Zoom);\n    }\n  }\n\n  /**\n   * Try to add a feature to the map overlay\n   * @param result A search result that could be a feature\n   */\n  private tryAddFeatureToMap(result: SearchResult) {\n    if (result.meta.dataType !== FEATURE) {\n      return undefined;\n    }\n    const feature = (result as SearchResult<Feature>).data;\n\n    // Somethimes features have no geometry. It happens with some GetFeatureInfo\n    if (!feature.geometry) {\n      return;\n    }\n\n    feature.meta.style = getCommonVectorSelectedStyle(\n      Object.assign({},\n        { feature },\n        this.searchState.searchOverlayStyleSelection,\n        result.style?.selection ? result.style.selection : {}));\n\n    this.map.searchResultsOverlay.addFeature(feature);\n  }\n\n  isScrolledIntoView(elemSource, elem) {\n    const padding = 6;\n    const docViewTop = elemSource.scrollTop;\n    const docViewBottom = docViewTop + elemSource.clientHeight;\n\n    const elemTop = elem.offsetTop;\n    const elemBottom = elemTop + elem.clientHeight + padding;\n    return elemBottom <= docViewBottom && elemTop >= docViewTop;\n  }\n\n  getRoute() {\n    this.toolState.toolbox.activateTool('directions');\n    this.directionState.stopsStore.clearStops();\n    setTimeout(() => {\n      let routingCoordLoaded = false;\n      if (this.getRoute$$) { this.getRoute$$.unsubscribe(); }\n      this.getRoute$$ = this.directionState.stopsStore.storeInitialized$.subscribe((init: boolean) => {\n        if (this.directionState.stopsStore.storeInitialized$.value && !routingCoordLoaded) {\n          routingCoordLoaded = true;\n          const stop = this.directionState.stopsStore.all().find((e) => e.position === 1);\n          let coord;\n          if (this.feature.geometry) {\n            if (this.feature.geometry.type === 'Point') {\n              coord = [this.feature.geometry.coordinates[0], this.feature.geometry.coordinates[1]];\n            } else {\n              const point = pointOnFeature(this.feature.geometry);\n              coord = [point.geometry.coordinates[0], point.geometry.coordinates[1]];\n            }\n          }\n          stop.text = this.featureTitle;\n          stop.coordinates = coord;\n          this.directionState.stopsStore.update(stop);\n          if (this.map.geolocationController.position$.value) {\n            const currentPos = this.map.geolocationController.position$.value;\n            const stop = this.directionState.stopsStore.all().find((e) => e.position === 0);\n            const currentCoord = olProj.transform(currentPos.position, currentPos.projection, 'EPSG:4326');\n            const coord: [number,number] = roundCoordTo([currentCoord[0], currentCoord[1]], 6);\n            stop.text = coord.join(',');\n            stop.coordinates = coord;\n            this.directionState.stopsStore.update(stop);\n          }\n\n        }\n      });\n    }, 250);\n  }\n}\n","<div id=\"sideresultsDesktop\">\n  <mat-sidenav \n    #sidenav\n    mode=\"side\"\n    [autoFocus]=\"false\"\n    [(opened)]=\"opened\">\n\n  <div #content class=\"app-sideresult-content\">\n\n            <app-search-results-tool  \n              #searchresults\n              [showIcons]=\"true\"\n              placeholder=\"false\"\n              (resultFocus)=\"onResultFocus($event)\"\n              (resultSelect)=\"onResultFocus($event)\"\n              (moreResults)=\"onSearch($event)\">\n            </app-search-results-tool>\n\n    </div>\n  </mat-sidenav>\n  <button\n    [ngClass]=\" sidenav.opened? 'sideresult-opened' : 'sideresult-closed' \"\n    #sidenavbutton\n    mat-raised-button\n    id=\"sideresult-button\"\n    isRoundButton=false\n    isIconButton=true\n    MatDrawerMode=\"push\"\n    (click)=\"sidenav.toggle()\">\n    <mat-icon *ngIf=\"sidenav.opened\" [matTooltip]=\"'sideresult.close' | translate\" matTooltipShowDelay=\"500\" tooltip-position=\"after\"svgIcon=\"menu-left\"></mat-icon>\n    <mat-icon *ngIf=\"!sidenav.opened\" [matTooltip]=\"'sideresult.open' | translate\" matTooltipShowDelay=\"500\" tooltip-position=\"after\" svgIcon=\"menu-right\"></mat-icon>\n  </button>\n</div>","import {\n  Component,\n  Input,\n  Output,\n  OnInit,\n  OnDestroy,\n  EventEmitter,\n  ChangeDetectionStrategy,\n  ElementRef,\n  ViewChild\n} from '@angular/core';\n\nimport * as proj from 'ol/proj';\nimport { MediaService } from '@igo2/core';\nimport { EntityStore, ActionStore } from '@igo2/common';\n\nimport { BehaviorSubject } from 'rxjs';\n\nimport {\n  IgoMap,\n  FEATURE,\n  Feature,\n  FeatureMotion,\n  GoogleLinks,\n  LayerService,\n  MapService,\n  Layer,\n  Research,\n  SearchResult,\n  SearchService\n} from '@igo2/geo';\nimport { SearchState } from '@igo2/integration';\nimport { ConfigService } from '@igo2/core';\n\n@Component({\n  selector: 'app-sideresult',\n  templateUrl: './sideresult.component.html',\n  styleUrls: ['./sideresult.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class SideResultComponent implements OnInit, OnDestroy {\n  title$: BehaviorSubject<string> = new BehaviorSubject<string>(undefined);\n  @Input() hasSearchQuery: boolean = undefined;\n\n  @Input()\n  public hasBackdrop: boolean;\n\n  @Input()\n  get map(): IgoMap {\n    return this._map;\n  }\n  set map(value: IgoMap) {\n    this._map = value;\n  }\n  private _map: IgoMap;\n\n  @Input()\n  get opened(): boolean {\n    return this._opened;\n  }\n  set opened(value: boolean) {\n    if (value === this._opened) {\n      return;\n    }\n\n    this._opened = value;\n    this.openedChange.emit(this._opened);\n  }\n  private _opened: boolean;\n\n  @Output() openedChange = new EventEmitter<boolean>();\n\n  events: string[] = [];\n  public hasToolbox: boolean = undefined;\n  public store = new ActionStore([]);\n  public igoSearchPointerSummaryEnabled: boolean = false;\n\n  public termSplitter: string = '|';\n\n  public view = {\n    center: [-73, 47.2],\n    zoom: 7\n  };\n\n  public osmLayer: Layer;\n\n  @ViewChild('mapBrowser', { read: ElementRef, static: true }) mapBrowser: ElementRef;\n\n  public lonlat;\n  public mapProjection: string;\n  public term: string;\n  public settingsChange$ = new BehaviorSubject<boolean>(undefined);\n  get searchStore(): EntityStore<SearchResult> {\n    return this.searchState.store;\n  }\n\n  get isTouchScreen(): boolean {\n    return this.mediaService.isTouchScreen();\n  }\n\n  public selectedFeature: Feature;\n\n  constructor(\n    private configService: ConfigService,\n    private mapService: MapService,\n    private layerService: LayerService,\n    private searchState: SearchState,\n    private searchService: SearchService,\n    private mediaService: MediaService\n    ) {\n      this.mapService.setMap(this.map);\n      this.hasToolbox = this.configService.getConfig('hasToolbox') === undefined ? false :\n        this.configService.getConfig('hasToolbox');\n\n      this.layerService\n        .createAsyncLayer({\n          title: 'OSM',\n          sourceOptions: {\n            type: 'osm'\n          }\n        })\n      .subscribe(layer => {\n        this.osmLayer = layer;\n      });\n    }\n\n    onPointerSummaryStatusChange(value) {\n      this.igoSearchPointerSummaryEnabled = value;\n    }\n\n    onSearchTermChange(term = '') {\n      this.term = term;\n      const termWithoutHashtag = term.replace(/(#[^\\s]*)/g, '').trim();\n      if (termWithoutHashtag.length < 2) {\n        this.searchStore.clear();\n        this.selectedFeature = undefined;\n      }\n    }\n\n    onSearch(event: { research: Research; results: SearchResult[] }) {\n      const results = event.results;\n      this.searchStore.state.updateAll({ focused: false, selected: false });\n      const newResults = this.searchStore.entities$.value\n        .filter((result: SearchResult) => result.source !== event.research.source)\n        .concat(results);\n      this.searchStore.updateMany(newResults);\n    }\n\n    onSearchSettingsChange() {\n      this.settingsChange$.next(true);\n    }\n\n    /**\n     * Try to add a feature to the map when it's being focused\n     * @internal\n     * @param result A search result that could be a feature\n     */\n    onResultFocus(result: SearchResult) {\n      this.tryAddFeatureToMap(result);\n      this.selectedFeature = (result as SearchResult<Feature>).data;\n    }\n\n    /**\n     * Try to add a feature to the map overlay\n     * @param layer A search result that could be a feature\n     */\n    private tryAddFeatureToMap(layer: SearchResult) {\n      if (layer.meta.dataType !== FEATURE) {\n        return undefined;\n      }\n\n      // Somethimes features have no geometry. It happens with some GetFeatureInfo\n      if (layer.data.geometry === undefined) {\n        return;\n      }\n\n      this.map.searchResultsOverlay.setFeatures(\n        [layer.data] as Feature[],\n        FeatureMotion.Default\n      );\n    }\n\n  ngOnInit() {\n    this.store.load([\n      {\n        id: 'coordinates',\n        title: 'coordinates',\n        handler: this.onSearchCoordinate.bind(this)\n      },\n      {\n        id: 'googleMaps',\n        title: 'googleMap',\n        handler: this.onOpenGoogleMaps.bind(this),\n        args: ['1']\n      },\n      {\n        id: 'googleStreetView',\n        title: 'googleStreetView',\n        handler: this.onOpenGoogleStreetView.bind(this)\n      }\n    ]);\n  }\n\n  ngOnDestroy() {\n    this.store.destroy();\n  }\n\n  /*\n   * Remove a feature to the map overlay\n   */\n  removeFeatureFromMap() {\n    this.map.searchResultsOverlay.clear();\n  }\n\n  onContextMenuOpen(event: { x: number; y: number }) {\n    const position = this.mapPosition(event);\n    const coord = this.mapService.getMap().ol.getCoordinateFromPixel(position);\n    this.mapProjection = this.mapService.getMap().projection;\n    this.lonlat = proj.transform(coord, this.mapProjection, 'EPSG:4326');\n  }\n\n  mapPosition(event: { x: number; y: number }) {\n    const contextmenuPoint = event;\n    contextmenuPoint.y =\n      contextmenuPoint.y -\n      this.mapBrowser.nativeElement.getBoundingClientRect().top +\n      window.scrollY;\n    contextmenuPoint.x =\n      contextmenuPoint.x -\n      this.mapBrowser.nativeElement.getBoundingClientRect().left +\n      window.scrollX;\n    const position = [contextmenuPoint.x, contextmenuPoint.y];\n    return position;\n  }\n\n  onPointerSearch(event) {\n    this.lonlat = event;\n    this.onSearchCoordinate();\n  }\n\n  onSearchCoordinate() {\n    this.searchStore.clear();\n    const results = this.searchService.reverseSearch(this.lonlat);\n\n    for (const i in results) {\n      if (results.length > 0) {\n        results[i].request.subscribe((_results: SearchResult<Feature>[]) => {\n          this.onSearch({ research: results[i], results: _results });\n        });\n      }\n    }\n  }\n\n  onOpenGoogleMaps() {\n    window.open(GoogleLinks.getGoogleMapsCoordLink(this.lonlat[0], this.lonlat[1]));\n  }\n\n  onOpenGoogleStreetView() {\n    window.open(\n      GoogleLinks.getGoogleStreetViewLink(this.lonlat[0], this.lonlat[1])\n    );\n  }\n}\n","<div id=\"bottomResultMobile\">\n  <mat-expansion-panel>\n    <mat-expansion-panel-header _expanded = true>\n      <igo-search-bar *ngIf=\"showSearchBar\"\n        #searchbar\n        (keydown.Space)=\"$event.stopPropagation()\"\n        appearance=\"outline\"\n        searchIcon =\"magnify\"\n        [matTooltip]=\"'search-bar' | translate\"\n        matTooltipShowDelay=\"500\"\n        tooltip-position=\"after\"\n        [searchSettings]=\"false\"\n        color=\"primary\"\n        [termSplitter]=\"termSplitter\"\n        [forceNA]=\"forceCoordsNA\"\n        [store]=\"searchStore\"\n        (searchTermChange)=\"onSearchTermChange($event)\"\n        [pointerSummaryEnabled]=\"igoSearchPointerSummaryEnabled\"\n        (pointerSummaryStatus)=\"onPointerSummaryStatusChange($event)\"\n        [searchResultsGeometryEnabled]=\"searchResultsGeometryEnabled\"\n        (searchResultsGeometryStatus)=\"onSearchResultsGeometryStatusChange($event)\"\n        \n        (clearFeature)=\"removeFeatureFromMap()\"\n        (searchSettingsChange)=\"onSearchSettingsChange()\"\n        >\n      </igo-search-bar>\n    </mat-expansion-panel-header>\n\n    <app-search-results-tool  \n      #searchresults\n      [showIcons]=\"true\"\n      placeholder=\"false\"\n      (resultSelect)=\"onResultFocus($event)\"\n      (moreResults)=\"onSearch($event)\"\n      >\n    </app-search-results-tool>\n\n  </mat-expansion-panel>\n</div>","import {\n  Component,\n  Input,\n  Output,\n  OnInit,\n  OnDestroy,\n  EventEmitter,\n  ChangeDetectionStrategy,\n  ElementRef,\n  ViewChild\n} from '@angular/core';\n\nimport * as proj from 'ol/proj';\nimport { LanguageService, MediaService } from '@igo2/core';\nimport { EntityStore, ActionStore } from '@igo2/common';\nimport { BehaviorSubject } from 'rxjs';\n\nimport {\n  IgoMap,\n  FEATURE,\n  Feature,\n  FeatureMotion,\n  GoogleLinks,\n  LayerService,\n  MapService,\n  Layer,\n  ProjectionService,\n  Research,\n  SearchResult,\n  SearchService\n} from '@igo2/geo';\nimport { CatalogState, SearchState } from '@igo2/integration';\nimport { ConfigService } from '@igo2/core';\n\n@Component({\n  selector: 'app-bottomresult',\n  templateUrl: './bottomresult.component.html',\n  styleUrls: ['./bottomresult.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class BottomResultComponent implements OnInit, OnDestroy {\n  title$: BehaviorSubject<string> = new BehaviorSubject<string>(undefined);\n  @Input() hasSearchQuery: boolean;\n\n  @Input()\n  get map(): IgoMap {\n    return this._map;\n  }\n  set map(value: IgoMap) {\n    this._map = value;\n  }\n  private _map: IgoMap;\n\n  @Input()\n  get opened(): boolean {\n    return this._opened;\n  }\n  set opened(value: boolean) {\n    if (value === this._opened) {\n      return;\n    }\n\n    this._opened = value;\n    this.openedChange.emit(this._opened);\n  }\n  private _opened: boolean;\n\n  @Output() openedChange = new EventEmitter<boolean>();\n\n  // SEARCH\n  events: string[] = [];\n  public showMenuButton: boolean;\n  public store = new ActionStore([]);\n  public showSearchBar: boolean;\n  public igoSearchPointerSummaryEnabled: boolean = false;\n  public panelOpenState: boolean;\n  public termSplitter: string = '|';\n\n  public view = {\n    center: [-73, 47.2],\n    zoom: 7\n  };\n\n  public osmLayer: Layer;\n\n  @ViewChild('mapBrowser', { read: ElementRef, static: true }) mapBrowser: ElementRef;\n\n  public lonlat;\n  public mapProjection: string;\n  public term: string;\n  public settingsChange$ = new BehaviorSubject<boolean>(undefined);\n\n  get searchStore(): EntityStore<SearchResult> {\n    return this.searchState.store;\n  }\n\n  get isTouchScreen(): boolean {\n    return this.mediaService.isTouchScreen();\n  }\n\n  public selectedFeature: Feature;\n\n  constructor(\n    private configService: ConfigService,\n    private catalogState: CatalogState,\n    //SEARCH\n    private languageService: LanguageService,\n    private projectionService: ProjectionService,\n    private mapService: MapService,\n    private layerService: LayerService,\n    private searchState: SearchState,\n    private searchService: SearchService,\n    private mediaService: MediaService,\n    private elRef: ElementRef\n    ) {\n      // SEARCH\n      this.mapService.setMap(this.map);\n      this.showSearchBar = this.configService.getConfig('showSearchBar') === undefined ? true :\n        this.configService.getConfig('showSearchBar');\n\n    this.layerService\n      .createAsyncLayer({\n        title: 'OSM',\n        sourceOptions: {\n          type: 'osm'\n        }\n      })\n      .subscribe(layer => {\n        this.osmLayer = layer;\n        //this.map.addLayer(layer);\n      });\n    }\n\n    //SEARCH\n\n    onPointerSummaryStatusChange(value) {\n      this.igoSearchPointerSummaryEnabled = value;\n    }\n\n    onSearchTermChange(term = '') {\n      this.term = term;\n      const termWithoutHashtag = term.replace(/(#[^\\s]*)/g, '').trim();\n      if (termWithoutHashtag.length < 2) {\n        this.searchStore.clear();\n        this.selectedFeature = undefined;\n        this.panelOpenState = true;\n      }\n    }\n\n    onSearch(event: { research: Research; results: SearchResult[] }) {\n      console.log('onSearch');\n      const results = event.results;\n      this.searchStore.state.updateAll({ focused: false, selected: false });\n      const newResults = this.searchStore.entities$.value\n        .filter((result: SearchResult) => result.source !== event.research.source)\n        .concat(results);\n      this.searchStore.updateMany(newResults);\n    }\n\n    onSearchSettingsChange() {\n      this.settingsChange$.next(true);\n    }\n\n    /**\n     * Try to add a feature to the map when it's being focused\n     * @internal\n     * @param result A search result that could be a feature\n     */\n    onResultFocus(result: SearchResult) {\n      this.tryAddFeatureToMap(result);\n      this.selectedFeature = (result as SearchResult<Feature>).data;\n    }\n\n    /**\n     * Try to add a feature to the map overlay\n     * @param layer A search result that could be a feature\n     */\n    private tryAddFeatureToMap(layer: SearchResult) {\n      if (layer.meta.dataType !== FEATURE) {\n        return undefined;\n      }\n\n      // Somethimes features have no geometry. It happens with some GetFeatureInfo\n      if (layer.data.geometry === undefined) {\n        return;\n      }\n\n      this.map.searchResultsOverlay.setFeatures(\n        [layer.data] as Feature[],\n        FeatureMotion.Default\n      );\n    }\n\n  ngOnInit() {\n    this.store.load([\n      {\n        id: 'coordinates',\n        title: 'coordinates',\n        handler: this.onSearchCoordinate.bind(this)\n      },\n      {\n        id: 'googleMaps',\n        title: 'googleMap',\n        handler: this.onOpenGoogleMaps.bind(this),\n        args: ['1']\n      },\n      {\n        id: 'googleStreetView',\n        title: 'googleStreetView',\n        handler: this.onOpenGoogleStreetView.bind(this)\n      }\n    ]);\n  }\n\n  ngOnDestroy() {\n    this.store.destroy();\n  }\n\n  //SEARCH\n  /*\n   * Remove a feature to the map overlay\n   */\n  removeFeatureFromMap() {\n    this.map.searchResultsOverlay.clear();\n  }\n\n  onContextMenuOpen(event: { x: number; y: number }) {\n    const position = this.mapPosition(event);\n    const coord = this.mapService.getMap().ol.getCoordinateFromPixel(position);\n    this.mapProjection = this.mapService.getMap().projection;\n    this.lonlat = proj.transform(coord, this.mapProjection, 'EPSG:4326');\n  }\n\n  mapPosition(event: { x: number; y: number }) {\n    const contextmenuPoint = event;\n    contextmenuPoint.y =\n      contextmenuPoint.y -\n      this.mapBrowser.nativeElement.getBoundingClientRect().top +\n      window.scrollY;\n    contextmenuPoint.x =\n      contextmenuPoint.x -\n      this.mapBrowser.nativeElement.getBoundingClientRect().left +\n      window.scrollX;\n    const position = [contextmenuPoint.x, contextmenuPoint.y];\n    return position;\n  }\n\n  onPointerSearch(event) {\n    this.lonlat = event;\n    this.onSearchCoordinate();\n  }\n\n  onSearchCoordinate() {\n    this.searchStore.clear();\n    const results = this.searchService.reverseSearch(this.lonlat);\n\n    for (const i in results) {\n      if (results.length > 0) {\n        results[i].request.subscribe((_results: SearchResult<Feature>[]) => {\n          this.onSearch({ research: results[i], results: _results });\n        });\n      }\n    }\n  }\n\n  onOpenGoogleMaps() {\n    window.open(GoogleLinks.getGoogleMapsCoordLink(this.lonlat[0], this.lonlat[1]));\n  }\n\n  onOpenGoogleStreetView() {\n    window.open(\n      GoogleLinks.getGoogleStreetViewLink(this.lonlat[0], this.lonlat[1])\n    );\n  }\n\n}\n","<mat-sidenav-container *ngIf=\"!hasToolbox\">\n  <mat-sidenav-content position=\"end\">\n\n    <igo-backdrop\n      [shown]=\"false\"\n      (click)=\"onBackdropClick()\">\n    </igo-backdrop>\n  \n    <div id=\"scaleLine\"></div>\n  \n    <div id=\"searchDesktop\" *ngIf=!mobile>\n      <igo-menu-button *ngIf=\"showMenuButton\"\n        [sidenavOpened]=\"sidenavOpened\"\n        (openSidenav)=\"onToggleSidenavClick()\">\n      </igo-menu-button>\n\n      <igo-search-bar *ngIf=\"showSearchBar\"\n        #searchbar\n        (pointerSummaryStatus)=\"onPointerSummaryStatusChange($event)\"\n        appearance=\"outline\"\n        searchIcon =\"magnify\"\n        [matTooltip]=\"'search-bar' | translate\"\n        matTooltipShowDelay=\"500\"\n        tooltip-position=\"after\"\n        [searchSettings]=\"false\"\n        color=\"primary\"\n        [store]=\"searchStore\"\n        [termSplitter]=\"termSplitter\"\n        (searchTermChange)=\"onSearchTermChange($event)\"\n        (search)=\"onSearch($event)\"\n        (clearFeature)=\"removeFeatureFromMap()\"\n        (searchSettingsChange)=\"onSearchSettingsChange()\">\n      </igo-search-bar>\n\n      <div *ngIf=\"!mobile\" id=\"scaleLine\"></div>\n\n      <app-sideresult\n        [map]=\"map\"\n        [(opened)]=\"sidenavOpened\"\n        (toolChange)=\"toolChanged($event)\">\n      </app-sideresult>\n    </div>\n\n    <igo-map-browser\n      #mapBrowser\n      igoMapContext\n      igoLayerContext\n      igoDropGeoFile\n      [map]=\"map\"\n      igoHoverFeature\n      [igoHoverFeatureEnabled]=\"true\"\n      [ngClass]=\"{'igo-attribution-offset': map.getBaseLayers().length > 1, 'map-hasfooter': hasFooter}\">\n        \n      <igo-baselayers-switcher\n        [ngClass]=\"sidenavOpened? ['baselayers-pushed'] : (mobile? ['igo-baselayers-switcher-mobile'] : ['baselayers'])\"\n        [map]=\"map\"\n        [useStaticIcon]=\"getBaseLayersUseStaticIcon()\">\n      </igo-baselayers-switcher>\n    \n      <div id=\"map-buttons\"\n      [ngClass]=\"mobile? ['map-buttons-mobile'] : ['map-buttons']\">\n        <igo-geolocate-button *ngIf=\"hasGeolocateButton\" [map]=\"map\" color=\"primary\"></igo-geolocate-button>\n        <igo-zoom-button [map]=\"map\" color=\"primary\"></igo-zoom-button>\n        <igo-rotation-button [showIfNoRotation]=\"showRotationButtonIfNoRotation\" [map]=\"map\" color=\"primary\"></igo-rotation-button>\n        <app-legend-button *ngIf=\"hasLegendButton\"></app-legend-button>\n      </div>\n\n        <app-bottomresult\n          *ngIf=\"mobile\"\n          [map]=\"map\">\n        </app-bottomresult>\n    </igo-map-browser>\n\n    <app-footer *ngIf=\"hasFooter && !mobile\" ></app-footer>\n\n    <app-map-overlay\n    [@controlStateY]=\"getControlsOffsetY()\"\n    [@controlStateX]=\"(mediaService.media$ | async) !== 'mobile' &&\n                            sidenavOpened ? 'right' : 'left'\">\n    </app-map-overlay>\n\n  </mat-sidenav-content>\n\n  \n</mat-sidenav-container>\n","import {\n  Component,\n  OnInit,\n  OnDestroy,\n  ViewChild,\n  ElementRef\n} from '@angular/core';\nimport { ActivatedRoute, Params } from '@angular/router';\nimport { Subscription, BehaviorSubject, combineLatest, zip } from 'rxjs';\nimport { debounceTime, take, skipWhile, first, distinctUntilChanged, tap, concatMap, delay } from 'rxjs/operators';\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\nimport * as olProj from 'ol/proj';\nimport { MatPaginator } from '@angular/material/paginator';\nimport { AuthOptions, AuthService } from '@igo2/auth';\nimport { HttpClient, HttpParams } from '@angular/common/http';\nimport olFormatGeoJSON from 'ol/format/GeoJSON';\nimport { BreakpointObserver, Breakpoints } from '@angular/cdk/layout';\nimport { ObjectUtils } from '@igo2/utils';\n\nimport {\n  MediaService,\n  Media,\n  MediaOrientation,\n  ConfigService,\n  LanguageService,\n  MessageService,\n  StorageService\n  } from '@igo2/core';\n\n  import {\n    ActionbarMode,\n    Workspace,\n    WorkspaceStore,\n    ActionStore,\n    EntityStore,\n    // getEntityTitle,\n    Toolbox,\n    Tool,\n    Widget,\n    EntityTablePaginatorOptions,\n    EntityRecord\n  } from '@igo2/common';\n\n  import { DetailedContext } from '@igo2/context';\n\n  import {\n  FEATURE,\n  Feature,\n  GoogleLinks,\n  LayerService,\n  Research,\n  SearchResult,\n  SearchSourceService,\n  CapabilitiesService,\n  sourceCanSearch,\n  sourceCanReverseSearch,\n  ImportService,\n  handleFileImportError,\n  handleFileImportSuccess,\n  WfsWorkspace,\n  FeatureWorkspace,\n  EditionWorkspace,\n  generateIdFromSourceOptions,\n  computeOlFeaturesExtent,\n  addStopToStore,\n  ImageLayer,\n  VectorLayer,\n  MapExtent,\n  IgoMap,\n  DataSourceService\n  } from '@igo2/geo';\n\nimport {\n  MapState,\n  WorkspaceState,\n  QueryState,\n  ContextState,\n  SearchState,\n  ToolState,\n  DirectionState\n} from '@igo2/integration';\n\nimport { PwaService } from '../../services/pwa.service';\n\nimport {\n  controlsAnimations, controlSlideX, controlSlideY\n} from './portal.animation';\n\n@Component({\n  selector: 'app-portal',\n  templateUrl: './portal.component.html',\n  styleUrls: ['./portal.component.scss'],\n  animations: [\n    controlsAnimations(),\n    controlSlideX(),\n    controlSlideY()\n  ]\n})\n\nexport class PortalComponent implements OnInit, OnDestroy {\n  public showRotationButtonIfNoRotation: boolean = undefined;\n  public hasFooter: boolean = true;\n  public hasLegendButton: boolean = true;\n  public hasGeolocateButton: boolean = true;\n  public hasExpansionPanel: boolean = undefined;\n  public hasToolbox: boolean = false;\n  public workspaceNotAvailableMessage: String = 'workspace.disabled.resolution';\n  public workspaceEntitySortChange$: BehaviorSubject<boolean> = new BehaviorSubject(false);\n  private workspaceMaximize$$: Subscription[] = [];\n  readonly workspaceMaximize$: BehaviorSubject<boolean> = new BehaviorSubject(\n    this.storageService.get('workspaceMaximize') as boolean\n  );\n  public selectedWorkspace$: BehaviorSubject<Workspace> = new BehaviorSubject(undefined);;\n  public hasSideSearch = true;\n  public showSearchBar = true;\n  public showMenuButton = true;\n  public sidenavOpened$: BehaviorSubject<boolean> = new BehaviorSubject(false);\n  @ViewChild('mapBrowser', { read: ElementRef, static: true })\n  mapBrowser: ElementRef;\n\n  public term: string;\n  public settingsChange$ = new BehaviorSubject<boolean>(undefined);\n\n  getBaseLayersUseStaticIcon(): Boolean {\n    return this.configService.getConfig('useStaticIcon');\n  }\n\n  public toastPanelOffsetX$: BehaviorSubject<string> = new BehaviorSubject(undefined);\n  public minSearchTermLength = 2;\n  public hasHomeExtentButton = false;\n  public hasFeatureEmphasisOnSelection: Boolean = false;\n  public workspacePaginator: MatPaginator;\n  public workspaceSwitchDisabled = false;\n  public paginatorOptions: EntityTablePaginatorOptions = {\n    pageSize: 50, // Number of items to display on a page.\n    pageSizeOptions: [1, 5, 10, 20, 50, 100, 500] // The set of provided page size options to display to the user.\n  };\n  public workspaceMenuClass = 'workspace-menu';\n\n  public fullExtent = this.storageService.get('fullExtent') as boolean;\n\n  public matDialogRef$ = new BehaviorSubject<MatDialogRef<any>>(undefined);\n  public searchBarTerm = '';\n  public onSettingsChange$ = new BehaviorSubject<boolean>(undefined);\n  public termDefinedInUrl = false;\n  public termSplitter = '|';\n  public termDefinedInUrlTriggered = false;\n  private addedLayers$$: Subscription[] = [];\n  public forceCoordsNA = false;\n\n  public contextMenuStore = new ActionStore([]);\n  private contextMenuCoord: [number, number];\n\n  private contextLoaded = false;\n  private context$$: Subscription;\n  private openSidenav$$: Subscription;\n  private sidenavMediaAndOrientation$$: Subscription;\n\n  public igoSearchPointerSummaryEnabled: boolean;\n\n  public toastPanelForExpansionOpened = true;\n  private activeWidget$$: Subscription;\n  public showToastPanelForExpansionToggle = false;\n  private routeParams: Params;\n  public toastPanelHtmlDisplay = false;\n  public mobile: boolean;\n  public homeExtent: MapExtent;\n  public homeCenter: [number, number];\n  public homeZoom: number;\n  @ViewChild('searchBar', { read: ElementRef, static: true })\n  searchBar: ElementRef;\n\n  public dialogOpened = this.dialog.getDialogById('legend-button-dialog-container');\n\n  get map(): IgoMap {\n    return this.mapState.map;\n  }\n\n  get sidenavOpened(): boolean {\n    return this.sidenavOpened$.value;\n  }\n\n  set sidenavOpened(value: boolean) {\n    this.sidenavOpened$.next(value);\n  }\n\n  get auth(): AuthOptions {\n    return this.configService.getConfig('auth') || [];\n  }\n\n  // Responsiveness\n\n  isMobile(): boolean {\n    return this.mediaService.getMedia() === Media.Mobile;\n  }\n\n  isTablet(): boolean {\n    return this.mediaService.getMedia() === Media.Tablet;\n  }\n\n  isLandscape(): boolean {\n    return this.mediaService.getOrientation() === MediaOrientation.Landscape;\n  }\n\n  isPortrait(): boolean {\n    return this.mediaService.getOrientation() === MediaOrientation.Portrait;\n  }\n\n  public mobileBreakPoint: string = '(min-width: 768px)';\n  public Breakpoints = Breakpoints;\n  public currentBreakpoint: string = '';\n\n  get backdropShown(): boolean {\n    return (\n      ('(min-width: 768px)' &&\n      this.sidenavOpened\n    ));\n  }\n\n  get expansionPanelExpanded(): boolean {\n    return this.workspaceState.workspacePanelExpanded;\n  }\n  set expansionPanelExpanded(value: boolean) {\n    this.workspaceState.workspacePanelExpanded = value;\n    if (value === true) {\n      this.map.viewController.setPadding({bottom: 280});\n    } else {\n      this.map.viewController.setPadding({bottom: 0});\n    }\n  }\n\n  get toastPanelShown(): boolean {\n    return true;\n  }\n\n  get expansionPanelBackdropShown(): boolean {\n    return this.expansionPanelExpanded && this.toastPanelForExpansionOpened;\n  }\n\n  get workspace(): Workspace {\n    return this.workspaceState.workspace$.value;\n  }\n\n  get actionbarMode(): ActionbarMode {\n    return ActionbarMode.Overlay;\n  }\n\n  get actionbarWithTitle(): boolean {\n    return this.actionbarMode === ActionbarMode.Overlay;\n  }\n\n  get searchStore(): EntityStore<SearchResult> {\n    return this.searchState.store;\n  }\n\n  get searchResultsGeometryEnabled(): boolean {\n    return this.searchState.searchResultsGeometryEnabled$.value;\n  }\n\n  get toolbox(): Toolbox {\n    return this.toolState.toolbox;\n  }\n\n  get workspaceStore(): WorkspaceStore {\n    return this.workspaceState.store;\n  }\n\n  constructor(\n    private route: ActivatedRoute,\n    public workspaceState: WorkspaceState,\n    public authService: AuthService,\n    public mediaService: MediaService,\n    public layerService: LayerService,\n    public dataSourceService: DataSourceService,\n    public capabilitiesService: CapabilitiesService,\n    private contextState: ContextState,\n    private mapState: MapState,\n    private searchState: SearchState,\n    private queryState: QueryState,\n    private toolState: ToolState,\n    private searchSourceService: SearchSourceService,\n    private configService: ConfigService,\n    private importService: ImportService,\n    private http: HttpClient,\n    private languageService: LanguageService,\n    private messageService: MessageService,\n    public dialogWindow: MatDialog,\n    private storageService: StorageService,\n    private directionState: DirectionState,\n    public dialog: MatDialog,\n    private breakpointObserver: BreakpointObserver,\n    private pwaService: PwaService\n  ) {\n      this.hasFooter = this.configService.getConfig('hasFooter') === undefined ? false :\n        this.configService.getConfig('hasFooter');\n      this.hasLegendButton = this.configService.getConfig('hasLegendButton') === undefined ? false :\n        this.configService.getConfig('hasLegendButton');\n      this.hasSideSearch = this.configService.getConfig('hasSideSearch') === undefined ? true :\n        this.configService.getConfig('hasSideSearch');\n        this.showSearchBar = this.configService.getConfig('searchBar.showSearchBar') === undefined ? true :\n        this.configService.getConfig('searchBar.showSearchBar');\n      this.hasToolbox = this.configService.getConfig('hasToolbox') === undefined ? true :\n        this.configService.getConfig('hasToolbox');\n      this.showMenuButton = this.configService.getConfig('showMenuButton') === undefined ? true :\n      this.configService.getConfig('showMenuButton');\n      this.hasExpansionPanel = this.configService.getConfig('hasExpansionPanel');\n      this.hasHomeExtentButton =\n        this.configService.getConfig('homeExtentButton') === undefined ? false : true;\n      this.hasGeolocateButton = this.configService.getConfig('hasGeolocateButton') === undefined ? true :\n        this.configService.getConfig('hasGeolocateButton');\n      this.showRotationButtonIfNoRotation = this.configService.getConfig('showRotationButtonIfNoRotation') === undefined ? false :\n        this.configService.getConfig('showRotationButtonIfNoRotation');\n      this.forceCoordsNA = this.configService.getConfig('app.forceCoordsNA');\n      this.hasFeatureEmphasisOnSelection = this.configService.getConfig('hasFeatureEmphasisOnSelection');\n      this.igoSearchPointerSummaryEnabled = this.configService.getConfig('hasSearchPointerSummary');\n      if (this.igoSearchPointerSummaryEnabled === undefined) {\n        this.igoSearchPointerSummaryEnabled = this.storageService.get('searchPointerSummaryEnabled') as boolean || false;\n      }\n      this.mobileBreakPoint = this.configService.getConfig('mobileBreakPoint') === undefined ? \"'(min-width: 768px)'\" :\n        this.configService.getConfig('mobileBreakPoint');\n  }\n\n  ngOnInit() {\n    window['IGO'] = this;\n    this.hasGeolocateButton = this.configService.getConfig('hasGeolocateButton') === undefined ? true :\n      this.configService.getConfig('hasGeolocateButton');\n\n    this.map.ol.once('rendercomplete', () => {\n      this.readQueryParams();\n      if (this.configService.getConfig('geolocate.activateDefault') !== undefined) {\n        this.map.geolocationController.tracking = this.configService.getConfig('geolocate.activateDefault');\n      }\n\n    });\n\n    this.searchState.searchTermSplitter$.next(this.termSplitter);\n\n    this.authService.authenticate$.subscribe((authenticated) => {\n      this.contextLoaded = false;\n    });\n\n    this.route.queryParams.subscribe((params) => {\n      this.readLanguageParam(params);\n    });\n\n    this.context$$ = this.contextState.context$.subscribe(\n      (context: DetailedContext) => this.onChangeContext(context)\n    );\n\n    const contextActions = [{\n      id: 'coordinates',\n      title: 'coordinates',\n      handler: () => this.searchCoordinate(this.contextMenuCoord)\n    },\n    {\n      id: 'googleMaps',\n      title: 'googleMap',\n      handler: () => this.openGoogleMaps(this.contextMenuCoord)\n    },\n    {\n      id: 'googleStreetView',\n      title: 'googleStreetView',\n      handler: () => this.openGoogleStreetView(this.contextMenuCoord)\n    }];\n\n    this.contextMenuStore.load(contextActions);\n\n    this.onSettingsChange$.subscribe(() => {\n      this.searchState.setSearchSettingsChange();\n    });\n\n    this.searchState.selectedResult$.subscribe((result) => {\n      if (result && this.isMobile()) {\n        this.closeSidenav();\n      }\n    });\n\n    this.workspaceState.workspaceEnabled$.next(this.hasExpansionPanel);\n    this.workspaceState.store.empty$.subscribe((workspaceEmpty) => {\n      if (!this.hasExpansionPanel) {\n        return;\n      }\n      this.workspaceState.workspaceEnabled$.next(workspaceEmpty ? false : true);\n      if (workspaceEmpty) {\n        this.expansionPanelExpanded = false;\n      }\n      this.updateMapBrowserClass();\n    });\n\n    this.workspaceState.workspace$.subscribe((activeWks: WfsWorkspace | FeatureWorkspace | EditionWorkspace) => {\n      if (activeWks) {\n        this.selectedWorkspace$.next(activeWks);\n        this.expansionPanelExpanded = true;\n\n        if (activeWks.layer.options.workspace?.pageSize && activeWks.layer.options.workspace?.pageSizeOptions) {\n          this.paginatorOptions = {\n            pageSize: activeWks.layer.options.workspace?.pageSize,\n            pageSizeOptions: activeWks.layer.options.workspace?.pageSizeOptions\n          };\n        } else {\n          this.paginatorOptions = {\n            pageSize: 50,\n            pageSizeOptions: [1, 5, 10, 20, 50, 100, 500]\n          };\n        }\n      } else {\n        this.expansionPanelExpanded = false;\n      }\n    });\n\n    this.activeWidget$$ = this.workspaceState.activeWorkspaceWidget$.subscribe(\n      (widget: Widget) => {\n        if (widget !== undefined) {\n          this.openToastPanelForExpansion();\n          this.showToastPanelForExpansionToggle = true;\n        } else {\n          this.closeToastPanelForExpansion();\n          this.showToastPanelForExpansionToggle = false;\n        }\n      }\n    );\n\n    this.openSidenav$$ = this.toolState.openSidenav$.subscribe(\n      (openSidenav: boolean) => {\n        if (openSidenav) {\n          this.openSidenav();\n          this.toolState.openSidenav$.next(false);\n        }\n      }\n    );\n\n    this.sidenavMediaAndOrientation$$ =\n      combineLatest([\n        this.sidenavOpened$,\n        this.mediaService.media$,\n        this.mediaService.orientation$]\n      ).pipe(\n        debounceTime(50)\n      ).subscribe(() => {\n        this.computeToastPanelOffsetX();\n      });\n\n    // RESPONSIVE BREAKPOINTS\n    this.breakpoint$.subscribe(() =>\n      this.breakpointChanged()\n    );\n  }\n\n  private initSW() {\n    const dataDownload = this.configService.getConfig('pwa.dataDownload');\n    if ('serviceWorker' in navigator && dataDownload) {\n      let downloadMessage;\n      let currentVersion;\n      const dataLoadSource = this.storageService.get('dataLoadSource');\n      navigator.serviceWorker.ready.then((registration) => {\n        console.log('Service Worker Ready');\n        this.http.get('ngsw.json').pipe(\n          concatMap((ngsw: any) => {\n            const datas$ = [];\n            let hasDataInDataDir: boolean = false;\n            if (ngsw) {\n              // IF FILE NOT IN THIS LIST... DELETE?\n              currentVersion = ngsw.appData.version;\n              const cachedDataVersion = this.storageService.get('cachedDataVersion');\n              if (currentVersion !== cachedDataVersion && dataLoadSource === 'pending') {\n                this.pwaService.updates.checkForUpdate();\n              }\n              if (dataLoadSource === 'newVersion' || !dataLoadSource) {\n                ((ngsw as any).assetGroups as any).map((assetGroup) => {\n                  if (assetGroup.name === 'contexts') {\n                    const elemToDownload = assetGroup.urls.concat(assetGroup.files).filter(f => f);\n                    elemToDownload.map((url, i) => datas$.push(this.http.get(url).pipe(delay(750))));\n                  }\n                });\n                if (hasDataInDataDir) {\n                  const message = this.languageService.translate.instant('pwa.data-download-start');\n                  downloadMessage = this.messageService\n                    .info(message, undefined, { disableTimeOut: true, progressBar: false, closeButton: true, tapToDismiss: false });\n                  this.storageService.set('cachedDataVersion', currentVersion);\n                }\n                return zip(...datas$);\n              }\n\n            }\n            return zip(...datas$);\n          })\n        )\n          .pipe(delay(1000))\n          .subscribe(() => {\n            if (downloadMessage) {\n              this.messageService.remove((downloadMessage as any).toastId);\n              const message = this.languageService.translate.instant('pwa.data-download-completed');\n              this.messageService.success(message, undefined, { timeOut: 40000 });\n              if (currentVersion) {\n                this.storageService.set('dataLoadSource', 'pending');\n                this.storageService.set('cachedDataVersion', currentVersion);\n              }\n            }\n          });\n\n      });\n    }\n  }\n\n  public breakpointChanged() {\n    if(this.breakpointObserver.isMatched('(min-width: 768px)')) { // this.mobileBreakPoint is used before its initialization\n      this.currentBreakpoint = this.mobileBreakPoint;\n      this.mobile = false;\n    } else {\n      this.mobile = true;\n    }\n  }\n\n  readonly breakpoint$ = this.breakpointObserver\n  .observe(this.mobileBreakPoint)\n  .pipe(\n    tap(() => {}),\n    distinctUntilChanged()\n  );\n\n  computeToastPanelOffsetX() {\n    if (this.isMobile() || !this.isLandscape()) {\n      Promise.resolve().then(() => this.toastPanelOffsetX$.next(undefined));\n    } else {\n      Promise.resolve().then(() => this.toastPanelOffsetX$.next(this.getToastPanelExtent()));\n    }\n  }\n\n  createFeatureProperties(layer: ImageLayer | VectorLayer) {\n    let properties = {};\n    layer.options.sourceOptions.sourceFields.forEach(field => {\n      if (!field.primary && field.visible) {\n        properties[field.name] = '';\n      }\n    });\n    return properties;\n  }\n\n  entitySortChange() {\n    this.workspaceEntitySortChange$.next(true);\n  }\n\n  ngOnDestroy() {\n    this.context$$.unsubscribe();\n    this.activeWidget$$.unsubscribe();\n    this.openSidenav$$.unsubscribe();\n    this.workspaceMaximize$$.map(f => f.unsubscribe());\n    this.sidenavMediaAndOrientation$$.unsubscribe();\n  }\n\n  removeFeatureFromMap() {\n    this.map.searchResultsOverlay.clear();\n  }\n\n  /**\n   * Cancel ongoing add layer, if any\n   */\n   private cancelOngoingAddLayer() {\n    this.addedLayers$$.forEach((sub: Subscription) => sub.unsubscribe());\n    this.addedLayers$$ = [];\n  }\n\n  onBackdropClick() {\n    this.closeSidenav();\n  }\n\n  onToggleSidenavClick() {\n    this.toggleSidenav();\n  }\n\n  closeToastPanelForExpansion() {\n    this.toastPanelForExpansionOpened = false;\n  }\n\n  openToastPanelForExpansion() {\n    this.toastPanelForExpansionOpened = true;\n  }\n\n  onSearchTermChange(term?: string) {\n    if (this.routeParams?.search && term !== this.routeParams.search) {\n      this.searchState.deactivateCustomFilterTermStrategy();\n    }\n\n    this.searchState.setSearchTerm(term);\n    const termWithoutHashtag = term.replace(/(#[^\\s]*)/g, '').trim();\n    if (termWithoutHashtag.length < 2) {\n      this.onClearSearch();\n      return;\n    }\n    this.onBeforeSearch();\n  }\n\n  onSearch(event: { research: Research; results: SearchResult[] }) {\n    const results = event.results;\n\n    const isReverseSearch = !sourceCanSearch(event.research.source);\n\n    let enabledSources;\n    if (isReverseSearch) {\n      enabledSources = this.searchSourceService\n        .getEnabledSources()\n        .filter(sourceCanReverseSearch);\n    } else {\n      enabledSources = this.searchSourceService\n        .getEnabledSources()\n        .filter(sourceCanSearch);\n    }\n\n    const newResults = this.searchStore.entities$.value\n      .filter(\n        (result: SearchResult) =>\n          result.source !== event.research.source &&\n          enabledSources.includes(result.source)\n      )\n      .concat(results);\n    this.searchStore.updateMany(newResults);\n  }\n\n  onSearchSettingsChange() {\n    this.onSettingsChange$.next(true);\n  }\n\n  private closeSidenav() {\n    this.sidenavOpened = false;\n    this.map.viewController.padding[3] = 0;\n  }\n\n  private openSidenav() {\n    this.sidenavOpened = true;\n    this.map.viewController.padding[3] = this.isMobile() ? 0 : 400;\n  }\n\n  private toggleSidenav() {\n    this.sidenavOpened ? this.closeSidenav() : this.openSidenav();\n    this.computeToastPanelOffsetX();\n  }\n\n  public toolChanged(tool: Tool) {\n    if (tool && tool.name === 'searchResults' && this.searchBar) {\n      this.searchBar.nativeElement.getElementsByTagName('input')[0].focus();\n    }\n  }\n\n  private computeHomeExtentValues(context: DetailedContext) {\n    if (context?.map?.view?.homeExtent) {\n      this.homeExtent = context.map.view.homeExtent.extent;\n      this.homeCenter = context.map.view.homeExtent.center;\n      this.homeZoom = context.map.view.homeExtent.zoom;\n    } else {\n      this.homeExtent = undefined;\n      this.homeCenter = undefined;\n      this.homeZoom = undefined;\n    }\n\n  }\n\n  private onChangeContext(context: DetailedContext) {\n    this.cancelOngoingAddLayer();\n    if (context === undefined) {\n      return;\n    }\n    if (this.workspace && !this.workspace.entityStore.empty) {\n      this.workspace.entityStore.clear();\n    }\n    if (!this.queryState.store.empty) {\n      this.queryState.store.softClear();\n    }\n\n    this.computeHomeExtentValues(context);\n\n    this.route.queryParams.pipe(debounceTime(250)).subscribe((qParams) => {\n      if (!qParams['context'] || qParams['context'] === context.uri) {\n        this.readLayersQueryParams(qParams);\n      }\n    });\n\n    if (this.contextLoaded) {\n      const contextManager = this.toolbox.getTool('contextManager');\n      const contextManagerOptions = contextManager\n        ? contextManager.options\n        : {};\n      let toolToOpen = contextManagerOptions.toolToOpenOnContextChange;\n\n      if (!toolToOpen) {\n        const toolOrderToOpen = ['mapTools', 'map', 'mapDetails', 'mapLegend'];\n        for (const toolName of toolOrderToOpen) {\n          if (this.toolbox.getTool(toolName)) {\n            toolToOpen = toolName;\n            break;\n          }\n        }\n      }\n\n      if (toolToOpen) {\n        this.toolbox.activateTool(toolToOpen);\n      }\n    }\n\n    this.contextLoaded = true;\n  }\n\n  private onBeforeSearch() {\n    if (\n      !this.toolbox.activeTool$.value ||\n      this.toolbox.activeTool$.value.name !== 'searchResults'\n    ) {\n      this.toolbox.activateTool('searchResults');\n    }\n    this.openSidenav();\n  }\n\n  public onClearSearch() {\n    this.map.searchResultsOverlay.clear();\n    this.searchStore.clear();\n    this.searchState.setSelectedResult(undefined);\n    this.searchState.deactivateCustomFilterTermStrategy();\n  }\n\n  onContextMenuOpen(event: { x: number; y: number }) {\n    this.contextMenuCoord = this.getClickCoordinate(event) as [number, number];\n  }\n\n  private getClickCoordinate(event: { x: number; y: number }) {\n    const contextmenuPoint = event;\n    const boundingMapBrowser = this.mapBrowser.nativeElement.getBoundingClientRect();\n    contextmenuPoint.y =\n      contextmenuPoint.y -\n      boundingMapBrowser.top +\n      (window.scrollY || window.pageYOffset);\n    contextmenuPoint.x =\n      contextmenuPoint.x -\n      boundingMapBrowser.left +\n      (window.scrollX || window.pageXOffset);\n    const pixel = [contextmenuPoint.x, contextmenuPoint.y];\n\n    const coord = this.map.ol.getCoordinateFromPixel(pixel);\n    const proj = this.map.projection;\n    return olProj.transform(coord, proj, 'EPSG:4326');\n  }\n\n  private openGoogleMaps(coord: [number, number]) {\n    window.open(GoogleLinks.getGoogleMapsCoordLink(coord[0], coord[1]));\n  }\n\n  private openGoogleStreetView(coord: [number, number]) {\n    window.open(GoogleLinks.getGoogleStreetViewLink(coord[0], coord[1]));\n  }\n\n  searchCoordinate(coord: [number, number]) {\n    this.searchBarTerm = coord.map((c) => c.toFixed(6)).join(', ');\n  }\n\n  updateMapBrowserClass() {\n    const header = this.queryState.store.entities$.value.length > 0;\n    if (this.hasExpansionPanel && this.workspaceState.workspaceEnabled$.value) {\n      this.mapBrowser.nativeElement.classList.add('has-expansion-panel');\n    } else {\n      this.mapBrowser.nativeElement.classList.remove('has-expansion-panel');\n    }\n\n    if (this.hasExpansionPanel && this.expansionPanelExpanded) {\n      if (this.workspaceMaximize$.value) {\n        this.mapBrowser.nativeElement.classList.add('expansion-offset-maximized');\n        this.mapBrowser.nativeElement.classList.remove('expansion-offset');\n      } else {\n        this.mapBrowser.nativeElement.classList.add('expansion-offset');\n        this.mapBrowser.nativeElement.classList.remove('expansion-offset-maximized');\n      }\n    } else {\n      if (this.workspaceMaximize$.value) {\n        this.mapBrowser.nativeElement.classList.remove('expansion-offset-maximized');\n      } else {\n        this.mapBrowser.nativeElement.classList.remove('expansion-offset');\n      }\n    }\n\n    if (this.sidenavOpened) {\n      this.mapBrowser.nativeElement.classList.add('sidenav-offset');\n    } else {\n      this.mapBrowser.nativeElement.classList.remove('sidenav-offset');\n    }\n\n    if (this.sidenavOpened && !this.isMobile()) {\n      this.mapBrowser.nativeElement.classList.add('sidenav-offset-baselayers');\n    } else {\n      this.mapBrowser.nativeElement.classList.remove(\n        'sidenav-offset-baselayers'\n      );\n    }\n\n    if (\n      header &&\n      (this.isMobile() || this.isTablet() || this.sidenavOpened) &&\n      !this.expansionPanelExpanded\n    ) {\n      this.mapBrowser.nativeElement.classList.add('toast-offset-attribution');\n    } else {\n      this.mapBrowser.nativeElement.classList.remove(\n        'toast-offset-attribution'\n      );\n    }\n  }\n\n  getToastPanelExtent() {\n    if (!this.sidenavOpened) {\n      if (this.toastPanelHtmlDisplay && this.mediaService.isDesktop()) {\n        return 'htmlDisplay';\n      }\n      if (this.fullExtent) {\n        return 'fullStandard';\n      } else {\n        return 'standard';\n      }\n    } else if (this.sidenavOpened) {\n      if (this.toastPanelHtmlDisplay && this.mediaService.isDesktop()) {\n        return 'htmlDisplayOffsetX';\n      }\n      if (this.fullExtent) {\n        return 'fullOffsetX';\n      } else {\n        return 'standardOffsetX';\n      }\n    }\n  }\n\n  onPointerSummaryStatusChange(value) {\n    this.storageService.set('searchPointerSummaryEnabled', value);\n    this.igoSearchPointerSummaryEnabled = value;\n  }\n\n  getControlsOffsetY() {\n    return this.expansionPanelExpanded ?\n      this.workspaceMaximize$.value ? 'firstRowFromBottom-expanded-maximized' : 'firstRowFromBottom-expanded' :\n      'firstRowFromBottom';\n  }\n\n  private readQueryParams() {\n    this.route.queryParams.subscribe((params) => {\n      this.routeParams = params;\n      this.readToolParams();\n      this.readSearchParams();\n      this.readFocusFirst();\n      this.computeZoomToExtent();\n    });\n  }\n\n  private readLanguageParam(params) {\n    if (params['lang']) {\n      this.authService.languageForce = true;\n      this.languageService.setLanguage(params['lang']);\n    }\n  }\n\n  private computeZoomToExtent() {\n    if (this.routeParams['zoomExtent']) {\n      const extentParams = this.routeParams['zoomExtent'].split(',');\n      const olExtent = olProj.transformExtent(\n        extentParams,\n        'EPSG:4326',\n        this.map.projection\n      );\n      this.map.viewController.zoomToExtent(olExtent as [number, number, number, number]);\n    }\n  }\n\n  private computeFocusFirst() {\n    setTimeout(() => {\n      const resultItem: any = document\n        .getElementsByTagName('igo-search-results-item')\n        .item(0);\n      if (resultItem) {\n        resultItem.click();\n      }\n    }, 1);\n  }\n\n  private readFocusFirst() {\n    if (this.routeParams['sf'] === '1' && this.termDefinedInUrl) {\n      const entities$$ = this.searchStore.stateView.all$()\n        .pipe(\n          skipWhile((entities) => entities.length === 0),\n          debounceTime(1000),\n          take(1)\n        )\n        .subscribe((entities) => {\n          entities$$.unsubscribe();\n          if (entities.length && !this.termDefinedInUrlTriggered) {\n            this.computeFocusFirst();\n            this.termDefinedInUrlTriggered = true;\n          }\n        });\n    }\n  }\n\n  private readSearchParams() {\n    if (this.routeParams['search']) {\n      this.termDefinedInUrl = true;\n      if (this.routeParams['exactMatch'] === '1') {\n        this.searchState.activateCustomFilterTermStrategy();\n      }\n      if (this.routeParams['search'] && !this.routeParams['zoom'] && this.routeParams['sf'] !== '1') {\n        const entities$$ = this.searchStore.stateView.all$()\n          .pipe(\n            skipWhile((entities) => entities.length === 0),\n            debounceTime(500),\n            take(1)\n          )\n          .subscribe((entities) => {\n            entities$$.unsubscribe();\n            const searchResultsOlFeatures = entities\n              .filter(e => e.entity.meta.dataType === FEATURE)\n              .map((entity: EntityRecord<SearchResult>) =>\n                new olFormatGeoJSON().readFeature(entity.entity.data, {\n                  dataProjection: entity.entity.data.projection,\n                  featureProjection: this.map.projection\n                })\n              );\n            const totalExtent = computeOlFeaturesExtent(this.map, searchResultsOlFeatures);\n            this.map.viewController.zoomToExtent(totalExtent);\n          });\n      }\n      this.searchBarTerm = this.routeParams['search'];\n    }\n    if (this.routeParams['searchGeom'] === '1') {\n      this.searchState.searchResultsGeometryEnabled$.next(true);\n    }\n  }\n\n  private readToolParams() {\n    if (this.routeParams['tool']) {\n      this.matDialogRef$.pipe(\n        skipWhile(r => r !== undefined),\n        first()\n      ).subscribe(matDialogOpened => {\n        if (!matDialogOpened) {\n          this.toolbox.activateTool(this.routeParams['tool']);\n        }\n      });\n    }\n\n    if (this.routeParams['sidenav'] === '1') {\n      setTimeout(() => {\n        this.openSidenav();\n      }, 250);\n    }\n\n    if (this.routeParams['routing']) {\n      let routingCoordLoaded = false;\n      const stopCoords = this.routeParams['routing'].split(';');\n      const routingOptions = this.routeParams['routingOptions'];\n      let resultSelection: number;\n      if (routingOptions) {\n        resultSelection = parseInt(routingOptions.split('result:')[1], 10);\n      }\n      this.directionState.stopsStore.storeInitialized$\n        .pipe(skipWhile(init => !init), first())\n        .subscribe((init: boolean) => {\n          if (init && !routingCoordLoaded) {\n            routingCoordLoaded = true;\n            stopCoords.map((coord, i) => {\n              if (i > 1) {\n                addStopToStore(this.directionState.stopsStore);\n              }\n            });\n            setTimeout(() => {\n              stopCoords.map((coord, i) => {\n                const stop = this.directionState.stopsStore.all().find(e => e.position === i);\n                stop.text = coord;\n                stop.coordinates = coord.split(',');\n                this.directionState.stopsStore.update(stop);\n              });\n            }, this.directionState.debounceTime * 1.25); // this delay is due to the default component debounce time\n          }\n        });\n      // zoom to active route\n      this.directionState.routesFeatureStore.count$\n        .pipe(skipWhile(c => c < 1), first())\n        .subscribe(c => {\n          if (c >= 1) {\n            this.directionState.zoomToActiveRoute$.next();\n          }\n        });\n      // select the active route by url controls\n      this.directionState.routesFeatureStore.count$\n        .pipe(skipWhile(c => c < 2), first())\n        .subscribe(() => {\n          if (resultSelection) {\n            this.directionState.routesFeatureStore.entities$.value.map(d => d.properties.active = false);\n            this.directionState.routesFeatureStore.entities$.value[resultSelection].properties.active = true;\n            this.directionState.zoomToActiveRoute$.next();\n          }\n        });\n    }\n  }\n\n  private readLayersQueryParams(params: Params) {\n    this.readLayersQueryParamsByType(params, 'wms');\n    this.readLayersQueryParamsByType(params, 'wmts');\n    this.readLayersQueryParamsByType(params, 'arcgisrest');\n    this.readLayersQueryParamsByType(params, 'imagearcgisrest');\n    this.readLayersQueryParamsByType(params, 'tilearcgisrest');\n    this.readVectorQueryParams(params);\n  }\n\n  getQueryParam(name, url) {\n    let paramValue;\n    if (url.includes('?')) {\n      const httpParams = new HttpParams({ fromString: url.split('?')[1] });\n      paramValue = httpParams.get(name);\n    }\n    return paramValue;\n  }\n\n  private readLayersQueryParamsByType(params: Params, type) {\n    let nameParamLayersKey;\n    let urlsKey;\n    switch (type) {\n      case 'wms':\n        if ((params['layers'] || params['wmsLayers']) && params['wmsUrl']) {\n          urlsKey = 'wmsUrl';\n          nameParamLayersKey = params['wmsLayers'] ? 'wmsLayers' : 'layers'; // for maintain compatibility\n        }\n        break;\n      case 'wmts':\n        if (params['wmtsLayers'] && params['wmtsUrl']) {\n          urlsKey = 'wmtsUrl';\n          nameParamLayersKey = 'wmtsLayers';\n        }\n        break;\n      case 'arcgisrest':\n        if (params['arcgisLayers'] && params['arcgisUrl']) {\n          urlsKey = 'arcgisUrl';\n          nameParamLayersKey = 'arcgisLayers';\n        }\n        break;\n      case 'imagearcgisrest':\n        if (params['iarcgisLayers'] && params['iarcgisUrl']) {\n          urlsKey = 'iarcgisUrl';\n          nameParamLayersKey = 'iarcgisLayers';\n        }\n        break;\n      case 'tilearcgisrest':\n        if (params['tarcgisLayers'] && params['tarcgisUrl']) {\n          urlsKey = 'tarcgisUrl';\n          nameParamLayersKey = 'tarcgisLayers';\n        }\n        break;\n    }\n    if (!nameParamLayersKey || !urlsKey) {\n      return;\n    }\n    const layersByService = params[nameParamLayersKey].split('),(');\n    const urls = params[urlsKey].split(',');\n\n    let cnt = 0;\n    urls.forEach((urlSrc) => {\n      let url = urlSrc;\n      const version =\n        this.getQueryParam('VERSION', url) ||\n        this.getQueryParam('version', url) ||\n        undefined;\n      if (version) {\n        url = url.replace('VERSION=' + version, '').replace('version=' + version, '');\n      }\n\n      const currentLayersByService = this.extractLayersByService(\n        layersByService[cnt]\n      );\n      currentLayersByService.forEach((layer) => {\n        const layerFromUrl = layer.split(':igoz');\n        const layerOptions = ObjectUtils.removeUndefined({\n          type,\n          url: url,\n          layer: layerFromUrl[0],\n          params: type === 'wms' ? { LAYERS: layerFromUrl[0] } : undefined\n        });\n        const id = generateIdFromSourceOptions(layerOptions);\n        const visibility = this.computeLayerVisibilityFromUrl(params, id);\n        this.addLayerFromURL(\n          url,\n          layerFromUrl[0],\n          type,\n          version,\n          visibility,\n          layerFromUrl[1] ? parseInt(layerFromUrl[1], 10) : undefined\n        );\n      });\n      cnt += 1;\n    });\n  }\n\n  private readVectorQueryParams(params: Params) {\n    if (params['vector']) {\n      const url = params['vector'] as string;\n      const lastIndex = url.lastIndexOf('/');\n      const fileName = url.slice(lastIndex + 1, url.length);\n\n      this.http.get(`${url}`, { responseType: 'blob' }).subscribe((data) => {\n        const file = new File([data], fileName, {\n          type: data.type,\n          lastModified: Date.now()\n        });\n        this.importService.import(file).subscribe(\n          (features: Feature[]) => this.onFileImportSuccess(file, features),\n          (error: Error) => this.onFileImportError(file, error)\n        );\n      });\n    }\n  }\n\n  private onFileImportSuccess(file: File, features: Feature[]) {\n    handleFileImportSuccess(\n      file,\n      features,\n      this.map,\n      this.messageService,\n      this.languageService\n    );\n  }\n\n  private onFileImportError(file: File, error: Error) {\n    handleFileImportError(\n      file,\n      error,\n      this.messageService,\n      this.languageService\n    );\n  }\n\n  private extractLayersByService(layersByService: string): any[] {\n    let outLayersByService = layersByService;\n    outLayersByService = outLayersByService.startsWith('(')\n      ? outLayersByService.substr(1)\n      : outLayersByService;\n    outLayersByService = outLayersByService.endsWith(')')\n      ? outLayersByService.slice(0, -1)\n      : outLayersByService;\n    return outLayersByService.split(',');\n  }\n  private addLayerFromURL(\n    url: string,\n    name: string,\n    type: 'wms' | 'wmts' | 'arcgisrest' | 'imagearcgisrest' | 'tilearcgisrest',\n    version: string,\n    visibility: boolean = true,\n    zIndex: number\n  ) {\n    if (!this.contextLoaded) {\n      return;\n    }\n    const commonSourceOptions = {\n      optionsFromCapabilities: true,\n      optionsFromApi: true,\n      crossOrigin: true,\n      type,\n      url\n    };\n    const arcgisClause = (type === 'arcgisrest' || type === 'imagearcgisrest' || type === 'tilearcgisrest');\n    let sourceOptions = {\n      version: type === 'wmts' ? '1.0.0' : undefined,\n      queryable: arcgisClause ? true : false,\n      queryFormat: arcgisClause ? 'esrijson' : undefined,\n      layer: name\n    };\n    if (type === 'wms') {\n      sourceOptions = { params: { LAYERS: name, VERSION: version } } as any;\n    }\n\n    sourceOptions = ObjectUtils.removeUndefined(Object.assign({}, sourceOptions, commonSourceOptions));\n\n    this.addedLayers$$.push(\n      this.layerService\n        .createAsyncLayer({\n          zIndex: zIndex,\n          visible: visibility,\n          sourceOptions\n        })\n        .subscribe((l) => {\n          this.map.addLayer(l);\n        })\n    );\n  }\n\n  private computeLayerVisibilityFromUrl(\n    params: Params,\n    currentLayerid: string\n  ): boolean {\n    const queryParams = params;\n    let visible = true;\n    if (!queryParams || !currentLayerid) {\n      return visible;\n    }\n    let visibleOnLayersParams = '';\n    let visibleOffLayersParams = '';\n    let visiblelayers: string[] = [];\n    let invisiblelayers: string[] = [];\n    if (queryParams['visiblelayers']) {\n      visibleOnLayersParams = queryParams['visiblelayers'];\n    }\n    if (queryParams['invisiblelayers']) {\n      visibleOffLayersParams = queryParams['invisiblelayers'];\n    }\n\n    /* This order is important because to control whichever\n     the order of * param. First whe open and close everything.*/\n    if (visibleOnLayersParams === '*') {\n      visible = true;\n    }\n    if (visibleOffLayersParams === '*') {\n      visible = false;\n    }\n\n    // After, managing named layer by id (context.json OR id from datasource)\n    visiblelayers = visibleOnLayersParams.split(',');\n    invisiblelayers = visibleOffLayersParams.split(',');\n    if (visiblelayers.indexOf(currentLayerid) > -1 || visiblelayers.indexOf(currentLayerid.toString()) > -1) {\n      visible = true;\n    }\n    if (invisiblelayers.indexOf(currentLayerid) > -1 || invisiblelayers.indexOf(currentLayerid.toString()) > -1) {\n      visible = false;\n    }\n    return visible;\n  }\n}\n","import './portal.variables.scss';\r\n\r\nimport {\r\n  trigger,\r\n  state,\r\n  style,\r\n  transition,\r\n  animate,\r\n  AnimationTriggerMetadata\r\n} from '@angular/animations';\r\n\r\nexport function controlSlideX(): AnimationTriggerMetadata {\r\n  return trigger('controlStateX', [\r\n    state(\r\n      'left',\r\n      style({\r\n        left: '60px'\r\n      })\r\n    ),\r\n    state(\r\n      'right',\r\n      style({\r\n        left: '465px'\r\n      })\r\n    ),\r\n    transition('* => *', animate('200ms'))\r\n  ]);\r\n}\r\n\r\nexport function controlSlideY(): AnimationTriggerMetadata {\r\n  return trigger('controlStateY', [\r\n    state('close', style({})),\r\n    state(\r\n      'firstRowFromBottom',\r\n      style({\r\n        bottom: '2px',\r\n        'margin-left': '0px'\r\n      })\r\n    ),\r\n    state(\r\n      'firstRowFromBottom-expanded',\r\n      style({\r\n        bottom: '285px',\r\n        'margin-left': '-55px'\r\n      })\r\n    ),\r\n    state(\r\n      'firstRowFromBottom-expanded-maximized',\r\n      style({\r\n        bottom: '500px', // workspace full size\r\n        'margin-left': '-55px'\r\n      })\r\n    ),\r\n    transition('* => *', animate('200ms'))\r\n  ]);\r\n}\r\n\r\nexport function controlsAnimations(): AnimationTriggerMetadata[] {\r\n  return [\r\n    trigger('controlsOffsetY', [\r\n      state('close', style({})),\r\n      state(\r\n        'firstRowFromBottom',\r\n        style({\r\n          bottom: '5px'\r\n        })\r\n      ),\r\n      state(\r\n        'firstRowFromBottom-expanded',\r\n        style({\r\n          bottom: '5px'\r\n        })\r\n      ),\r\n      state(\r\n        'firstRowFromBottom-expanded-maximized',\r\n        style({\r\n          bottom: '500px'\r\n        })\r\n      ),\r\n      state(\r\n        'secondRowFromBottom',\r\n        style({\r\n          bottom: '47px'\r\n        })\r\n      ),\r\n      state(\r\n        'thirdRowFromBottom',\r\n        style({\r\n          bottom: '104px'\r\n        })\r\n      ),\r\n      state(\r\n        '',\r\n        style({\r\n          bottom: 'calc(285px)'\r\n        })\r\n      ),\r\n      state(\r\n        'secondRowFromBottom-expanded',\r\n        style({\r\n          bottom: 'calc(285px + 52px)'\r\n        })\r\n      ),\r\n      state(\r\n        'thirdRowFromBottom-expanded',\r\n        style({\r\n          bottom: 'calc(285px + 104px)'\r\n        })\r\n      ),\r\n      transition('* => *', animate('200ms'))\r\n    ])\r\n  ];\r\n}\r\n","import { Component } from '@angular/core';\nimport { ConfigService } from '@igo2/core';\n\n@Component({\n  selector: 'app-map',\n  templateUrl: './map.component.html',\n  styleUrls: ['./map.component.scss']\n})\nexport class MapComponent {\n  public hasHeader = true;\n\n  constructor(private configService: ConfigService) {\n\n    this.hasHeader = this.configService.getConfig('header.hasHeader') === undefined ? false :\n      this.configService.getConfig('header.hasHeader');\n   }\n\n}\n","<app-portal \n    [ngClass]=\" hasHeader? 'portal-hasHeader-hasMenu' : 'portal-hasMenu' \">\n</app-portal>\n","import { HomeComponent } from '../menu-pages/home/home.component';\nimport { AboutComponent } from '../menu-pages/about/about.component';\nimport { MapComponent } from '../menu-pages/map/map.component';\n\nimport { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nconst routes: Routes = [\n    { path: '', component: HomeComponent },\n    { path: 'carte', component: MapComponent },\n    { path: 'en-savoir-plus', component: AboutComponent }\n  ];\n\n\n@NgModule({\n    imports: [RouterModule.forRoot(routes, {\n      onSameUrlNavigation: 'reload',\n      relativeLinkResolution: 'legacy'\n  })],\n    exports: [RouterModule],\n  })\n  export class MenuRoutingModule { }\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { HeaderComponent } from './header.component';\nimport { IgoLanguageModule } from '@igo2/core';\nimport { MatToolbarModule } from '@angular/material/toolbar';\nimport { MenuRoutingModule } from '../menu/menu-routing/menu-routing.module';\n\n@NgModule({\n  declarations: [\n    HeaderComponent\n  ],\n  imports: [\n    CommonModule,\n    IgoLanguageModule,\n    MatToolbarModule,\n    MenuRoutingModule\n    ],\n  exports: [\n    HeaderComponent\n  ]\n})\nexport class HeaderModule { }\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FooterComponent } from './footer.component';\nimport { IgoLanguageModule } from '@igo2/core';\n\n@NgModule({\n  declarations: [\n    FooterComponent\n  ],\n  imports: [\n    CommonModule,\n    IgoLanguageModule\n  ],\n  exports: [\n    FooterComponent\n  ]\n})\nexport class FooterModule { }\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\n\nimport { MapOverlayComponent } from './map-overlay.component';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],\n  exports: [MapOverlayComponent],\n  declarations: [MapOverlayComponent]\n})\nexport class MapOverlayModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatSidenavModule } from '@angular/material/sidenav';\nimport { MatTooltipModule } from '@angular/material/tooltip';\n\nimport { IgoLanguageModule } from '@igo2/core';\nimport {\n  IgoPanelModule,\n  IgoFlexibleModule,\n  IgoToolModule,\n  IgoHomeButtonModule\n} from '@igo2/common';\nimport { IgoFeatureModule } from '@igo2/geo';\nimport { IgoContextManagerModule } from '@igo2/context';\n\nimport { SidenavComponent } from './sidenav.component';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    MatIconModule,\n    MatButtonModule,\n    MatSidenavModule,\n    MatTooltipModule,\n    IgoLanguageModule,\n    IgoPanelModule,\n    IgoFlexibleModule,\n    IgoContextManagerModule,\n    IgoToolModule,\n    IgoFeatureModule,\n    IgoHomeButtonModule\n  ],\n  exports: [SidenavComponent],\n  declarations: [SidenavComponent]\n})\nexport class AppSidenavModule {}\n","import { LegendButtonComponent, LegendButtonDialogComponent } from './legend-button.component';\nimport { NgModule } from '@angular/core';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatButtonModule } from '@angular/material/button';\nimport { IgoMapModule, IgoLayerModule } from '@igo2/geo';\nimport {MAT_DIALOG_DATA, MatDialogModule, MatDialogRef} from '@angular/material/dialog';\n\n@NgModule({\n  declarations: [LegendButtonComponent, LegendButtonDialogComponent],\n  imports: [\n    MatIconModule,\n    MatDialogModule,\n    IgoLayerModule,\n    IgoMapModule,\n    MatButtonModule\n  ],\n  providers:\n  [{\n    provide: 'app-legend-button-dialog',\n    useValue: LegendButtonDialogComponent,\n},\n      {provide:MatDialogRef , useValue:{} },\n\n      { provide: MAT_DIALOG_DATA, useValue: {} }\n\n],\n  exports: [\n    LegendButtonComponent,\n    LegendButtonDialogComponent,\n    MatIconModule\n  ],\n  bootstrap: [LegendButtonComponent],\n})\nexport class LegendButtonModule { }\n","import { NgModule, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatBadgeModule } from '@angular/material/badge';\nimport { MatTooltipModule } from '@angular/material/tooltip';\n\nimport { IgoLanguageModule } from '@igo2/core';\nimport { IgoFlexibleModule, IgoCustomHtmlModule, IgoPanelModule } from '@igo2/common';\nimport {\n  IgoFeatureModule,\n  IgoSearchModule,\n  IgoFeatureDetailsModule\n} from '@igo2/geo';\n\nimport { SearchResultsToolComponent } from './search-results-tool.component';\n\n/**\n * @ignore\n */\n@NgModule({\n  imports: [\n    CommonModule,\n    MatIconModule,\n    MatBadgeModule,\n    MatTooltipModule,\n    MatButtonModule,\n    IgoLanguageModule,\n    IgoFeatureModule,\n    IgoSearchModule,\n    IgoFlexibleModule,\n    IgoPanelModule,\n    IgoFeatureDetailsModule,\n    IgoCustomHtmlModule\n  ],\n  declarations: [SearchResultsToolComponent],\n  exports: [SearchResultsToolComponent],\n  schemas: [CUSTOM_ELEMENTS_SCHEMA]\n})\nexport class IgoAppSearchResultsToolModule {}\n","import { IgoAppSearchModule } from '@igo2/integration';\nimport { IgoAppSearchResultsToolModule } from './search-results-tool/search-results-tool.module';\nimport { MatCardModule } from '@angular/material/card';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatSidenavModule } from '@angular/material/sidenav';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport {MatExpansionModule} from '@angular/material/expansion'; // mobile\n\nimport { IgoLanguageModule, IgoMessageModule } from '@igo2/core';\nimport {\n  IgoPanelModule,\n  IgoFlexibleModule,\n  IgoToolModule,\n  IgoActionbarModule,\n  IgoContextMenuModule\n} from '@igo2/common';\nimport {\n  IgoFeatureModule,\n  IgoMapModule,\n  IgoSearchModule\n} from '@igo2/geo';\nimport { IgoContextManagerModule } from '@igo2/context';\nimport { SideResultComponent } from './sideresult.component';\nimport { BottomResultComponent } from './bottomresult.component';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    MatIconModule,\n    MatButtonModule,\n    MatSidenavModule,\n    MatTooltipModule,\n    IgoLanguageModule,\n    IgoPanelModule,\n    IgoFlexibleModule,\n    IgoContextManagerModule,\n    IgoToolModule,\n    IgoFeatureModule,\n    //SEARCH\n    MatCardModule,\n    IgoMessageModule,\n    IgoMapModule,\n    IgoSearchModule,\n    IgoActionbarModule,\n    IgoContextMenuModule,\n    IgoAppSearchModule,\n    IgoSearchModule.forRoot(),\n    IgoAppSearchResultsToolModule,\n    MatExpansionModule\n  ],\n  exports: [SideResultComponent, BottomResultComponent ],\n  //SEARCH\n  declarations: [SideResultComponent, BottomResultComponent]\n})\nexport class AppSideResultModule {}\n","\nimport { IgoAppSearchBarModule, IgoAppSearchModule, IgoAppSearchResultsToolModule, IgoAppToolModule } from '@igo2/integration';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatSidenavModule } from '@angular/material/sidenav';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { MatDialogModule } from '@angular/material/dialog';\n\nimport { IgoCoreModule } from '@igo2/core';\nimport {\n  IgoActionModule,\n  IgoWorkspaceModule,\n  IgoEntityModule,\n  IgoPanelModule,\n  IgoBackdropModule,\n  IgoFlexibleModule,\n  IgoContextMenuModule,\n  IgoToolModule,\n  IgoEntityTableModule,\n  IgoEntityTablePaginatorModule\n} from '@igo2/common';\n\nimport {\n  IgoGeoWorkspaceModule,\n  IgoFeatureModule,\n  IgoImportExportModule,\n  IgoMapModule,\n  IgoQueryModule,\n  IgoSearchModule,\n  IgoLayerModule,\n  provideIChercheReverseSearchSource,\n  provideNominatimSearchSource,\n  provideCoordinatesReverseSearchSource,\n  provideILayerSearchSource,\n  provideOsrmDirectionsSource,\n  provideOptionsApi,\n  IChercheSearchSource,\n  provideIChercheSearchSource,\n  provideDefaultIChercheSearchResultFormatter,\n  provideStyleListOptions,\n  provideDefaultCoordinatesSearchResultFormatter,\n  CoordinatesSearchResultFormatter,\n  provideSearchSourceService,\n  SearchService\n} from '@igo2/geo';\nimport {\n  IgoContextManagerModule,\n  IgoContextMapButtonModule\n} from '@igo2/context';\n\nimport { IgoIntegrationModule } from '@igo2/integration';\nimport { MapOverlayModule } from './map-overlay/map-overlay.module';\nimport { AppSidenavModule } from './sidenav/sidenav.module';\n\nimport { PortalComponent } from './portal.component';\n\nimport { LegendButtonModule } from './legend-button/legend-button.module';\nimport { FooterModule } from './../footer/footer.module';\nimport { AppSideResultModule } from './sideresult/sideresult.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    MatTooltipModule,\n    MatButtonModule,\n    MatIconModule,\n    IgoCoreModule,\n    IgoFeatureModule,\n    IgoMapModule,\n    IgoEntityModule,\n    IgoFlexibleModule,\n    IgoIntegrationModule,\n    IgoContextManagerModule,\n    IgoContextMapButtonModule,\n    FooterModule,\n    LegendButtonModule,\n    IgoLayerModule,\n    IgoWorkspaceModule,\n    IgoGeoWorkspaceModule,\n    IgoQueryModule.forRoot(),\n    IgoSearchModule.forRoot(),\n    IgoContextMapButtonModule,\n    MatSidenavModule,\n    MatDialogModule,\n    IgoActionModule,\n    IgoImportExportModule,\n    MapOverlayModule,\n    AppSidenavModule,\n    AppSideResultModule,\n    IgoPanelModule,\n    IgoBackdropModule,\n    IgoContextMenuModule,\n    IgoToolModule,\n    IgoEntityTableModule,\n    IgoEntityTablePaginatorModule,\n    //IgoSearchBarModule,\n    IgoAppSearchBarModule,\n    IgoAppSearchModule,\n    IgoAppSearchResultsToolModule,\n    IgoAppToolModule\n  ],\n  providers: [\n    provideCoordinatesReverseSearchSource(),\n    provideIChercheSearchSource(),\n    provideNominatimSearchSource(),\n    provideIChercheReverseSearchSource(),\n    provideNominatimSearchSource(),\n    provideIChercheReverseSearchSource(),\n    provideCoordinatesReverseSearchSource(),\n    provideILayerSearchSource(),\n    provideOsrmDirectionsSource(),\n    provideOptionsApi(),\n    CoordinatesSearchResultFormatter,\n    provideDefaultCoordinatesSearchResultFormatter(),\n    provideDefaultIChercheSearchResultFormatter(),\n    provideSearchSourceService(),\n    SearchService,\n    IChercheSearchSource,\n    provideStyleListOptions({\n      path: './assets/list-style.json'\n    })\n  ],\n  exports: [PortalComponent],\n  declarations: [PortalComponent]\n})\nexport class PortalModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MenuComponent } from './menu.component';\nimport { HomeComponent } from './menu-pages/home/home.component';\nimport { MenuRoutingModule } from './menu-routing/menu-routing.module';\nimport { AboutComponent } from './menu-pages/about/about.component';\nimport { MapComponent } from './menu-pages/map/map.component';\nimport { HeaderModule } from '../header/header.module';\nimport { FooterModule } from '../footer/footer.module';\nimport { PortalModule } from '../portal';\nimport { MatToolbarModule } from '@angular/material/toolbar';\n@NgModule({\n  declarations: [\n    MenuComponent,\n    HomeComponent,\n    AboutComponent,\n    MapComponent\n  ],\n  imports: [\n    CommonModule,\n    MenuRoutingModule,\n    PortalModule,\n    HeaderModule,\n    FooterModule,\n    MatToolbarModule\n  ],\n  exports:[\n    MenuComponent,\n    MenuRoutingModule\n  ]\n})\nexport class MenuModule { }\n","import { LanguageOptions } from '@igo2/core';\nimport {\n  Projection,\n  SearchSourceOptions,\n  CommonVectorStyleOptions\n} from '@igo2/geo';\n\ninterface Environment {\n  production: boolean;\n  igo: {\n    app: {\n      forceCoordsNA: boolean;\n      pwa?: {\n        enabled?: boolean;\n        promote?: boolean;\n      }\n    };\n    language?: LanguageOptions;\n    projections?: Projection[];\n    searchSources?: { [key: string]: SearchSourceOptions };\n    queryOverlayStyle?: {\n      base?: CommonVectorStyleOptions,\n      selection?: CommonVectorStyleOptions,\n      focus?: CommonVectorStyleOptions\n    };\n    searchOverlayStyle?: {\n      base?: CommonVectorStyleOptions,\n      selection?: CommonVectorStyleOptions,\n      focus?: CommonVectorStyleOptions\n    };\n  };\n}\n\nexport const environment: Environment = {\n  production: true,\n  igo: {\n    app: {\n      forceCoordsNA: false,\n      pwa: {\n        enabled: false,\n        promote: false\n      }\n    },\n    language: {\n      prefix: ['./locale/', './particular/locale/']\n    },\n    searchSources: {\n      nominatim: {\n        available: false\n      },\n      storedqueries: {\n        enabled: false,\n        available: false\n      },\n      icherche: {\n        searchUrl: 'https://geoegl.msp.gouv.qc.ca/apis/icherche',\n        order: 2,\n        params: {\n          limit: '5'\n        }\n      },\n      coordinatesreverse: {\n        showInPointerSummary: true\n      },\n      icherchereverse: {\n        showInPointerSummary: true,\n        searchUrl: 'https://geoegl.msp.gouv.qc.ca/apis/terrapi',\n        order: 3,\n        enabled: true\n      },\n      ilayer: {\n        searchUrl: 'https://geoegl.msp.gouv.qc.ca/apis/icherche/layers',\n        order: 4,\n        params: {\n          limit: '3'\n        }\n      }\n    },\n    projections: [\n      {\n        code: 'EPSG:32198',\n        alias: 'Quebec Lambert',\n        def:\n          '+proj=lcc +lat_1=60 +lat_2=46 +lat_0=44 +lon_0=-68.5 +x_0=0 +y_0=0 \\\n          +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs',\n        extent: [-799574, 45802, 891595.4, 1849567.5]\n      },\n      {\n        code: 'EPSG:3798',\n        alias: 'MTQ Lambert',\n        def:\n          '+proj=lcc +lat_1=50 +lat_2=46 +lat_0=44 +lon_0=-70 +x_0=800000 +y_0=0 \\\n          +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs',\n        extent: [31796.5834, 158846.2231, 1813323.4284, 2141241.0978]\n      }\n    ],\n    searchOverlayStyle: {\n      base: {\n        markerColor: '#5ed0fb', // marker fill\n        markerOpacity: 0.8, // marker opacity not applied if a rgba markerColor is provided\n        markerOutlineColor: '#a7e7ff', // marker contour\n        fillColor: '#5ed0fb', // poly\n        fillOpacity: 0.2, // poly fill opacity not applied if a rgba fillColor is provided\n        strokeColor: '#5ed0fb', // line and poly\n        strokeOpacity: 0.7, // line and poly not applied if a rgba strokeColor is provided\n        strokeWidth: 2 // line and poly\n      },\n      focus: {\n        markerColor: '#5ed0fb', // marker fill\n        markerOpacity: 1, // marker opacity not applied if a rgba markerColor is provided\n        markerOutlineColor: '#DFF7FF', // marker contour\n        fillColor: '#5ed0fb', // poly\n        fillOpacity: 0.3, // poly fill opacity not applied if a rgba fillColor is provided\n        strokeColor: '#DFF7FF', // line and poly\n        strokeOpacity: 1, // line and poly not applied if a rgba strokeColor is provided\n        strokeWidth: 2 // line and poly\n      },\n      selection: {\n        markerColor: '#00a1de', // marker fill\n        markerOpacity: 1, // marker opacity not applied if a rgba markerColor is provided\n        markerOutlineColor: '#ffffff', // marker contour\n        fillColor: '#00a1de', // poly\n        fillOpacity: 0.3, // poly fill opacity not applied if a rgba fillColor is provided\n        strokeColor: '#00A1DE', // line and poly\n        strokeOpacity: 1, // line and poly not applied if a rgba strokeColor is provided\n        strokeWidth: 2 // line and poly\n      }\n    },\n    queryOverlayStyle: {\n      base: {\n        markerColor: '#5ed0fb', // marker fill\n        markerOpacity: 0.8, // marker opacity not applied if a rgba markerColor is provided\n        markerOutlineColor: '#a7e7ff', // marker contour\n        fillColor: '#5ed0fb', // poly\n        fillOpacity: 0.2, // poly fill opacity not applied if a rgba fillColor is provided\n        strokeColor: '#5ed0fb', // line and poly\n        strokeOpacity: 0.7, // line and poly not applied if a rgba strokeColor is provided\n        strokeWidth: 2 // line and poly\n      },\n      focus: {\n        markerColor: '#5ed0fb', // marker fill\n        markerOpacity: 1, // marker opacity not applied if a rgba markerColor is provided\n        markerOutlineColor: '#DFF7FF', // marker contour\n        fillColor: '#5ed0fb', // poly\n        fillOpacity: 0.3, // poly fill opacity not applied if a rgba fillColor is provided\n        strokeColor: '#DFF7FF', // line and poly\n        strokeOpacity: 1, // line and poly not applied if a rgba strokeColor is provided\n        strokeWidth: 2 // line and poly\n      },\n      selection: {\n        markerColor: '#00a1de', // marker fill\n        markerOpacity: 1, // marker opacity not applied if a rgba markerColor is provided\n        markerOutlineColor: '#ffffff', // marker contour\n        fillColor: '#00a1de', // poly\n        fillOpacity: 0.3, // poly fill opacity not applied if a rgba fillColor is provided\n        strokeColor: '#00A1DE', // line and poly\n        strokeOpacity: 1, // line and poly not applied if a rgba strokeColor is provided\n        strokeWidth: 2 // line and poly\n      }\n    }\n  }\n};\n","import { Component } from '@angular/core';\nimport { ConfigService, LanguageService } from '@igo2/core';\n\n@Component({\n  selector: 'app-header',\n  templateUrl: './header.component.html',\n  styleUrls: ['./header.component.scss']\n})\nexport class HeaderComponent {\n\n  public headerLogo: string;\n  public headerLogoPrint: string;\n\n  constructor(\n    private configService: ConfigService,\n    protected languageService: LanguageService) {\n      this.computeHeader();\n    }\n\n  computeHeader() {\n    this.headerLogo = this.configService.getConfig('header.logo');\n    this.headerLogoPrint = this.configService.getConfig('header.logoPrint');\n  }\n\n  // Future translation system\n  /*changeLanguage() {\n    if (this.languageService.getLanguage() === 'fr'){\n      this.languageService.setLanguage('en');\n    } else {\n      this.languageService.setLanguage('fr');\n    }\n  }*/\n\n}\n","<mat-toolbar class = banner role = banner color=\"primary\">\n\t<div class=\"container\">\n\t\t<div class=\"row\">\n\t\t\t<div class=\"col-6 col-md-10 d-flex flex-wrap align-items-center zone-logo-title\">\n\t\t\t\t<a class=\"logo\" tabindex=\"5\" routerLink=\"\">\n                    <img id=\"header-logo\" alt=\"Logo\" src=\"{{headerLogo}}\">\n\t\t\t\t\t\n                </a>\n\t\t\t\t<img id=\"header-logo-print\" alt=\"Logo\" src=\"{{headerLogoPrint}}\" width=\"199\" height=\"60\" />\n\t\t\t\t<p lang=\"fr\" id=\"title-desktop\" class=\"zone-title  d-none d-md-block\">{{'header.title' | translate}}</p>\n\t\t\t</div>\n\t\t\t<div class=\"col-6 col-md-2 d-flex justify-content-end zone-links\">\n\t\t\t\t<ul class=\"nav flex-column\">\n\t\t\t\t\t<!--<li><button class=\"buttonLanguage\" disabled (click)=\"changeLanguage()\">{{'header.language'}}</button></li>-->\n\t\t\t\t\t<li><a rel=\"noopener noreferrer\" alt=\"('header.contactUsUrl' | translate)\" href=\"{{'header.contactUsUrl' | translate}}\" target=\"_blank\">{{'header.contactUs' | translate}}</a></li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t\t<p lang=\"fr\" id=\"title-mobile\" class=\"zone-title d-md-none col-12\"><a>{{'header.title' | translate}}</a></p>\n\t\t</div>\n\t</div>\n</mat-toolbar>","import { Component } from '@angular/core';\n\n@Component({\n  selector: 'app-menu',\n  templateUrl: './menu.component.html',\n  styleUrls: ['./menu.component.scss']\n})\nexport class MenuComponent {\n  public color = 'accent';\n\n  constructor() { }\n\n}\n","<mat-toolbar class=\"container headline\" color=\"accent\">\n  <div class=\"col-12 align-self-end\">\n    <nav class=\"navbar\">\n      <a class=\"nav-link nav-arrow left\" href=\"#menu-left\" routerLinkActive=\"active\">❮</a>\n      <div class=\"main-nav slick-track\">\n          <a class=\"nav-link\" routerLink=\"/\" routerLinkActive=\"active\" id=\"menu-left\" [routerLinkActiveOptions]=\"{exact:true}\">Accueil</a>\n          <a class=\"nav-link\" routerLink=\"/carte\" routerLinkActive=\"active\">Carte</a>\n          <a class=\"nav-link\" routerLink=\"/en-savoir-plus\" id=\"menu-right\" routerLinkActive=\"active\">En savoir plus</a>\n      </div>\n      <a class=\"nav-link nav-arrow right\" color=\"accent\" href=\"#menu-right\" routerLinkActive=\"active\">❯</a>\n    </nav>\n  </div>\n</mat-toolbar>\n<router-outlet></router-outlet>\n","<igo-spinner igoSpinnerActivity></igo-spinner>\n\n<app-header *ngIf=\"hasHeader\" #header></app-header>\n\n<app-menu *ngIf=\"hasMenu\"></app-menu>\n\n<app-portal *ngIf=\"!hasMenu\" [ngClass]=\"hasHeader? 'portal-hasHeader': 'portal'\"></app-portal>","import { Component, ElementRef, Renderer2, ViewChild } from '@angular/core';\nimport { Title, Meta } from '@angular/platform-browser';\nimport { zip } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { userAgent } from '@igo2/utils';\nimport {\n  LanguageService,\n  ConfigService,\n  MessageService\n} from '@igo2/core';\nimport { AuthOptions } from '@igo2/auth';\nimport { PwaService } from './services/pwa.service';\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.scss']\n})\nexport class AppComponent {\n  public authConfig: AuthOptions;\n  private themeClass = 'qcca-theme';\n  public hasHeader: boolean = true;\n  public hasFooter: boolean = true;\n  public hasMenu: boolean = false;\n\n  @ViewChild('searchBar', { read: ElementRef, static: true })\n  searchBar: ElementRef;\n\n  constructor(\n    protected languageService: LanguageService,\n    private configService: ConfigService,\n    private renderer: Renderer2,\n    private titleService: Title,\n    private metaService: Meta,\n    private messageService: MessageService,\n    private pwaService: PwaService\n  ) {\n    this.pwaService.checkForUpdates();\n    this.languageService.translate.getTranslation(this.languageService.getLanguage()).subscribe();\n\n    this.readTitleConfig();\n    this.readThemeConfig();\n    this.readDescriptionConfig();\n\n    this.detectOldBrowser();\n\n    this.hasHeader = this.configService.getConfig('header.hasHeader') === undefined ? false :\n      this.configService.getConfig('header.hasHeader');\n\n    this.hasFooter = this.configService.getConfig('hasFooter') === undefined ? false :\n      this.configService.getConfig('hasFooter');\n\n    this.hasMenu = this.configService.getConfig('hasMenu') === undefined ? false :\n      this.configService.getConfig('hasMenu');\n  }\n\n  private readTitleConfig() {\n    this.languageService.translate.get(this.configService.getConfig('title')).subscribe(title => {\n      if (title) {\n        this.titleService.setTitle(title);\n        this.metaService.addTag({ name: 'title', content: title });\n      }\n    });\n  }\n\n  private readThemeConfig() {\n    const theme = this.configService.getConfig('theme') || this.themeClass;\n    if (theme) {\n      this.renderer.addClass(document.body, theme);\n    }\n  }\n\n  private readDescriptionConfig() {\n    const description = this.configService.getConfig('description');\n    if (description) {\n      this.metaService.addTag({ name: 'description', content: description });\n    }\n  }\n\n  private detectOldBrowser() {\n    const oldBrowser = userAgent.satisfies({\n      ie: '<=11',\n      chrome: '<64',\n      firefox: '<60',\n      safari: '<=11'\n    });\n\n    if (oldBrowser) {\n      const translate = this.languageService.translate;\n      const title$ = translate.get('oldBrowser.title');\n      const message$ = translate.get('oldBrowser.message');\n      zip(title$, message$)\n        .pipe(\n          map(([title, message]) => ({\n            title,\n            message\n          }))\n        )\n        .subscribe((rep) =>\n          this.messageService.alert(rep.message, rep.title, {\n            timeOut: 15000\n          })\n        );\n    }\n  }\n}\n","import { BrowserModule, HammerModule } from '@angular/platform-browser';\nimport { APP_INITIALIZER, InjectionToken, NgModule } from '@angular/core';\nimport { RouterModule } from '@angular/router';\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\nimport { HeaderModule } from './pages/header/header.module';\nimport { FooterModule } from './pages/footer/footer.module';\nimport { MenuModule } from './pages/menu/menu.module';\nimport { MAT_TOOLTIP_DEFAULT_OPTIONS, MatTooltipDefaultOptions } from '@angular/material/tooltip';\n\nexport const defaultTooltipOptions: MatTooltipDefaultOptions = {\n  showDelay: 500,\n  hideDelay: 0,\n  touchendHideDelay: 0,\n  disableTooltipInteractivity: true\n};\n\nimport {\n  provideConfigOptions,\n  IgoMessageModule,\n  IgoGestureModule,\n  RouteService,\n  LanguageService,\n  ConfigService,\n  ConfigOptions,\n  CONFIG_OPTIONS\n} from '@igo2/core';\nimport { IgoSpinnerModule, IgoStopPropagationModule } from '@igo2/common';\nimport {\n  provideStyleListOptions\n} from '@igo2/geo';\n\nimport { PwaService } from './services/pwa.service';\n\nimport { environment } from '../environments/environment';\nimport { PortalModule } from './pages';\nimport { AppComponent } from './app.component';\nimport { ServiceWorkerModule } from '@angular/service-worker';\n\nexport let CONFIG_LOADER = new InjectionToken<Promise<ConfigService>>('Config Loader');\n\nfunction configLoader(\n  configService: ConfigService,\n  configOptions: ConfigOptions,\n): Promise<unknown> {\n  const promiseOrTrue = configService.load(configOptions);\n  if (promiseOrTrue instanceof Promise) {\n    return promiseOrTrue;\n  }\n  return Promise.resolve();\n}\n\n@NgModule({\n  declarations: [AppComponent],\n  imports: [\n    BrowserModule,\n    BrowserAnimationsModule,\n    RouterModule.forRoot([]),\n    IgoGestureModule.forRoot(),\n    IgoMessageModule,\n    IgoSpinnerModule,\n    IgoStopPropagationModule,\n    PortalModule,\n    HammerModule,\n    HeaderModule,\n    FooterModule,\n    MenuModule,\n    ServiceWorkerModule.register('ngsw-worker.js', {\n      enabled: environment.igo.app.pwa.enabled,\n      registrationStrategy: 'registerWithDelay:5000'\n    })\n  ],\n  providers: [\n    provideConfigOptions({\n      default: environment.igo,\n      path: './config/config.json'\n    }),\n    {\n      provide: CONFIG_LOADER,\n      useFactory: configLoader,\n      deps: [ConfigService, CONFIG_OPTIONS],\n    },\n    RouteService,\n    {\n      provide: APP_INITIALIZER,\n      useFactory: appInitializerFactory,\n      deps: [CONFIG_LOADER, LanguageService, PwaService],\n      multi: true\n    },\n    provideStyleListOptions({\n      path: './assets/list-style.json'\n    }),\n    { provide: MAT_TOOLTIP_DEFAULT_OPTIONS, useValue: defaultTooltipOptions }\n  ],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n\nfunction appInitializerFactory(\n  configLoader: Promise<unknown>,\n  languageService: LanguageService,\n  pwaService: PwaService\n) {\n  return () => new Promise<any>((resolve: any) => {\n    configLoader.then(() => {\n      const secondPromises = [languageService.translate.getTranslation(languageService.getLanguage())];\n      Promise.all(secondPromises).then(() => {\n        const thirdPromises = [pwaService.initPwaPrompt()];\n        Promise.all(thirdPromises).then(() => resolve());\n      });\n    });\n  });\n}\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nimport 'hammerjs';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic()\n  .bootstrapModule(AppModule)\n  .catch(err => console.log(err));\n","var map = {\n\t\"./af\": 58685,\n\t\"./af.js\": 58685,\n\t\"./ar\": 254,\n\t\"./ar-dz\": 4312,\n\t\"./ar-dz.js\": 4312,\n\t\"./ar-kw\": 32614,\n\t\"./ar-kw.js\": 32614,\n\t\"./ar-ly\": 18630,\n\t\"./ar-ly.js\": 18630,\n\t\"./ar-ma\": 28674,\n\t\"./ar-ma.js\": 28674,\n\t\"./ar-sa\": 49032,\n\t\"./ar-sa.js\": 49032,\n\t\"./ar-tn\": 24730,\n\t\"./ar-tn.js\": 24730,\n\t\"./ar.js\": 254,\n\t\"./az\": 53052,\n\t\"./az.js\": 53052,\n\t\"./be\": 60150,\n\t\"./be.js\": 60150,\n\t\"./bg\": 63069,\n\t\"./bg.js\": 63069,\n\t\"./bm\": 13466,\n\t\"./bm.js\": 13466,\n\t\"./bn\": 18516,\n\t\"./bn-bd\": 90557,\n\t\"./bn-bd.js\": 90557,\n\t\"./bn.js\": 18516,\n\t\"./bo\": 26273,\n\t\"./bo.js\": 26273,\n\t\"./br\": 9588,\n\t\"./br.js\": 9588,\n\t\"./bs\": 19815,\n\t\"./bs.js\": 19815,\n\t\"./ca\": 83331,\n\t\"./ca.js\": 83331,\n\t\"./cs\": 21320,\n\t\"./cs.js\": 21320,\n\t\"./cv\": 72219,\n\t\"./cv.js\": 72219,\n\t\"./cy\": 68266,\n\t\"./cy.js\": 68266,\n\t\"./da\": 66427,\n\t\"./da.js\": 66427,\n\t\"./de\": 67435,\n\t\"./de-at\": 52871,\n\t\"./de-at.js\": 52871,\n\t\"./de-ch\": 12994,\n\t\"./de-ch.js\": 12994,\n\t\"./de.js\": 67435,\n\t\"./dv\": 82357,\n\t\"./dv.js\": 82357,\n\t\"./el\": 95649,\n\t\"./el.js\": 95649,\n\t\"./en-au\": 59961,\n\t\"./en-au.js\": 59961,\n\t\"./en-ca\": 19878,\n\t\"./en-ca.js\": 19878,\n\t\"./en-gb\": 3924,\n\t\"./en-gb.js\": 3924,\n\t\"./en-ie\": 70864,\n\t\"./en-ie.js\": 70864,\n\t\"./en-il\": 91579,\n\t\"./en-il.js\": 91579,\n\t\"./en-in\": 30940,\n\t\"./en-in.js\": 30940,\n\t\"./en-nz\": 16181,\n\t\"./en-nz.js\": 16181,\n\t\"./en-sg\": 44301,\n\t\"./en-sg.js\": 44301,\n\t\"./eo\": 85291,\n\t\"./eo.js\": 85291,\n\t\"./es\": 54529,\n\t\"./es-do\": 53764,\n\t\"./es-do.js\": 53764,\n\t\"./es-mx\": 12584,\n\t\"./es-mx.js\": 12584,\n\t\"./es-us\": 63425,\n\t\"./es-us.js\": 63425,\n\t\"./es.js\": 54529,\n\t\"./et\": 35203,\n\t\"./et.js\": 35203,\n\t\"./eu\": 70678,\n\t\"./eu.js\": 70678,\n\t\"./fa\": 83483,\n\t\"./fa.js\": 83483,\n\t\"./fi\": 96262,\n\t\"./fi.js\": 96262,\n\t\"./fil\": 52521,\n\t\"./fil.js\": 52521,\n\t\"./fo\": 34555,\n\t\"./fo.js\": 34555,\n\t\"./fr\": 63131,\n\t\"./fr-ca\": 88239,\n\t\"./fr-ca.js\": 88239,\n\t\"./fr-ch\": 21702,\n\t\"./fr-ch.js\": 21702,\n\t\"./fr.js\": 63131,\n\t\"./fy\": 267,\n\t\"./fy.js\": 267,\n\t\"./ga\": 23821,\n\t\"./ga.js\": 23821,\n\t\"./gd\": 71753,\n\t\"./gd.js\": 71753,\n\t\"./gl\": 4074,\n\t\"./gl.js\": 4074,\n\t\"./gom-deva\": 92762,\n\t\"./gom-deva.js\": 92762,\n\t\"./gom-latn\": 5969,\n\t\"./gom-latn.js\": 5969,\n\t\"./gu\": 82809,\n\t\"./gu.js\": 82809,\n\t\"./he\": 45402,\n\t\"./he.js\": 45402,\n\t\"./hi\": 315,\n\t\"./hi.js\": 315,\n\t\"./hr\": 10410,\n\t\"./hr.js\": 10410,\n\t\"./hu\": 38288,\n\t\"./hu.js\": 38288,\n\t\"./hy-am\": 67928,\n\t\"./hy-am.js\": 67928,\n\t\"./id\": 71334,\n\t\"./id.js\": 71334,\n\t\"./is\": 86959,\n\t\"./is.js\": 86959,\n\t\"./it\": 34864,\n\t\"./it-ch\": 51124,\n\t\"./it-ch.js\": 51124,\n\t\"./it.js\": 34864,\n\t\"./ja\": 36141,\n\t\"./ja.js\": 36141,\n\t\"./jv\": 29187,\n\t\"./jv.js\": 29187,\n\t\"./ka\": 42136,\n\t\"./ka.js\": 42136,\n\t\"./kk\": 94332,\n\t\"./kk.js\": 94332,\n\t\"./km\": 18607,\n\t\"./km.js\": 18607,\n\t\"./kn\": 84305,\n\t\"./kn.js\": 84305,\n\t\"./ko\": 70234,\n\t\"./ko.js\": 70234,\n\t\"./ku\": 16003,\n\t\"./ku.js\": 16003,\n\t\"./ky\": 75061,\n\t\"./ky.js\": 75061,\n\t\"./lb\": 32786,\n\t\"./lb.js\": 32786,\n\t\"./lo\": 66183,\n\t\"./lo.js\": 66183,\n\t\"./lt\": 50029,\n\t\"./lt.js\": 50029,\n\t\"./lv\": 24169,\n\t\"./lv.js\": 24169,\n\t\"./me\": 68577,\n\t\"./me.js\": 68577,\n\t\"./mi\": 68177,\n\t\"./mi.js\": 68177,\n\t\"./mk\": 50337,\n\t\"./mk.js\": 50337,\n\t\"./ml\": 65260,\n\t\"./ml.js\": 65260,\n\t\"./mn\": 52325,\n\t\"./mn.js\": 52325,\n\t\"./mr\": 14695,\n\t\"./mr.js\": 14695,\n\t\"./ms\": 75334,\n\t\"./ms-my\": 37151,\n\t\"./ms-my.js\": 37151,\n\t\"./ms.js\": 75334,\n\t\"./mt\": 63570,\n\t\"./mt.js\": 63570,\n\t\"./my\": 97963,\n\t\"./my.js\": 97963,\n\t\"./nb\": 88028,\n\t\"./nb.js\": 88028,\n\t\"./ne\": 86638,\n\t\"./ne.js\": 86638,\n\t\"./nl\": 50302,\n\t\"./nl-be\": 66782,\n\t\"./nl-be.js\": 66782,\n\t\"./nl.js\": 50302,\n\t\"./nn\": 33501,\n\t\"./nn.js\": 33501,\n\t\"./oc-lnc\": 50563,\n\t\"./oc-lnc.js\": 50563,\n\t\"./pa-in\": 50869,\n\t\"./pa-in.js\": 50869,\n\t\"./pl\": 65302,\n\t\"./pl.js\": 65302,\n\t\"./pt\": 49687,\n\t\"./pt-br\": 74884,\n\t\"./pt-br.js\": 74884,\n\t\"./pt.js\": 49687,\n\t\"./ro\": 79107,\n\t\"./ro.js\": 79107,\n\t\"./ru\": 33627,\n\t\"./ru.js\": 33627,\n\t\"./sd\": 30355,\n\t\"./sd.js\": 30355,\n\t\"./se\": 83427,\n\t\"./se.js\": 83427,\n\t\"./si\": 11848,\n\t\"./si.js\": 11848,\n\t\"./sk\": 54590,\n\t\"./sk.js\": 54590,\n\t\"./sl\": 20184,\n\t\"./sl.js\": 20184,\n\t\"./sq\": 56361,\n\t\"./sq.js\": 56361,\n\t\"./sr\": 78965,\n\t\"./sr-cyrl\": 81287,\n\t\"./sr-cyrl.js\": 81287,\n\t\"./sr.js\": 78965,\n\t\"./ss\": 25456,\n\t\"./ss.js\": 25456,\n\t\"./sv\": 70451,\n\t\"./sv.js\": 70451,\n\t\"./sw\": 77558,\n\t\"./sw.js\": 77558,\n\t\"./ta\": 51356,\n\t\"./ta.js\": 51356,\n\t\"./te\": 73693,\n\t\"./te.js\": 73693,\n\t\"./tet\": 21243,\n\t\"./tet.js\": 21243,\n\t\"./tg\": 42500,\n\t\"./tg.js\": 42500,\n\t\"./th\": 55768,\n\t\"./th.js\": 55768,\n\t\"./tk\": 77761,\n\t\"./tk.js\": 77761,\n\t\"./tl-ph\": 35780,\n\t\"./tl-ph.js\": 35780,\n\t\"./tlh\": 29590,\n\t\"./tlh.js\": 29590,\n\t\"./tr\": 33807,\n\t\"./tr.js\": 33807,\n\t\"./tzl\": 93857,\n\t\"./tzl.js\": 93857,\n\t\"./tzm\": 60654,\n\t\"./tzm-latn\": 8806,\n\t\"./tzm-latn.js\": 8806,\n\t\"./tzm.js\": 60654,\n\t\"./ug-cn\": 30845,\n\t\"./ug-cn.js\": 30845,\n\t\"./uk\": 19232,\n\t\"./uk.js\": 19232,\n\t\"./ur\": 47052,\n\t\"./ur.js\": 47052,\n\t\"./uz\": 77967,\n\t\"./uz-latn\": 32233,\n\t\"./uz-latn.js\": 32233,\n\t\"./uz.js\": 77967,\n\t\"./vi\": 98615,\n\t\"./vi.js\": 98615,\n\t\"./x-pseudo\": 12320,\n\t\"./x-pseudo.js\": 12320,\n\t\"./yo\": 31313,\n\t\"./yo.js\": 31313,\n\t\"./zh-cn\": 64490,\n\t\"./zh-cn.js\": 64490,\n\t\"./zh-hk\": 55910,\n\t\"./zh-hk.js\": 55910,\n\t\"./zh-mo\": 98262,\n\t\"./zh-mo.js\": 98262,\n\t\"./zh-tw\": 44223,\n\t\"./zh-tw.js\": 44223\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 46700;"],"x_google_ignoreList":[42]}
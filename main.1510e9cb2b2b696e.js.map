{"version":3,"file":"main.1510e9cb2b2b696e.js","mappings":"4LAMO,MAAMA,GAGXC,cAAgB,yCAHLD,GAAa,2BAAbA,GAAaE,0QCN1BC,iBAAkB,UAAlBA,CAAkB,UAEqBA,mBAAOA,QACtCA,cAAIA,yFAA0EA,QAC9EA,cAAIA,6BAAiBA,QACrBA,aAAGA,2sBAA2oBA,QAC9oBA,gBAA2BA,mDAAgCA,gBAA6GA,sDAAmLA,kCCA5V,MAAMC,GAEXH,cAAgB,yCAFLG,GAAc,2BAAdA,GAAcF,oMCN3BC,iBAAiB,UAAjBA,CAAiB,UAEsBA,0BAAcA,QAC7CA,cAAIA,yBAAaA,QAEjBA,cAAIA,qBAASA,QACbA,aAAGA,uSAA2RA,cAAGA,2CAA8BA,QAAKA,uFAAyEA,cAAGA,wBAAWA,QAAKA,cAAGA,sCAAyBA,QAAKA,sEAAwDA,cAAGA,wCAA2BA,UAEvhBA,cAAGA,iFAAoEA,gBAA+CA,qCAAwBA,QAAKA,iDAAmCA,iBAAMA,2DAA8CA,QAAQA,uCAAyBA,cAAGA,6BAAgBA,QAAKA,iBAAMA,mCAAsBA,QAAQA,iBAAMA,sDAAyCA,UAEtXA,eAAI,SACIA,mGAAsFA,QAC1FA,eAAIA,wGAA2FA,QAC/FA,eAAIA,oCAAuBA,QAC3BA,eAAIA,iFAAoEA,QACxEA,eAAIA,gGAAmFA,UAI3FA,cAAG,QAAIA,sDAAwCA,QAAKA,+EAAiEA,cAAGA,oDAAuCA,QAAKA,4HAA8GA,iBAAMA,gEAAmDA,UAE3UA,gBAAMA,uaAQNA,QAGAA,eAAI,SACIA,uHAA0GA,QAC9GA,eAAIA,wFAA2EA,UAInFA,eAAI,QAAJA,CAAI,UACSA,0BAAaA,UACtBA,eAAIA,8EAAiEA,QACrEA,eAAI,UAAKA,0BAAaA,UACtBA,eAAIA,uCAA0BA,QAC9BA,eAAI,UAAKA,+BAAkBA,UAC3BA,eAAIA,gFAAmEA,QACvEA,eAAI,UAAKA,gCAAmBA,UAC5BA,eAAIA,2EAA8DA,sNCjCvE,MAAME,EAkCXJ,YACUK,EACAC,EACAC,GAFAC,2BACAA,sBACAA,qBApCHA,wBAA+C,GAC/CA,iCAAwD,GACxDA,6BAAoD,GAKlDA,yBAA+C,IAAIC,IAAgB,KAEnED,iBAAuC,IAAIC,SAAgB,GAE3DD,iBAAuC,IAAIC,SAAgB,GAE3DD,qBAA4C,IAAIC,KAAgB,GAEhED,mCAA0D,IAAIC,KAAgB,GAE9ED,qBAAiD,IAAIC,SAAgB,GAKrED,WAAmC,IAAIE,KAA0B,IAetEF,KAAKG,mBAAqB,CACxBC,YAAa,UACbC,cAAe,GACfC,mBAAoB,UACpBC,UAAW,cACXC,YAAa,EACbC,YAAa,UACbC,cAAe,GACfC,YAAa,GAEfX,KAAKY,4BAA8B,CACjCR,YAAa,UACbC,cAAe,EACfC,mBAAoB,UACpBC,UAAW,cACXC,YAAa,EACbC,YAAa,UACbC,cAAe,EACfC,YAAa,GAEfX,KAAKa,wBAA0B,CAC7BT,YAAa,UACbC,cAAe,EACfC,mBAAoB,UACpBC,UAAW,cACXC,YAAa,EACbC,YAAa,UACbC,cAAe,EACfC,YAAa,GAGjB,MAAMG,EAA+Bd,KAAKF,eAAeiB,IAAI,gCACzDD,GACFd,KAAKgB,8BAA8BC,KAAKH,GAE1Cd,KAAKkB,MAAMC,YAAYnB,KAAKoB,kCAAkC,EAChE,CA9CIC,kBACF,OAAOrB,KAAKH,oBACTyB,oBACAC,IAAKC,GAA0BA,EAAOhC,YAAoBiC,KAC/D,CA4CQL,iCAIN,OAAO,IAAIlB,KAAoC,CAACwB,iBAHtBC,GACY,MAA7BA,EAAOC,OAAOC,KAAKC,OAG9B,CAMAC,mCACE,MAAMC,EAAWhC,KAAKkB,MAAMe,kBAAkB/B,WAC7B,IAAb8B,GACFA,EAASE,UAEb,CAMAC,qCACE,MAAMH,EAAWhC,KAAKkB,MAAMe,kBAAkB/B,WAC7B,IAAb8B,GACFA,EAASI,YAEb,CAEAC,eACErC,KAAKsC,gBAAgBrB,MAAK,EAC5B,CAEAsB,gBACEvC,KAAKsC,gBAAgBrB,MAAK,EAC5B,CAEAuB,cAAcC,GACZzC,KAAK0C,YAAYzB,KAAKwB,EACxB,CAEAE,cAAcC,GACZ5C,KAAKH,oBAAoBgD,oBAAoBD,GAC7C5C,KAAK8C,YAAY7B,KAAK2B,EACxB,CAEAG,kBAAkBC,GAChBhD,KAAKiD,gBAAgBhC,KAAK+B,EAC5B,CAEAE,+BAA+BC,GAC7BnD,KAAKF,eAAesD,IAAI,+BAAgCD,GACxDnD,KAAKgB,8BAA8BC,KAAKkC,EAC1C,wCAjIWvD,GAAWF,iEAAXE,EAAWyD,QAAXzD,EAAW,qBAFV,qVCDP,MAAM0D,EAEX9D,YACU+D,EACAC,EACAC,GAFAzD,eACAA,uBACAA,4BAJFA,oBAAyB,EAM3BuD,EAAQG,WACV1D,KAAK2D,sBAET,CAEAC,kBACM5D,KAAKuD,QAAQG,cACfG,MAAS,MAAeC,QAAKC,MAAK,IAAIC,UAAU,IAAWC,kCACzD,IACE,MAAMC,QAAoBlE,KAAKuD,QAAQY,iBACvCC,QAAQC,IAAIH,EAAc,8BAAgC,wCACnDI,GACPF,QAAQG,MAAM,+BAAgCD,GAElD,GAEJ,CAEQE,iBACN,GAAIxE,KAAKyE,cACP,OAEF,MAEMC,EAAU,GAFF1E,KAAKwD,gBAAgBmB,UAAUC,QAAQ,4BACxC5E,KAAKwD,gBAAgBmB,UAAUC,QAAQ,qBAEpD5E,KAAKyD,qBAAqBoB,KAAKH,GAASZ,QAAKgB,MAAI,IAAM9E,KAAKyE,eAAgB,IAAOT,UAAWe,IACxFA,IACF/E,KAAKyE,eAAgB,EACjBO,OAAOC,UAAUC,OACnBC,SAASC,SAASC,UAElBC,MAAM,wIACNC,WAAW,KACTvF,KAAKwE,gBAAc,EAClB,MAAM,EAIjB,CAEQb,uBACN3D,KAAKuD,QAAQiC,eAAexB,UAAUyB,IACpC,OAAQA,EAAIhE,UACL,mBACH2C,QAAQC,IAAI,gCAAgCoB,EAAIC,QAAQC,QACxD,UACG,gBACHvB,QAAQC,IAAI,wBAAwBoB,EAAIG,eAAeD,QACvDvB,QAAQC,IAAI,kCAAkCoB,EAAII,cAAcF,QAChE3F,KAAKwE,iBACL,UACG,8BACHJ,QAAQG,MAAM,kCAAkCkB,EAAIC,QAAQC,UAAUF,EAAIlB,SAC1E,EAGR,wCA/DWjB,GAAU5D,iEAAV4D,EAAUD,QAAVC,EAAU,qBAFT,+FCAP,MAAMwC,GAEXtG,YAAsBgE,yBAAmC,yCAF9CsC,IAAepG,uCAAfoG,GAAerG,uQCR5BC,iBACIA,iBACAA,kBAAqB,WAArBA,CAAqB,8BAGGA,8BAAmCA,UAEvDA,kBAA4BA,eAAGA,QAC/BA,mBAA0B,gCAENA,gCAAiCA,UAErDA,mBAA4BA,gBAAGA,QAC/BA,mBAA0B,gCAENA,gCAA4BA,qBAXqBA,gEACjDA,+CAIiDA,gEACjDA,+CAIiDA,2DACjDA,+mCCJpBA,SACEA,iBAGFA,yCAHOA,qCAAsB,YAAtBA,CAAsB,4DAJjCA,eAEIA,SACAA,iCAKJA,wCAPoBA,2BAChBA,+BACeA,2DAUnBA,SACEA,iBACFA,yCADOA,qCAAsB,YAAtBA,CAAsB,4DAF7BA,SACAA,iEADAA,sBACeA,2DArBnBA,SACEA,iBAOEA,sBAWFA,2CAOAA,QACFA,6CAzBOA,sDAAuD,2BAAvDA,CAAuD,6BAAvDA,CAAuD,yBAAvDA,CAAuD,+BAAvDA,CAAuD,wBAD7BA,4BAOzBA,8BAAoB,eCIrB,MAAMqG,GAMXvG,YACUwG,EACAC,EACAlG,GAFAC,sBACAA,oBACAA,qBARHA,gBAA2B,EAS9B,CAEJkG,kBACElG,KAAKmG,UAAYnG,KAAKgG,eAAeI,SAASpC,UAAUqC,IACpDrG,KAAKsG,oBAAoBD,GACzBrG,KAAKqG,QAAUA,IAGnBrG,KAAKuG,QAAUvG,KAAKiG,aAAaO,OAAOxC,UAAUyC,GAChDzG,KAAKsG,oBAAoBtG,KAAKqG,SAElC,CAEAK,cACE1G,KAAKmG,UAAUQ,cACf3G,KAAKuG,QAAQI,aACf,CAEQL,oBAAoBD,GAC1B,IAAIO,EAAa,GACjB,QAAgB,IAAZP,EAAuB,CACzBrG,KAAK4G,WAAa,GAEdP,EAAQO,WACVA,EAAaP,EAAQO,WACZ5G,KAAKD,cAAc8G,UAAU,gBACtCD,EAAa5G,KAAKD,cAAc8G,UAAU,eAE5C,UAAWC,KAAWF,IAGdE,EAAQL,OAA0C,YAAjCzG,KAAKiG,aAAac,YACxCD,EAAQL,OAASK,EAAQL,MAAMO,SAAShH,KAAKiG,aAAac,cACzD/G,KAAK4G,WAAWK,KAAKH,GAK7B,yCAhDWf,IAAmBrG,+DAAnBqG,GAAmBtG,uRDZhCC,uCAAkCA,u3BE0B1BA,0EAEEA,mBAAW,kCAFbA,mFA1BRA,6CAWEA,iBAAyB,0BAQrBA,gEAAeA,yBAAqB,EAApCA,CAAqC,2DACrBA,0BAAsB,EADtCA,CAAqC,4DAEpBA,2BAAuB,EAFxCA,CAAqC,+DAGjBA,yBAAqB,EAHzCA,CAAqC,+DAIjBA,2BAAuB,EAJ3CA,CAAqC,0DAKtBA,oBAAgB,GAC/BA,2CAOFA,oCAvBFA,+DAIIA,gCAAe,wBAAfA,CAAe,cAAfA,CAAe,8BAAfA,CAAe,0CCiDRwH,EAA0B,MA2GrC1H,YACU2H,EACAC,EACAC,EACDC,EACCC,EACRxH,EACQyH,GANAxH,gBACAA,mBACAA,aACDA,iBACCA,sBAEAA,kBA9GDA,gBAAqB,EAKtBA,4BAAoC,GACpCA,oCAA4C,GAC5CA,oBAAgD,IAAIC,SAC1D,GAEKD,gCAA6B,IAAIC,KAAgB,GAKjDD,qBAA4C,IAAIC,KAAgB,GAE7DD,qBAAkB,IAAIN,MAqCzBM,UAAO,GAEPA,qBAAkB,IAAIC,SAAyB,GAM9CD,YAAS,IAAIyH,KAMdzH,sBAAuB,EAEpBA,iBAAc,IAAIN,MA0C1BM,KAAK0H,8BAAgC3H,EAAc8G,UACjD,iCAEF7G,KAAK2H,kBAAoB5H,EAAc8G,UACrC,oBAEJ,CA9FI3F,YACF,OAAOlB,KAAKoH,YAAYlG,KAC1B,CAMIK,UACF,OAAOvB,KAAKmH,SAAS5F,GACvB,CAEIqG,mBACF,OAAO5H,KAAK6H,WAAU3H,MAAeF,KAAK6H,cAAW,CACvD,CAEIC,eACF,OAAO9H,KAAKkB,MAAM6G,UACfC,SAAUC,GAAMA,EAAEC,MAAMC,SACxBrE,QACCvC,MACG6G,GACApI,KAAK6H,QAAUO,EACXA,EAAQxG,OAAOyG,UAChB,GAGZ,CAOIC,mBACF,OAAOtI,KAAKoH,YAAYmB,oBAAoBpF,KAC9C,CAIIqF,kBACF,OAAOxI,KAAKoH,YAAYlG,KAC1B,CAOIuH,oBACF,OAAOzI,KAAK0I,cACd,CACID,kBAActF,GAChBnD,KAAK0I,eAAiBvF,CACxB,CAIIwF,iBACF,OAAO3I,KAAK4I,WACd,CACID,eAAWxF,GACbnD,KAAK4I,YAAczF,CACrB,CAII0F,wBACF,OAAO7I,KAAK8I,kBACd,CACID,sBAAkB1F,GACpBnD,KAAK8I,mBAAqB3F,CAC5B,CAGI4F,iBACF,OAAO/I,KAAKwH,WAAWtG,KACzB,CAmBA8H,WACEhJ,KAAKiJ,aAAc,EACnBjJ,KAAKkJ,aAAelJ,KAAKoH,YAAY1E,YAAYsB,UAC9CvB,IACgD,MAAfA,IAC9BzC,KAAKmJ,KAAO1G,KAKdzC,KAAK0H,gCACF1H,KAAKoH,YAAYgC,wBACpBpJ,KAAKoH,YAAYgC,yBAAwBC,KAAc,CACrDrJ,KAAKsJ,eACLtJ,KAAKuB,IAAIgI,eAAeC,cACvBxF,UAAWyF,GACZzJ,KAAK0J,oBAAoBD,EAAM,GAAI,aAIlCzJ,KAAKoH,YAAYuC,yBACpB3J,KAAKoH,YAAYuC,0BAAyBN,KAAc,CACtDrJ,KAAKoH,YAAYnE,gBACjBjD,KAAKuB,IAAIgI,eAAeC,cACvBxF,UAAWyF,GACZzJ,KAAK0J,oBAAoBD,EAAM,GAAI,eAIzCzJ,KAAK4J,yBAEL5J,KAAK6J,2BAA0BR,KAAc,CAC3CrJ,KAAKoH,YAAYpG,8BACjBhB,KAAKkB,MAAM6G,UAAU+B,OACrB9J,KAAKsJ,eACLtJ,KAAKoH,YAAYnE,gBACjBjD,KAAKoH,YAAY1E,YACjB1C,KAAKuB,IAAIgI,eAAeC,cACvBxF,UAAWyF,IAEZ,MAAM3I,EAA+B2I,EAAM,GACrCM,EAAgBN,EAAM,GAExBzJ,KAAK0H,+BACP1H,KAAKgK,qBAAqB,SAE5BhK,KAAKiK,uBAAuB1I,IAAIyB,GAAUhD,KAAKuB,IAAI2I,oBAAoBC,cAAcnH,IACzD+G,EACzBK,OAAOpH,GACNA,EAAOpB,OAAOC,KAAKwI,WAAaC,OAChCtH,EAAOpB,OAAOyG,KAAKkC,WAClBvH,EAAOkF,MAAMsC,WACbxH,EAAOkF,MAAMC,SAEE5G,IAAIyB,UAClBlC,IACFkC,EAAOpB,OAAOyG,KAAKxG,KAAK4I,SACtBH,OACEI,OAAOC,OACL,GACA,CAAE9C,QAAS7E,EAAOpB,OAAOyG,MACzBrI,KAAKoH,YAAYjH,mBACE,QAAnByK,IAAOhJ,OAAO6I,aAAK,SAAEI,KAAO7H,EAAOpB,OAAO6I,MAAMI,KAAO,KAE7D7K,KAAKiK,uBAAuBhD,KAAKjE,EAAOpB,OAAOyG,MAC/CrI,KAAKuB,IAAI2I,oBAAoBY,WAAW9H,EAAOpB,OAAOyG,KAAiBiC,YACnEtK,KAAK0H,+BACP1H,KAAK0J,oBAAoB1G,EAAOpB,OAAiC,SAAO,EAG7E,GAGH5B,KAAK+K,iBAAmB/K,KAAKkB,MAAM6G,UAAUiD,OAAOlH,QAAKmH,KAAa,OAAOjH,UAAUkH,GAASlL,KAAKmL,gBAAgBlK,KAAKiK,GAC5H,CAEQtB,yBACN5J,KAAKoL,+BAA8B/B,KAAc,CAC/CrJ,KAAKuB,IAAIgI,eAAe8B,OACxBrL,KAAKoH,YAAYnE,kBAEhBa,QAAKmH,KAAa,MAClBjH,UAAWyF,IACV,MAAM6B,EAAiB7B,EAAM,GAC7B,GAAK6B,GAIL,GAAIA,EAAejD,KAAKkC,SAAU,CAChC,MAAMgB,KAAoBjB,OACxBgB,EAAejD,KACfrI,KAAKuB,IAAIiK,YAELC,KAA0BnB,OAAwBtK,KAAKuB,IAAK,CAChEgK,IAEFvL,KAAK0L,2BAA2BzK,QAC9BqJ,OAAqBtK,KAAKuB,IAAKkK,UAZjCzL,KAAK0L,2BAA2BzK,MAAK,IAgB7C,CAEQyI,oBACN1G,EACA2I,aAKA,GAHgB,UAAZA,GACF3L,KAAKgK,qBAAqB2B,IAEvB3I,IAAWA,EAAOqF,KAAKkC,SAC1B,OAGF,MAAMqB,KADctB,OAAYtH,EAAOqF,KAAMrI,KAAKuB,IAAIiK,YACvBK,cAC/B,MAAIvB,OAAyBtK,KAAKuB,IAAKqK,EAAWE,YAAiD,OAAS,CAC1G,MAAMC,EAASH,EAAWE,YACpBE,EAAID,EAAO,IAAMA,EAAO,GAAKA,EAAO,IAAM,EAC1CE,EAAIF,EAAO,IAAMA,EAAO,GAAKA,EAAO,IAAM,EAC1CG,EAAW,IAAIC,KAAU,CAC7BC,KAAM,GAAGT,mBACTpB,SAAU,IAAI8B,KAAQ,CAACL,EAAGC,MAEtBK,KAAiBhC,OAAc4B,EAAUlM,KAAKuB,IAAIiK,YAExD,IAAIe,EACAC,EAAe,EAEnB,OAAQb,OACD,UACHY,KAAgBjC,OACdI,OAAOC,OAAO,GACZ,CAAE9C,QAASyE,GACXtM,KAAKoH,YAAYvG,wBACL,QAAZ+J,IAAOH,aAAK,SAAEgC,MAAQzJ,EAAOyH,MAAMgC,MAAQ,KAC/CD,EAAe,EACf,UACG,QACHD,KAAgBjC,OAAqBI,OAAOC,OAAO,GACjD,CAAE9C,QAASyE,GACXtM,KAAKoH,YAAYjH,mBACL,QAAZuM,IAAOjC,aAAK,SAAEI,KAAO7H,EAAOyH,MAAMI,KAAO,KAC3C,UACG,WACH0B,KAAgBjC,OACdI,OAAOC,OAAO,GACZ,CAAE9C,QAASyE,GACXtM,KAAKoH,YAAYxG,4BACL,QAAZ+L,IAAOlC,aAAK,SAAEmC,UAAY5J,EAAOyH,MAAMmC,UAAY,KACvDJ,EAAe,EAGnBF,EAAezK,KAAK4I,MAAQ8B,EAC5BD,EAAezK,KAAK4I,MAAMoC,UAAU,IAAOL,GAC3CxM,KAAKuB,IAAIuL,qBAAqBhC,WAAWwB,EAAgBhC,YACzC,YAAZqB,IACF3L,KAAK+M,sBAAwBT,GAEf,aAAZX,IACF3L,KAAKgN,uBAAyBV,GAEhB,UAAZX,GACF3L,KAAKiN,+BAA+BhG,KAAKqF,QAG3CtM,KAAKgK,qBAAqB2B,EAE9B,CAEQ3B,qBAAqB2B,GACX,YAAZA,GAAyB3L,KAAK+M,wBAChC/M,KAAKuB,IAAIuL,qBAAqB3C,cAAcnK,KAAK+M,uBACjD/M,KAAK+M,2BAAwB,GAEf,aAAZpB,GAA0B3L,KAAKgN,yBACjChN,KAAKuB,IAAIuL,qBAAqB3C,cAAcnK,KAAKgN,wBACjDhN,KAAKgN,4BAAyB,GAEhB,UAAZrB,IACF3L,KAAKiN,+BAA+B1L,IAAI2L,GAAelN,KAAKuB,IAAIuL,qBAAqB3C,cAAc+C,IACnGlN,KAAKiN,+BAAiC,GAE1C,CAGAvG,cACE1G,KAAKkJ,aAAavC,cACd3G,KAAKoL,6BACPpL,KAAKoL,4BAA4BzE,cAE/B3G,KAAK6J,yBACP7J,KAAK6J,wBAAwBlD,cAE3B3G,KAAKmN,YACPnN,KAAKmN,WAAWxG,cAEd3G,KAAK+K,kBACP/K,KAAK+K,iBAAiBpE,aAE1B,CAOAyG,cAAcpK,SAEZ,GADAhD,KAAKsJ,eAAerI,KAAK+B,GACrBA,EAAOnB,KAAKwI,WAAaC,OAAWtH,EAAOqF,KAAKkC,SAAU,CAC5DvH,EAAOqF,KAAKxG,KAAK4I,SAAQH,OACvBI,OAAOC,OAAO,GACZ,CAAE9C,QAAS7E,EAAOqF,MAClBrI,KAAKoH,YAAYvG,wBACL,QAAZ+J,IAAOH,aAAK,SAAEgC,MAAQzJ,EAAOyH,MAAMgC,MAAQ,KAE/C,MAAM5E,EAAU7H,KAAKuB,IAAIuL,qBAAqBO,WAAWC,GAAGC,eAAevK,EAAOnB,KAAK2L,IACvF,GAAI3F,EAEF,YADAA,EAAQ4F,SAASzK,EAAOqF,KAAKxG,KAAK4I,OAGpCzK,KAAKuB,IAAIuL,qBAAqBhC,WAAW9H,EAAOqF,KAAiBiC,YACjEtK,KAAK0N,gBAAgBC,OAEzB,CAEAC,gBAAgB5K,SAEd,GADAhD,KAAKsJ,eAAerI,UAAK,GACrB+B,EAAOnB,KAAKwI,WAAaC,MAI7B,KAA8C,IAA1CtK,KAAKkB,MAAMgH,MAAMnH,IAAIiC,GAAQwH,SAAmB,CAClDxK,KAAK0N,gBAAgBC,OACrB,MAAM9F,EAAU7H,KAAKuB,IAAIuL,qBAAqBO,WAAWC,GAAGC,eAAevK,EAAOnB,KAAK2L,IACvF,GAAI3F,EAAS,CACX,MAAM4C,KAAQH,OACZI,OAAOC,OAAO,GACZ,CAAE9C,QAAS7E,EAAOqF,MAClBrI,KAAKoH,YAAYvG,wBACL,QAAZ+J,IAAOH,aAAK,SAAEgC,MAAQzJ,EAAOyH,MAAMgC,MAAQ,KAC/C5E,EAAQ4F,SAAShD,GAEnB,OAEFzK,KAAKuB,IAAIuL,qBAAqB3C,cAAcnH,EAAOqF,KAAe,CACpE,CAOAwF,eAAe7K,GACbhD,KAAKuB,IAAIuL,qBAAqBO,WAAWC,GAAGQ,QAC5C9N,KAAK+N,mBAAmB/K,GACxBhD,KAAKoH,YAAYrE,kBAAkBC,EACrC,CAEAgL,SAASC,IACHjO,KAAKyI,eAAgB,KACvBzI,KAAKwH,WAAWtG,MAAMgN,YACtBlO,KAAKuB,IAAI2I,oBAAoB4D,QAC7B9N,KAAKyI,eAAgB,GAEvBzI,KAAKkB,MAAM4M,QACX9N,KAAK2I,YAAa,EAClB3I,KAAK6I,mBAAoB,EACzB,MAAMsF,EAAUF,EAAME,QACtBnO,KAAKwI,YAAYN,MAAMkG,UAAU,CAAEjG,SAAS,EAAOqC,UAAU,IAC7D,MAAM6D,EAAarO,KAAKwI,YAAY8F,UAAUnL,MAC3CiH,OAAQpH,GAAyBA,EAAOxB,SAAWyM,EAAMM,SAAS/M,QAClEgN,OAAOL,GACVnO,KAAKwI,YAAYiG,WAAWJ,GAE5B9I,WAAW,KACT,MAAMmJ,EAAU1O,KAAKqH,MAAMsH,cAAcC,cAAc,YACvD,IAAIC,EACJZ,EAAMM,SAASO,QAAQ9K,UAAWxC,IAI9BqN,EAHGrN,EAAO,IAAOA,EAAO,GAAGA,OAEW,aAA7BA,EAAO,GAAGA,OAAOuN,QACZL,EAAQE,cAAc,0BACE,WAA7BpN,EAAO,GAAGA,OAAOuN,QACZL,EAAQE,cAAc,wBACE,cAA7BpN,EAAO,GAAGA,OAAOuN,QACZL,EAAQE,cAAc,2BAEtBF,EAAQE,cAAc,IAAMpN,EAAO,GAAGA,OAAOuN,QAAU,iBARvD,KAWE,OAAhBF,IACC7O,KAAKgP,mBAAmBN,EAASG,KAElCH,EAAQO,UACNJ,EAAYK,UACZL,EAAYM,aACZT,EAAQU,eAEb,EACA,IACL,CAEAC,oBACE,MAAMC,EAAQnK,SAASoK,qBAAqB,2BACtCb,EAAU1O,KAAKqH,MAAMsH,cAAcY,qBACvC,YACA,GACF,IAAIC,EAEJ,QAASC,EAAI,EAAGA,EAAIH,EAAMI,OAAQD,IAC5BH,EAAMG,GAAGE,UAAU3I,SAAS,4BAC9BwI,EAAeF,EAAMG,IAGzB,MAAO,CAACf,EAASc,EACnB,CAEAI,eAAeC,EAAYC,GACpB9P,KAAKgP,mBAAmBa,EAAYC,KACvCD,EAAWZ,UACTa,EAAKZ,UACLY,EAAKC,SAAS,GAAGZ,aACjBU,EAAWT,aAEjB,CAEAY,sBACE,GAAIhQ,KAAK6H,QAAQ0C,SAAU,CACzB,MAAM0F,EAAiBjQ,KAAKkQ,OAAOC,YAAYnQ,KAAK6H,QAAS,CAC3DuI,eAAgBpQ,KAAK6H,QAAQ2D,WAC7B6E,kBAAmBrQ,KAAKuB,IAAIiK,cAE9B,SAAiBxL,KAAKuB,IAAK,CAAC0O,GAAiB3F,YAEjD,CAMQyD,mBAAmB/K,SACzB,GAAIA,EAAOnB,KAAKwI,WAAaC,MAC3B,OAEF,MAAMzC,EAAW7E,EAAiCqF,MAG7CR,EAAQ0C,WAIb1C,EAAQhG,KAAK4I,SAAQH,OACnBI,OAAOC,OAAO,GACZ,CAAE9C,WACF7H,KAAKoH,YAAYxG,4BACL,QAAZgK,IAAOH,aAAK,SAAEmC,UAAY5J,EAAOyH,MAAMmC,UAAY,KAEvD5M,KAAKuB,IAAIuL,qBAAqBhC,WAAWjD,GAC3C,CAEAmH,mBAAmBa,EAAYC,GAE7B,MAAMQ,EAAaT,EAAWZ,UACxBsB,EAAgBD,EAAaT,EAAWT,aAExCoB,EAAUV,EAAKZ,UAErB,OADmBsB,EAAUV,EAAKV,aAAe,GAC5BmB,GAAiBC,GAAWF,CACnD,CAEAG,WAEEzQ,KAAKuH,eAAemJ,WAAWC,aAC/BpL,WAAW,KACT,IAAIqL,GAAqB,EACrB5Q,KAAKmN,YAAcnN,KAAKmN,WAAWxG,cACvC3G,KAAKmN,WAAanN,KAAKuH,eAAemJ,WAAWG,kBAAkB7M,UAAW8M,IAC5E,GAAI9Q,KAAKuH,eAAemJ,WAAWG,kBAAkB1N,QAAUyN,EAAoB,CACjFA,GAAqB,EACrB,MAAMG,EAAO/Q,KAAKuH,eAAemJ,WAAWM,MAAMC,KAAMhJ,GAAqB,IAAfA,EAAEiJ,UAChE,IAAIC,EACJ,GAAInR,KAAK6H,QAAQ0C,SACf,GAAmC,UAA/BvK,KAAK6H,QAAQ0C,SAAS9I,KACxB0P,EAAQ,CAACnR,KAAK6H,QAAQ0C,SAAS6G,YAAY,GAAIpR,KAAK6H,QAAQ0C,SAAS6G,YAAY,QAC5E,CACL,MAAMC,KAAQC,MAAetR,KAAK6H,QAAQ0C,UAC1C4G,EAAQ,CAACE,EAAM9G,SAAS6G,YAAY,GAAIC,EAAM9G,SAAS6G,YAAY,IAMvE,GAHAL,EAAKQ,KAAOvR,KAAK4H,aACjBmJ,EAAKK,YAAcD,EACnBnR,KAAKuH,eAAemJ,WAAWc,OAAOT,GAClC/Q,KAAKuB,IAAIkQ,sBAAsBC,UAAUvO,MAAO,CAClD,MAAMwO,EAAa3R,KAAKuB,IAAIkQ,sBAAsBC,UAAUvO,MACtD4N,EAAO/Q,KAAKuH,eAAemJ,WAAWM,MAAMC,KAAMhJ,GAAqB,IAAfA,EAAEiJ,UAC1DU,EAAeC,MAAiBF,EAAWT,SAAUS,EAAWnG,WAAY,aAC5E2F,KAAyB7G,OAAa,CAACsH,EAAa,GAAIA,EAAa,IAAK,GAChFb,EAAKQ,KAAOJ,EAAMW,KAAK,KACvBf,EAAKK,YAAcD,EACnBnR,KAAKuH,eAAemJ,WAAWc,OAAOT,MAI3C,EACA,IACL,yCAjhBW7J,GAA0BxH,4GAA1BwH,EAA0BzH,yGAA1BsS,eAAa,43BD9D1BrS,wDACGA,+IC6DUwH,qUAA0B8K,KAVtC9R,MAAc,CACbkM,KAAM,gBACN6F,MAAO,sCACPC,KAAM,8IAmHcC,KACGvS,EACNF,MACGyS,KACMA,KACTC,KACKD,QAlHXjL,yDCvDLxH,iBACEA,uBACFA,+BAD4BA,2EAG5BA,iBAAoH,UAC1CA,8BAAmDA,QAC3HA,qBAA8CA,8EAASA,qCAAmC,GACxFA,uBACFA,uDAHGA,qCAAqEA,iGAM1EA,kBACEA,SACFA,wCADEA,wDAGFA,iDAA+IA,sIAI/IA,kBACqC,UACmBA,8EAASA,+BAA6B,GAAEA,SAAyCA,uDAApIA,sCAA2FA,yFAGhGA,kBACqC,UACmBA,8EAASA,+BAA6B,GAAEA,8BAAyCA,QACvIA,qBAA8CA,8EAASA,qCAAmC,GACxFA,uBACFA,gBAHGA,sCAA2FA,6FAMhGA,kBACqC,UACUA,8EAASA,+BAA6B,GACjFA,0DACFA,4CAFGA,qCACkBA,qFAIvBA,kEAAiFA,uEA1CrFA,iBAAiG,WAG7FA,wBAIAA,wBAOAA,wBAIAA,wBAIAA,wBAKAA,wBAQAA,wBAOAA,wBAEFA,+CA5CwEA,qBAGhEA,6EAIAA,6EAOcA,4DAIdA,iIAIAA,uFAKAA,2IAQAA,sHAOAA,4GA7CdA,iBAGIA,6CA+CFA,8BA/C4BA,2ECsBvB,MAAM2S,GAuCX7S,YACU8S,EACAC,EACAxS,EACAyS,EACAC,GAJAzS,aACAA,sBACAA,qBACAA,YACAA,sBA1CFA,kBAAe,IAAI0S,KAyBjB1S,cAAW,IAAIN,MAMfM,mBAAgB,IAAIN,MAa5BM,KAAKuS,eAAeI,eAAe7O,QAAK8O,MAAU5S,KAAK6S,eAAe7O,UAAWkE,IAC/ElI,KAAKkI,MAAQA,GAEjB,CA5CI1G,aACF,OAAOxB,KAAK8S,OACd,CACItR,WAAO2B,GACTnD,KAAK8S,QAAU3P,EACfnD,KAAKsS,MAAMS,eACb,CAKIlL,cACF,OAAO7H,KAAKgT,QACd,CACInL,YAAQ1E,GACVnD,KAAKgT,SAAW7P,EAChBnD,KAAKsS,MAAMS,gBACX/S,KAAKiT,cAActF,MACrB,CA4BA3E,WACEhJ,KAAKkT,OAAQ,EACblT,KAAKiS,MAAQjS,KAAK6H,QAAQsL,WAAWhQ,KACvC,CAEAuD,cACE1G,KAAKoT,SAASzF,MAAK,GACnB3N,KAAK6S,aAAa5R,OAClBjB,KAAK6S,aAAaQ,UACpB,CAEAC,cAAcC,GACZ,OAAOA,EAAQC,WAAWC,QAAQ,IAAK,IACzC,CAMAC,SAASvQ,GACP,MAAwB,iBAAVA,CAChB,CAEAwQ,MAAMxQ,GACJ,GAAqB,iBAAVA,EACT,QAAInD,KAAK4T,MAAMzQ,IACC,qBACD0Q,KAAK1Q,EAAM2Q,cAK9B,CAEAF,MAAMzQ,GACJ,GAAqB,iBAAVA,EAET,MADc,eACD0Q,KAAK1Q,EAEtB,CAEA4Q,MAAM5Q,GACJ,GAAoB,iBAATA,EACT,QAAInD,KAAK4T,MAAMzQ,IACC,mBACD0Q,KAAK1Q,EAAM2Q,cAK9B,CAEAE,eAAe7Q,GACb,GAAqB,iBAAVA,EAAoB,CAC3B,MAAM8Q,EAAa,MAGnB,OAAc,KAFA9Q,EAAM+Q,MAAMD,IAAe,IACrBvE,OAOxB,OAAO,CACT,CAEFyE,cAAchR,SACZ,IAAIiR,EACJ,MAAMC,EAAa,IAAIC,QAAyB,QAAlB1J,OAAK7K,qBAAa,eAAE8G,UAAU,cAAe,cAE3E,GAAIwN,EAAWR,KAAK1Q,GAClBiR,EAAMjR,EAAM+Q,MAAMG,GAAY,GAE9BrU,KAAKwS,KAAKzR,IAAIqT,EAAK,CACjBG,aAAc,SAEfvQ,UAAWwQ,IACV,MAAMC,EAAUC,IAAIC,gBAAgBH,GACpCxP,OAAOH,KAAK4P,EAAS,UACrBzU,KAAKsS,MAAMS,eAAa,EAEzBxO,IACCvE,KAAKyS,eAAelO,MAAM,oCAAqC,yCAAwC,OAEpG,CACL,IAAI6P,EAAMjR,EACV,GAAInD,KAAKgU,eAAe7Q,GAAQ,CAC9B,IAAIyR,EAAMzP,SAAS0P,cAAc,OACjCD,EAAIE,UAAY3R,EAChBiR,EAAMQ,EAAI7E,SAAS,GAAGgF,aAAa,QAErC/P,OAAOH,KAAKuP,EAAK,UAErB,CAEAY,oBAAoB7R,GAElB,IAAIoO,EAAOpO,EAAM+Q,MADH,mBACgB,GAC9B,SAAO3C,EAAKkC,QAAQ,KAAM,IACnBlC,CACT,CAEA0D,wBAAwBpN,GACtB,MAAMqN,EAAwBrN,EAAQhG,KAAOgG,EAAQhG,KAAKsT,WAAQ,EAClEnV,KAAK4H,aAAeC,EAAQhG,KAAOgG,EAAQhG,KAAKoQ,WAAQ,EACxD,MAAMkB,EAAa,GAOnB,OAJItL,EAAQsL,YAActL,EAAQsL,WAAWiC,cACpCvN,EAAQsL,WAAWiC,MAGxBF,GACFxK,OAAO2K,KAAKH,GAAuBI,QAAQC,IACzCpC,EAAW+B,EAAsBK,IAAU1N,EAAQsL,WAAWoC,KAEzDpC,IAuBDnT,KAAKkI,MAAMsN,YAAc3N,EAAQhG,MAAQgG,EAAQhG,KAAK4T,iBAC/B5N,EAAQhG,KAAK4T,iBACrBH,QAAQI,WAChB7N,EAAQsL,WAAWuC,MAElB1V,KAAKkI,MAAMsN,YAAc3N,EAAQhG,MAAQgG,EAAQhG,KAAK8T,yBAChC9N,EAAQhG,KAAK8T,wBACrBL,QAAQI,WACvB7N,EAAQsL,WAAWuC,KAKzB7N,EAAQsL,WACjB,CAKEyC,oBAAoBzS,GACC0S,WAAe1S,IAEhCnD,KAAKyS,eAAeqD,QAAQ,6BAEhC,4BCjOIpW,iBACEA,uBACFA,+BAD4BA,2EAG5BA,iBAAoH,UAC1CA,8BAAmDA,QAC3HA,qBAA8CA,8EAASA,qCAAmC,GACxFA,uBACFA,uDAHGA,qCAAqEA,iGAM1EA,kBACEA,SACFA,wCADEA,wDAGFA,iDAA+IA,yEDJ1I2S,IAAuB3S,yFAAvB2S,GAAuB5S,0rCDzBpCC,6BAAwFA,wuDEiChFA,kBACqC,UACmBA,8EAASA,+BAA6B,GAAEA,SAAyCA,uDAApIA,sCAA2FA,yFAGhGA,kBACqC,UACmBA,8EAASA,+BAA6B,GAAEA,8BAAyCA,QACvIA,qBAA8CA,8EAASA,qCAAmC,GACxFA,uBACFA,gBAHGA,sCAA2FA,6FAMhGA,kBACqC,UACUA,8EAASA,+BAA6B,GACjFA,0DACFA,4CAFGA,qCACkBA,qFAIvBA,kEAAiFA,uEA1CrFA,eAA0E,WAGtEA,wBAIAA,wBAOAA,wBAIAA,wBAIAA,wBAKAA,wBAQAA,wBAOAA,wBAEFA,+CAzCQA,6EAIAA,6EAOcA,4DAIdA,iIAIAA,uFAKAA,2IAQAA,sHAOAA,4GArDdA,iBACEA,6CACAA,2CASEA,6CA+CFA,8BApDEA,0DAA6C,8CAA7CA,CAA6C,4DAKnBA,2ECevB,MAAMqW,GAsDXvW,YACU8S,EACAC,EACA/O,EACAzD,EACAyS,EACAC,GALAzS,aACAA,sBACAA,uBACAA,qBACAA,YACAA,sBA1DFA,kBAAe,IAAI0S,KA6CjB1S,mBAAgB,IAAIN,MAe5BM,KAAKuS,eAAeI,eAAe7O,QAAK8O,MAAU5S,KAAK6S,eAAe7O,UAAWkE,IAC/ElI,KAAKkI,MAAQA,GAEjB,CA5DI1G,aACF,OAAOxB,KAAK8S,OACd,CACItR,WAAO2B,GACTnD,KAAK8S,QAAU3P,EACfnD,KAAKsS,MAAMS,eACb,CAKIlL,cACF,OAAO7H,KAAKgT,QACd,CACInL,YAAQ1E,GACVnD,KAAKgT,SAAW7P,EAChBnD,KAAKsS,MAAMS,gBACX/S,KAAKiT,cAActF,MACrB,CAGIqI,aACF,OAAOhW,KAAKiW,OACd,CACID,WAAO7S,GACTnD,KAAKiW,QAAU9S,CACjB,CAIIsF,oBACF,OAAOzI,KAAK0I,cACd,CACID,kBAActF,GAChBnD,KAAK0I,eAAiBvF,CACxB,CA2BA6F,WACEhJ,KAAKkT,OAAQ,CACf,CAEAxM,cACE1G,KAAKyI,eAAgB,EACrBzI,KAAK6S,aAAa5R,OAClBjB,KAAK6S,aAAaQ,UACpB,CAEAC,cAAcC,GACZ,OAAOA,EAAQC,WAAWC,QAAQ,IAAK,IACzC,CAEAyC,kBACMlW,KAAKgW,OACPhW,KAAKmW,mBAAqB,QAE1BnW,KAAKmW,mBAAqB,OAE9B,CAKMlE,YACF,SAAO/R,MAAeF,KAAK6H,QAC7B,CAEF6L,SAASvQ,GACP,MAAwB,iBAAVA,CAChB,CAEAwQ,MAAMxQ,GACJ,GAAqB,iBAAVA,EACT,QAAInD,KAAK4T,MAAMzQ,IACC,qBACD0Q,KAAK1Q,EAAM2Q,cAK9B,CAEAF,MAAMzQ,GACJ,GAAqB,iBAAVA,EAET,MADc,eACD0Q,KAAK1Q,EAEtB,CAEA4Q,MAAM5Q,GACJ,GAAoB,iBAATA,EACT,QAAInD,KAAK4T,MAAMzQ,IACC,mBACD0Q,KAAK1Q,EAAM2Q,cAK9B,CAEAE,eAAe7Q,GACb,GAAqB,iBAAVA,EAAoB,CAC3B,MAAM8Q,EAAa,MAGnB,OAAc,KAFA9Q,EAAM+Q,MAAMD,IAAe,IACrBvE,OAOxB,OAAO,CACT,CAEFyE,cAAchR,SACZ,IAAIiR,EACJ,MAAMC,EAAa,IAAIC,QAAyB,QAAlB1J,OAAK7K,qBAAa,eAAE8G,UAAU,cAAe,cAE3E,GAAIwN,EAAWR,KAAK1Q,GAClBiR,EAAMjR,EAAM+Q,MAAMG,GAAY,GAE9BrU,KAAKwS,KAAKzR,IAAIqT,EAAK,CACjBG,aAAc,SAEfvQ,UAAWwQ,IACV,MAAMC,EAAUC,IAAIC,gBAAgBH,GACpCxP,OAAOH,KAAK4P,EAAS,UACrBzU,KAAKsS,MAAMS,eAAa,EAEzBxO,IACCvE,KAAKyS,eAAelO,MAAM,oCAAqC,yCAAwC,OAEpG,CACL,IAAI6P,EAAMjR,EACV,GAAInD,KAAKgU,eAAe7Q,GAAQ,CAC9B,IAAIyR,EAAMzP,SAAS0P,cAAc,OACjCD,EAAIE,UAAY3R,EAChBiR,EAAMQ,EAAI7E,SAAS,GAAGgF,aAAa,QAErC/P,OAAOH,KAAKuP,EAAK,UAErB,CAEAY,oBAAoB7R,GAElB,IAAIoO,EAAOpO,EAAM+Q,MADH,mBACgB,GAC9B,SAAO3C,EAAKkC,QAAQ,KAAM,IACnBlC,CACT,CAEA0D,wBAAwBpN,GACtB,MAAMqN,EAAwBrN,EAAQhG,KAAOgG,EAAQhG,KAAKsT,WAAQ,EAClEnV,KAAK4H,aAAeC,EAAQhG,KAAOgG,EAAQhG,KAAKoQ,WAAQ,EACxD,MAAMkB,EAAa,GAMnB,OAJItL,EAAQsL,YAActL,EAAQsL,WAAWiC,cACpCvN,EAAQsL,WAAWiC,MAGxBF,GACFxK,OAAO2K,KAAKH,GAAuBI,QAAQC,IACzCpC,EAAW+B,EAAsBK,IAAU1N,EAAQsL,WAAWoC,KAEzDpC,IAEDnT,KAAKkI,MAAMsN,YAAc3N,EAAQhG,MAAQgG,EAAQhG,KAAK4T,iBAC/B5N,EAAQhG,KAAK4T,iBACrBH,QAAQI,WAChB7N,EAAQsL,WAAWuC,MAElB1V,KAAKkI,MAAMsN,YAAc3N,EAAQhG,MAAQgG,EAAQhG,KAAK8T,yBAChC9N,EAAQhG,KAAK8T,wBACrBL,QAAQI,WACvB7N,EAAQsL,WAAWuC,KAIzB7N,EAAQsL,WACjB,2BCrNEzT,uDAEEA,yBAAkB,uCAAlBA,CAAkB,2EAKpBA,wCAIEA,8DAAaA,sCAAkC,GAEjDA,iCAJEA,yBAAkB,uCAAlBA,CAAkB,2EA9BxBA,WAGEA,4DAAYA,+BAA2B,GACvCA,kBAAqB,UAECA,yDAAUA,uBAAc,GAA0BA,SAASA,QAE/EA,oBAIEA,yDAAUA,sBAAa,wBAGvBA,sBACFA,UAKAA,wCAOAA,+CAQJA,gCA9B0EA,wBAOpEA,wDASCA,wEAOAA,+GDFMqW,IAA6BrW,qGAA7BqW,GAA6BtW,0yCD1B1CC,6BAAwFA,yoDG0CjF,MAAM0W,EA0FX5W,YACSyG,EACAzC,EACC6S,EACA7O,EACAzH,EACAqH,GALDpH,oBACAA,uBACCA,oBACAA,kBACAA,qBACAA,mBAxEAA,gBAAa,IAAIN,MAIjBM,cAAW,IAAIN,MAMfM,iBAAc,IAAIN,MAEpBM,uBAAoB,IAAIC,KAAgB,GACzCD,gCAA6B,IAAIC,KAAgB,GAEhDD,kBAAc,EAiBtBA,qBAAkB,IAAIC,SAAuC,GAgCrDD,oBAAgB,EAUtBA,KAAKsW,wBAA4E,IAAvDtW,KAAKD,cAAc8G,UAAU,uBACrD7G,KAAKD,cAAc8G,UAAU,sBAC/B7G,KAAKuW,0BAAgF,IAAzDvW,KAAKD,cAAc8G,UAAU,yBACvD7G,KAAKD,cAAc8G,UAAU,uBACjC,CApGI/G,qBACF,OAAOE,KAAKqW,aAAavW,cAC3B,CAGIyB,UACF,OAAOvB,KAAKwW,IACd,CACIjV,QAAI4B,GACNnD,KAAKwW,KAAOrT,CACd,CAIIjC,YACF,OAAOlB,KAAKyW,MACd,CACIvV,UAAMiC,GACRnD,KAAKyW,OAAStT,CAChB,CAyBI0E,cACF,OAAO7H,KAAKgT,QACd,CACInL,YAAQ1E,GACVnD,KAAKgT,SAAW7P,CAClB,CAQIuT,mBACF,OAAI1W,KAAKmO,QAAQuB,QACa,IAAxB1P,KAAKmO,QAAQuB,QAAgB1P,KAAKiJ,aACpCjJ,KAAK2W,aAAa3W,KAAKmO,QAAQ,IAE1B,WAEF,QACT,CAEqDyI,gBACnD3I,GAEAjO,KAAK6W,aACP,CAEI1I,cACF,OAAOnO,KAAKkB,MAAM8P,KACpB,CAEIxI,kBACF,OAAOxI,KAAKoH,YAAYlG,KAC1B,CAGI4V,mBAA0B,OAAO9W,KAAK+W,aAAe,CACrDD,iBAAaA,GACf9W,KAAK+W,cAAgBD,CACvB,CAiBQlN,yBACN5J,KAAKoL,+BAA8B/B,KAAc,CAC/CrJ,KAAKuB,IAAIgI,eAAe8B,OACxBrL,KAAKgX,kBAEJlT,QAAKmH,KAAa,MAClBjH,UAAWyF,IACV,MAAM6B,EAAiB7B,EAAM,GAC7B,IAAK6B,EAEH,YADAtL,KAAK0L,2BAA2BzK,MAAK,GAGvC,MAAMsK,KAAoBjB,OAAYgB,EAAejD,KAAMrI,KAAKuB,IAAIiK,YAC9DC,KAA0BnB,OAAwBtK,KAAKuB,IAAK,CAACgK,IACnEvL,KAAK0L,2BAA2BzK,QAAKqJ,OAAqBtK,KAAKuB,IAAKkK,GAAwB,EAElG,CAEAzC,WACEhJ,KAAKkB,MAAMoN,UAAUtK,UAAU,KAC7BhE,KAAKiJ,aAAc,IAErBjJ,KAAK4J,wBACP,CAEAlD,cACE1G,KAAK6W,cACD7W,KAAKiX,sBACPjX,KAAKiX,qBAAqBtQ,cAExB3G,KAAKoL,6BACPpL,KAAKoL,4BAA4BzE,aAErC,CAEAuQ,eAEElX,KAAKmX,WAAWxJ,MAClB,CAEAgJ,aAAa3T,GACXhD,KAAKkB,MAAMgH,MAAMsJ,OACfxO,EACA,CACEmF,SAAS,EACTqC,UAAU,IAEZ,GAEFxK,KAAKgX,gBAAgB/V,KAAK+B,GAE1B,MAAMoU,EAAW,GACjB,UAAWvP,KAAW7H,KAAKkB,MAAM8P,MAC3BnJ,EAAQhG,KAAK2L,KAAOxK,EAAOnB,KAAK2L,IAClC3F,EAAQQ,KAAKxG,KAAK4I,SAAQH,OACxBI,OAAOC,OAAO,GAAI,CAAE9C,QAASA,EAAQQ,MACnCrI,KAAKwH,WAAW6P,6BACpBxP,EAAQQ,KAAKxG,KAAK4I,MAAMoC,UAAU,MAElChF,EAAQQ,KAAKxG,KAAK4I,SAAQH,OACxBI,OAAOC,OAAO,GACZ,CAAE9C,QAASA,EAAQQ,MACnBrI,KAAKwH,WAAW8P,oBAEtBF,EAASnQ,KAAKY,EAAQQ,MACtBrI,KAAK4H,aAAeC,EAAQhG,KAAKoQ,MACjCjS,KAAKuX,WAEPvX,KAAKuB,IAAI2I,oBAAoBsN,eAAeJ,GAC5CpX,KAAKuB,IAAI2I,oBAAoBuN,YAAYL,EAAU9M,YAEnDtK,KAAK0X,kBAAkBzW,MAAK,GAC5BjB,KAAKiJ,aAAc,CACrB,CAEAsO,WACEvX,KAAKiS,MAAQjS,KAAKsW,mBAAoBtW,KAAKwD,gBAAgBmB,UAAUC,QAAQ,iBAAmB5E,KAAK4H,YACvG,CAEO+P,iBACL3X,KAAKgX,gBAAgB/V,UAAK,GAC1BjB,KAAK0X,kBAAkBzW,MAAK,GAC5BjB,KAAKkB,MAAMgH,MAAM4F,QAEjB,MAAMsJ,EAAW,GACjB,UAAWvP,KAAW7H,KAAKkB,MAAM8P,MAC/BnJ,EAAQQ,KAAKxG,KAAK4I,SAAQH,OACxBI,OAAOC,OAAO,GACZ,CAAE9C,QAASA,EAAQQ,MACnBrI,KAAKwH,WAAW8P,oBACpBF,EAASnQ,KAAKY,EAAQQ,MAExBrI,KAAKuB,IAAI2I,oBAAoB0N,YAAYR,EAAU9M,WAAoB,MACzE,CAEOuM,cACL7W,KAAKuB,IAAI2I,oBAAoB4D,QAC7B9N,KAAKkB,MAAM4M,QACX9N,KAAK2X,iBACL3X,KAAKoT,SAASzF,MAAK,GACnB3N,KAAK6X,YAAYlK,MAAK,GACtB3N,KAAKmX,WAAWxJ,MAClB,CAEAmK,2BAA2B7J,GACzBjO,KAAKoT,SAASzF,KAAKM,EACrB,2CClPIvO,kBAAsJ,eAKlJA,yDAASA,2BAAkB,wBAAEA,uBAC/BA,QACAA,iBAAqBA,8BAAgCA,QACrDA,oCAQFA,gCAhB2CA,uCAA+B,wCAA/BA,CAA+B,mCAGtEA,wDAImBA,2CAEnBA,kDAAiC,uBAAjCA,CAAiC,yBAAjCA,CAAiC,oCAAjCA,CAAiC,yBAAjCA,CAAiC,2CASrCA,kBAA2G,eAA3GA,CAA2G,OAA3GA,CAA2G,YAE3FA,8BAA+DA,UAC3EA,cAAI,YAAQA,8BAA8DA,UAC1EA,uCACJA,iBAHgBA,yEACAA,wEACTA,qIAIPA,uBAAoC,yBAOhCA,8DAAcA,iCAAwB,EAAtCA,CAAuC,2CAAvCA,CAAuC,0DAEvBA,kCAA8B,EAF9CA,CAAuC,uDAG1BA,+BAA2B,GAG1CA,kCAVEA,4BAAW,kBAAXA,CAAW,qBAAXA,CAAW,gCAAXA,CAAW,uBAAXA,CAAW,4FAcfA,uBACEA,yCAUJA,8BARMA,+BAAkB,gCAAlBA,CAAkB,wCAAlBA,CAAkB,kCAAlBA,CAAkB,kEDdf0W,GAAoB1W,+FAApB0W,EAAoB3W,sHAApBsS,oBAAuB,kyBD3CpCrS,wDACGA,4pBGiCI,MAAMqY,GAsGXvY,YACUO,EACAqH,EACAI,EACA8K,GAHAtS,qBACAA,mBACAA,kBACAA,aAzGVA,YAAkC,IAAIC,SAAwB,GAyBpDD,kBAAe,IAAIN,MAMnBM,cAAW,IAAIN,MAMfM,mBAAgB,IAAIN,MAcvBM,oCAAyC,EAazCA,WAAQ,IAAIE,KAAY,IAKxBF,qBAAkB,IAAIC,SAAyB,GA0B5CD,iBAAc,IAAIN,MAClBM,gBAAa,IAAIN,MACjBM,iBAAc,IAAIN,KAU1B,CAxGE6B,UACF,OAAOvB,KAAKwW,IACd,CACIjV,QAAI4B,GACNnD,KAAKwW,KAAOrT,CACd,CAII6U,aACF,OAAOhY,KAAKiY,OACd,CACID,WAAO7U,GACLA,IAAUnD,KAAKiY,UAInBjY,KAAKiY,QAAU9U,EACfnD,KAAKkY,aAAavK,KAAK3N,KAAKiY,SAC9B,CAWIlP,iBACF,OAAO/I,KAAKwH,WAAWtG,KACzB,CAKI2G,cACF,OAAO7H,KAAKgT,QACd,CACInL,YAAQ1E,GACVnD,KAAKgT,SAAW7P,EAChBnD,KAAKsS,MAAMS,gBACX/S,KAAKiT,cAActF,MACrB,CASIhF,iBACF,OAAO3I,KAAK4I,WACd,CACID,eAAWxF,GACbnD,KAAK4I,YAAczF,CACrB,CAUIqF,kBACF,OAAOxI,KAAKoH,YAAYlG,KAC1B,CAGIiX,aACF,OAAOnY,KAAKoY,OACd,CACID,WAAOhV,GACTnD,KAAKoY,QAAUjV,CACjB,CAII0F,wBACF,OAAO7I,KAAK8I,kBACd,CACID,sBAAkB1F,GACpBnD,KAAK8I,mBAAqB3F,CAC5B,CAmBE6F,WACEhJ,KAAK+I,WAAWuF,UACftK,UACEqU,IACGA,EAAS3I,OAAS,GACpB1P,KAAKoT,SAASzF,MAAK,GACnB3N,KAAK6I,mBAAoB,EACzB7I,KAAK6X,YAAYlK,MAAK,GACtB3N,KAAKsY,eAGLtY,KAAKuY,wBAAsB,EAGjC,CAGA7R,cACE1G,KAAKkB,MAAMsX,UACXxY,KAAKkB,MAAMoN,UAAU3H,cACrB3G,KAAK6I,mBAAoB,EACzB7I,KAAKsY,cACLtY,KAAKyY,aACLzY,KAAKuB,IAAImX,gBAAgB/R,WAC3B,CAEAqI,mBAAmBa,EAAYC,GAE7B,MAAMQ,EAAaT,EAAWZ,UACxBsB,EAAgBD,EAAaT,EAAWT,aACxCoB,EAAUV,EAAKZ,UAErB,OADmBsB,EAAUV,EAAKV,aAAe,GAC5BmB,GAAiBC,GAAWF,CACnD,CAOAlD,cAAcpK,GACZhD,KAAK+N,mBAAmB/K,GACxBhD,KAAK2Y,gBAAmB3V,EAAiCqF,IAC3D,CAMQ0F,mBAAmB6K,GACrBA,EAAM/W,KAAKwI,WAAaC,YAKA,IAAxBsO,EAAMvQ,KAAKkC,WAIfvK,KAAKuB,IAAIuL,qBAAqB8K,YAC5B,CAACgB,EAAMvQ,MACPiC,eAGFtK,KAAK0H,8BAAgC1H,KAAKD,cAAc8G,UAAU,iCACpE,CAKFgS,uBACE7Y,KAAKuB,IAAIuL,qBAAqBgB,OAChC,CAEAyK,yBACEvY,KAAKmX,WAAWxJ,OAChB3N,KAAKoT,SAASzF,MAAK,IACd3N,KAAK2I,aAAe3I,KAAK6I,mBAC5B7I,KAAK6X,YAAYlK,MAAK,IAClB3N,KAAK2I,YAAc3I,KAAK6I,oBAC5B7I,KAAK6X,YAAYlK,MAAK,EAE1B,CAEA2K,cACEtY,KAAKuB,IAAIuL,qBAAqBgB,QAC9B9N,KAAKwI,YAAYsF,QACjB9N,KAAKoH,YAAYrE,uBAAkB,GACnC/C,KAAKoH,YAAYjF,qCACjBnC,KAAK2I,YAAa,EAClB3I,KAAKoH,YAAY5E,cAAc,GACjC,CAEAiW,aACEzY,KAAKwH,WAAWtG,MAAMgN,YACtBlO,KAAKwH,WAAWtG,MAAM4M,QACtB9N,KAAKoT,SAASzF,MAAK,GACnB3N,KAAK6Y,sBACP,CAEAC,mBACE9Y,KAAK6I,mBAAoB,EACzB7I,KAAK+Y,YAAYpL,OACjB3N,KAAKuB,IAAImX,gBAAgB/R,WAC3B,CAEAqS,uBAAuB/K,GACrBjO,KAAK6X,YAAYlK,KAAKM,EACxB,CAEAgL,oBAAoBhL,GAClBjO,KAAKoT,SAASzF,KAAKM,EACrB,yCA9NW8J,IAAkBrY,yEAAlBqY,GAAkBtY,+FAAlBsS,eAAa,snDDlC1BrS,iBAAsC,qBAKlCA,6DAA2B,2BAChBqS,oBAAkB,EAD7BrS,CAA2B,gCAEZqS,oBAAkB,GAEjCrS,mBAEEA,yBAkBAA,0CAQAA,wBAiBAA,wBAWIA,UAGRA,uBAWEA,0DAASA,iBAAgB,+CACzBA,wBAIFA,mCAhFEA,+BAAmB,2BAOCA,2CAkBUA,gGAQbA,uCAiBDA,oCAehBA,yEAAoE,oFAalEA,sxFEtEAA,8BAEEA,0DAAUA,4BAAwB,EAAlCA,CAAmC,mCACjBwZ,mBAAwB,EAD1CxZ,CAAmC,mCAEjBwZ,mBAAwB,EAF1CxZ,CAAmC,+DAYdA,8BAA0B,EAZ/CA,CAAmC,mEAiBVA,wCAAoC,EAjB7DA,CAAmC,0EAmBHA,+CAA2C,EAnB3EA,CAAmC,2DAoBlBA,0BAAsB,EApBvCA,CAAmC,qDAqBxBA,oBAAgB,wBAC7BA,gCAlBEA,yBAAiB,oCAAjBA,CAAiB,oBAAjBA,CAAiB,cAAjBA,CAAiB,8BAAjBA,CAAiB,0BAAjBA,CAAiB,sBAAjBA,CAAiB,yDAAjBA,CAAiB,yGAsBrBA,iBAA8F,eAK1FA,yDAAUA,2BAAkB,wBAAEA,uBAChCA,QACAA,iBAAqBA,8BAAgCA,QACrDA,oCAQFA,gCAhBiBA,+CAIbA,uDAGmBA,2CAEnBA,kDAAkC,uBAAlCA,CAAkC,yBAAlCA,CAAkC,oCAAlCA,CAAkC,yBAAlCA,CAAkC,2CASpCA,kBAA6H,eAA7HA,CAA6H,OAA7HA,CAA6H,YAE7GA,8BAA+DA,UAC3EA,cAAI,YAAQA,8BAA8DA,UAC1EA,uCACJA,iBAHgBA,yEACAA,wEACTA,qIAIPA,uBAA+C,yBAM3CA,8DAAeA,iCAAwB,EAAvCA,CAAwC,0DAGxBA,kCAA8B,EAH9CA,CAAwC,uDAI3BA,+BAA2B,GAE1CA,kCATEA,4BAAY,qBAAZA,CAAY,kBAAZA,CAAY,gCAAZA,CAAY,6EAahBA,uBAA2C,2BAQvCA,qEAAqBA,8BAA0B,EAA/CA,CAAgD,6DAC5BA,qBAAY,EADhCA,CAAgD,0DAEhCA,yBAAqB,EAFrCA,CAAgD,2DAG/BA,yBAAqB,EAHtCA,CAAgD,0DAIhCA,oBAAgB,GAElCA,kCAXEA,sCAAsB,cAAtBA,CAAsB,eAAtBA,CAAsB,8BAAtBA,CAAsB,gBCvCzB,MAAMyZ,GAuIX3Z,YACUO,EACAqZ,EACAhS,EACAiS,EACA7R,EACA8K,EACAnL,EACAkP,EACAhP,GARArH,qBACAA,kBACAA,mBACAA,qBACAA,kBACAA,aACAA,gBACAA,oBACAA,aA9IVA,YAAkC,IAAIC,SAAwB,GAWpDD,iBAAc,IAAIN,MAOnBM,iBAAa,EAMZA,cAAW,IAAIN,MAMjBM,oBAAgD,IAAIC,SAC1D,GAGFD,qBAAkB,IAAIC,SAAuC,GAEnDD,mBAAgB,IAAIN,MAcvBM,oCAAgC,EAqBhCA,WAAQ,IAAIE,KAAY,IAExBF,qCAA0C,EAI1CA,oBAAyB,EAEzBA,uBAAmB,EASnBA,kBAAqC,GAOrCA,qBAAiB,EAExBA,eAAsC,IAAIC,KAAgB,GAalDD,gBAAY,EAIZA,oCAA4C,GAe1CA,iBAAc,IAAIN,MAElBM,gBAAa,IAAIN,MAavBM,KAAKoZ,WAAWE,OAAOtZ,KAAKuB,KAC5BvB,KAAKuZ,mBAAkE,IAAlDvZ,KAAKD,cAAc8G,UAAU,kBAClD7G,KAAKD,cAAc8G,UAAU,iBAC7B7G,KAAKwZ,SAAWxZ,KAAKF,eAAeiB,IAAI,WAC1C,CAjJE8H,wBACF,OAAO7I,KAAK8I,kBACd,CACID,sBAAkB1F,GACpBnD,KAAK8I,mBAAqB3F,CAC5B,CAMI5B,UACF,OAAOvB,KAAKmH,SAAS5F,GACvB,CAUIwH,iBACF,OAAO/I,KAAKwH,WAAWtG,KACzB,CAWI2G,cACF,OAAO7H,KAAKgT,QACd,CACInL,YAAQ1E,GACVnD,KAAKgT,SAAW7P,EAChBnD,KAAKsS,MAAMS,gBACX/S,KAAKiT,cAActF,MACrB,CAOIxE,WACF,OAAOnJ,KAAKyZ,KACd,CACItQ,SAAKhG,GACPnD,KAAKyZ,MAAQtW,EACbnD,KAAK0Z,aAAe,EACtB,CAII/Q,iBACF,OAAO3I,KAAK4I,WACd,CACID,eAAWxF,GACbnD,KAAK4I,YAAczF,CACrB,CAMMmF,mBACJ,OAAOtI,KAAKoH,YAAYmB,oBAAoBpF,KAC9C,CAQIqF,kBACF,OAAOxI,KAAKoH,YAAYlG,KAC1B,CAIIpB,qBACF,OAAOE,KAAKqW,aAAavW,cAC3B,CAOI0Z,eACF,OAAOxZ,KAAK2Z,SACd,CACIH,aAASrW,GACPA,KAAWnD,KAAK2Z,YAGpB3Z,KAAK2Z,UAAYxW,EACjBnD,KAAK4Z,UAAU3Y,KAAKkC,GACpBnD,KAAKF,eAAesD,IAAI,WAAYD,GACtC,CAQIgV,aACF,OAAOnY,KAAKoY,OACd,CACID,WAAOhV,GACTnD,KAAKoY,QAAUjV,CACjB,CA4BA6F,WAyBE,IAAI6Q,EACAlO,EAzBJ3L,KAAK8Z,aACL9Z,KAAK+Z,cAAgB/Z,KAAKD,cAAc8G,UAAU,qBAElD7G,KAAK+I,WAAWuF,UACftK,UACEqU,IACGA,EAAS3I,OAAS,GACpB1P,KAAKga,YACLha,KAAKoT,SAASzF,MAAK,GACnB3N,KAAKsY,cACLtY,KAAK2I,YAAa,IAEb3I,KAAK6I,oBAAsB7I,KAAK2I,YACnC3I,KAAK8Z,YAAU,GAKrB9Z,KAAKuB,IAAImX,gBAAgB1U,UAAU,KACjChE,KAAKia,uBAAyBja,KAAKuB,IAAI4W,OAAO/N,OAAOwO,IACzB,IAA1BA,EAAMsB,gBACP,GAKCla,KAAK0H,gCACP1H,KAAKiX,wBAAuB5N,KAAc,CACxCrJ,KAAKsJ,eAAexF,QAClBgB,MAAKqV,IACHN,EAAeM,EACfxO,EAAU,aAGd3L,KAAKgX,gBAAgBlT,QACnBgB,MAAKqV,IACHN,EAAeM,EACfxO,EAAU,cAGd3L,KAAKuB,IAAIgI,eAAeC,YACxBxJ,KAAKkB,MAAMoN,YACVtK,UAAU,IAAMhE,KAAK0J,oBAAoBmQ,EAAclO,IAG9D,CAEAjF,cACE1G,KAAK2I,YAAa,EAClB3I,KAAKoT,SAASzF,MAAK,GACnB3N,KAAKkB,MAAMsX,UACXxY,KAAKkB,MAAMoN,UAAU3H,cACrB3G,KAAKuB,IAAImX,gBAAgB/R,YACzB3G,KAAKwH,WAAWtG,MAAMsX,UACtBxY,KAAKsY,aACP,CAEA8B,6BAA6BjX,GAC3BnD,KAAKqa,+BAAiClX,CACxC,CAEAmX,mBAAmBnR,EAAO,IACxBnJ,KAAKmJ,KAAOA,EACZnJ,KAAKua,kBAAmB,EACGpR,EAAKsK,QAAQ,aAAc,IAAI+G,OAEnC9K,OAAS,GAC9B1P,KAAKwI,YAAYsF,QACjB9N,KAAK2Y,qBAAkB,EACvB3Y,KAAK2I,YAAa,EAClB3I,KAAKsY,eAEDtY,KAAKyI,gBACPzI,KAAKwH,WAAWtG,MAAMgN,YACtBlO,KAAKoT,SAASzF,MAAK,GACnB3N,KAAK2I,YAAa,EAGxB,CAEAqF,SAASC,GACPjO,KAAKga,YACDha,KAAKyI,gBACPzI,KAAKwH,WAAWtG,MAAMgN,YACtBlO,KAAKuB,IAAI2I,oBAAoB4D,QAC7B9N,KAAKoT,SAASzF,MAAK,IAErB3N,KAAK6I,mBAAoB,EACzB7I,KAAKwH,WAAWtG,MAAMgN,YACtBlO,KAAK2I,YAAa,EAClB3I,KAAKua,kBAAmB,EACxBva,KAAKkB,MAAM4M,QACX,MAAMK,EAAUF,EAAME,QACtBnO,KAAKwI,YAAYN,MAAMkG,UAAU,CAAEjG,SAAS,EAAOqC,UAAU,IAC7D,MAAM6D,EAAarO,KAAKwI,YAAY8F,UAAUnL,MAC3CiH,OAAQpH,GAAyBA,EAAOxB,SAAWyM,EAAMM,SAAS/M,QAClEgN,OAAOL,GACVnO,KAAKwI,YAAYiG,WAAWJ,GAE5B9I,WAAW,KACT,MAAMmJ,EAAU1O,KAAKqH,MAAMsH,cAAcC,cAAc,YACvD,IAAIC,EACJZ,EAAMM,SAASO,QAAQ9K,UAAWxC,IAI9BqN,EAHGrN,EAAO,IAAOA,EAAO,GAAGA,OAEW,aAA7BA,EAAO,GAAGA,OAAOuN,QACZL,EAAQE,cAAc,0BACE,WAA7BpN,EAAO,GAAGA,OAAOuN,QACZL,EAAQE,cAAc,wBACE,cAA7BpN,EAAO,GAAGA,OAAOuN,QACZL,EAAQE,cAAc,2BAEtBF,EAAQE,cAAc,IAAMpN,EAAO,GAAGA,OAAOuN,QAAU,iBARvD,KAWE,OAAhBF,IACC7O,KAAKgP,mBAAmBN,EAASG,KAElCH,EAAQO,UACNJ,EAAYK,UACZL,EAAYM,aACZT,EAAQU,eAEb,EACA,IACL,CAEAJ,mBAAmBa,EAAYC,GAE7B,MAAMQ,EAAaT,EAAWZ,UACxBsB,EAAgBD,EAAaT,EAAWT,aAExCoB,EAAUV,EAAKZ,UAErB,OADmBsB,EAAUV,EAAKV,aAAe,GAC5BmB,GAAiBC,GAAWF,CACnD,CAOAlD,cAAcpK,SAEZ,GADAhD,KAAKsJ,eAAerI,KAAK+B,GACrBA,EAAOnB,KAAKwI,WAAaC,OAAWtH,EAAOqF,KAAKkC,SAAU,CAC5DvH,EAAOqF,KAAKxG,KAAK4I,SAAQH,OACvBI,OAAOC,OAAO,GACZ,CAAE9C,QAAS7E,EAAOqF,MAClBrI,KAAKoH,YAAYvG,wBACL,QAAZ+J,IAAOH,aAAK,SAAEgC,MAAQzJ,EAAOyH,MAAMgC,MAAQ,KAE/C,MAAM5E,EAAU7H,KAAKuB,IAAIuL,qBAAqBO,WAAWC,GAAGC,eAAevK,EAAOnB,KAAK2L,IACvF,GAAI3F,EAEF,YADAA,EAAQ4F,SAASzK,EAAOqF,KAAKxG,KAAK4I,OAGpCzK,KAAKuB,IAAIuL,qBAAqBhC,WAAW9H,EAAOqF,KAAiBiC,YAEnEtK,KAAK+N,mBAAmB/K,GACxBhD,KAAK2Y,gBAAmB3V,EAAiCqF,UAC5B,IAAzBrI,KAAK2Y,iBACP3Y,KAAK8Z,YAET,CAMQ/L,mBAAmB6K,QACmB,IAAvC5Y,KAAKoH,YAAYrE,mBACpB/C,KAAK8Z,aAEHlB,EAAM/W,KAAKwI,WAAaC,YAKA,IAAxBsO,EAAMvQ,KAAKkC,WAIfvK,KAAKuB,IAAIuL,qBAAqB8K,YAC5B,CAACgB,EAAMvQ,MACPiC,eAEFtK,KAAK8Z,aACL9Z,KAAK0H,8BAAgC1H,KAAKD,cAAc8G,UAAU,iCACpE,CAKAgS,uBACE7Y,KAAKuB,IAAIuL,qBAAqBgB,QAC9B9N,KAAK8Z,YACP,CAEAW,qBACEza,KAAKwI,YAAYsF,QACjB,MAAMK,EAAUnO,KAAKqZ,cAAcqB,cAAc1a,KAAK2a,QAEtD,UAAWlL,KAAKtB,EACVA,EAAQuB,OAAS,GACnBvB,EAAQsB,GAAGX,QAAQ9K,UAAW4W,IAC5B5a,KAAKgO,SAAS,CAAEO,SAAUJ,EAAQsB,GAAItB,QAASyM,GAAU,EAIjE,CAEAC,iBAAiB5M,IACVjO,KAAK8a,iBAA4C,IAA1B9a,KAAKua,kBAC/Bva,KAAKga,YAEP/L,EAAM8M,iBACR,CAEAtC,aACEzY,KAAKwH,WAAWtG,MAAMgN,YACtBlO,KAAKwH,WAAWtG,MAAM4M,QACtB9N,KAAKoT,SAASzF,MAAK,GACnB3N,KAAK6Y,sBACP,CAEAN,yBACEvY,KAAKoT,SAASzF,MAAK,GACnB3N,KAAKmX,WAAWxJ,OAChB3N,KAAKsS,MAAMS,iBACP/S,KAAK2I,YAAc3I,KAAK6I,oBAC1B7I,KAAKga,WAET,CAEAgB,eAAe/M,GACbjO,KAAK2I,YAAa,EAClB3I,KAAKsY,cACLtY,KAAK8Z,aACL9Z,KAAKua,kBAAmB,EACpBtM,GACFA,EAAM8M,iBAEV,CAEAzC,cACEtY,KAAKuB,IAAIuL,qBAAqBgB,QAC9B9N,KAAKwI,YAAYsF,QACjB9N,KAAKoH,YAAYrE,uBAAkB,GACnC/C,KAAKoH,YAAYjF,qCACjBnC,KAAKmJ,KAAK,EACZ,CAEA2P,mBACE9Y,KAAK6I,mBAAoB,EACzB7I,KAAK8Z,aACL9Z,KAAK+Y,YAAYpL,OACjB3N,KAAKuB,IAAImX,gBAAgB/R,WAC3B,CAEAqS,uBAAuB/K,GACrBjO,KAAK6X,YAAYlK,KAAKM,EACxB,CAEAgL,oBAAoBhL,GAClBjO,KAAKoT,SAASzF,KAAKM,EACrB,CAEA6L,cACO9Z,KAAK2I,aAAe3I,KAAKyI,gBAAkBzI,KAAK6I,mBACnD7I,KAAK6X,YAAYlK,MAAK,EAE1B,CAEAqM,YACEha,KAAK6X,YAAYlK,MAAK,EACxB,CAEQ3D,qBAAqB2B,GACX,YAAZA,GAAyB3L,KAAK+M,wBAChC/M,KAAKuB,IAAIuL,qBAAqB3C,cAAcnK,KAAK+M,uBACjD/M,KAAK+M,2BAAwB,GAEf,aAAZpB,GAA0B3L,KAAKgN,yBACjChN,KAAKuB,IAAIuL,qBAAqB3C,cAAcnK,KAAKgN,wBACjDhN,KAAKgN,4BAAyB,GAEhB,UAAZrB,IACF3L,KAAKiN,+BAA+B1L,IAAI2L,GAAelN,KAAKuB,IAAIuL,qBAAqB3C,cAAc+C,IACnGlN,KAAKiN,+BAAiC,GAE1C,CAEQvD,oBACN1G,EACA2I,aAKA,GAHgB,UAAZA,GACF3L,KAAKgK,qBAAqB2B,IAEvB3I,IAAWA,EAAOqF,KAAKkC,SAC1B,OAGF,MAAMqB,KADctB,OAAYtH,EAAOqF,KAAMrI,KAAKuB,IAAIiK,YACvBK,cAC/B,MAAIvB,OAAyBtK,KAAKuB,IAAKqK,EAAWE,YAAiD,OAAS,CAC1G,MAAMC,EAASH,EAAWE,YACpBE,EAAID,EAAO,IAAMA,EAAO,GAAKA,EAAO,IAAM,EAC1CE,EAAIF,EAAO,IAAMA,EAAO,GAAKA,EAAO,IAAM,EAC1CG,EAAW,IAAIC,KAAU,CAC7BC,KAAM,GAAGT,mBACTpB,SAAU,IAAI8B,KAAQ,CAACL,EAAGC,MAEtBK,KAAiBhC,OAAc4B,EAAUlM,KAAKuB,IAAIiK,YAExD,IAAIe,EACAC,EAAe,EAEnB,OAAQb,OACD,UACHY,KAAgBjC,OACdI,OAAOC,OAAO,GACZ,CAAE9C,QAASyE,GACXtM,KAAKoH,YAAYvG,wBACL,QAAZ+J,IAAOH,aAAK,SAAEgC,MAAQzJ,EAAOyH,MAAMgC,MAAQ,KAC/CD,EAAe,EACf,UACG,QACHD,KAAgBjC,OAAqBI,OAAOC,OAAO,GACjD,CAAE9C,QAASyE,GACXtM,KAAKoH,YAAYjH,mBACL,QAAZuM,IAAOjC,aAAK,SAAEI,KAAO7H,EAAOyH,MAAMI,KAAO,KAC3C,UACG,WACH0B,KAAgBjC,OACdI,OAAOC,OAAO,GACZ,CAAE9C,QAASyE,GACXtM,KAAKoH,YAAYxG,4BACL,QAAZ+L,IAAOlC,aAAK,SAAEmC,UAAY5J,EAAOyH,MAAMmC,UAAY,KACvDJ,EAAe,EAGnBF,EAAezK,KAAK4I,MAAQ8B,EAC5BD,EAAezK,KAAK4I,MAAMoC,UAAU,IAAOL,GAC3CxM,KAAKuB,IAAIuL,qBAAqBhC,WAAWwB,EAAgBhC,YACzC,YAAZqB,IACF3L,KAAK+M,sBAAwBT,GAEf,aAAZX,IACF3L,KAAKgN,uBAAyBV,GAEhB,UAAZX,GACF3L,KAAKiN,+BAA+BhG,KAAKqF,QAG3CtM,KAAKgK,qBAAqB2B,EAE9B,yCA7fWwN,IAAoBzZ,wIAApByZ,GAAoB1Z,qiED9CjCC,iBAA6B,6BAIzBA,iCAAWqS,aAAW,EAAtBrS,CAAuB,2BACZqS,oBAAkB,EAD7BrS,CAAuB,gCAGPqS,oBAAkB,EAHlCrS,CAAuB,mCAILwZ,mBAAwB,EAJ1CxZ,CAAuB,2BAKbwZ,mBAAwB,GAElCxZ,sCACEA,oCA0BFA,QAEAA,yBAkBEA,0CAQAA,wBAgBAA,wBAkBJA,iBAjGEA,gCAAoB,6BASDA,uCA4BwCA,gDAkB7BA,wGAQbA,4CAgBDA,miFEvEb,MAAMub,GAcXzb,YACU2H,kBACP,CAZC5F,UACF,OAAOvB,KAAKmH,SAAS5F,GACvB,CAEI2Z,cACF,OAAOlb,KAAKuB,IAAI2Z,OAClB,CAQAlS,WACEhJ,KAAKia,uBAAyBja,KAAKuB,IAAI4W,OAAO/N,OAAOwO,IACzB,IAA1BA,EAAMsB,gBAEV,yCAtBWe,IAAqBvb,uCAArBub,GAAqBxb,kVCXlCC,iBAAwB,cAAkEA,sBAAuCA,UACjIA,gBAAqBA,8BAA8BA,QAEnDA,0CAFqBA,0CAGnBA,kDAAiC,uBAAjCA,CAAiC,yBAAjCA,CAAiC,oCAAjCA,CAAiC,qnECM5B,MAAMyb,GAcX3b,YAAmB4b,EAA6B5X,GAA7BxD,cAA6BA,uBAZzCA,eAAY,KAEZA,yBAAsBA,KAAKwD,gBAAgBmB,UAAUC,QAAQ,eAE1D5E,kBAAe,IAAIN,KAQuD,CAEpF2b,sBACOrb,KAAKsb,gBAAkBtb,KAAKgW,SACVhW,KAAKob,OAAOG,cAAc,4BAS7Cvb,KAAKwb,oBAAsBxb,KAAKwD,gBAAgBmB,UAAUC,QAAQ,eAClE5E,KAAKyb,UAAUC,UARf1b,KAAKwb,oBAAsBxb,KAAKwD,gBAAgBmB,UAAUC,QAAQ,gBAClE5E,KAAKyb,UAAYzb,KAAKob,OAAOvW,KAAKoW,GAAuB,CACvDzN,GAAI,0BACJmO,aAAa,EACbC,mBAAmB,MAOvB5b,KAAK6b,aAAalO,MACtB,yCAhCWwN,IAAqBzb,mDAArByb,GAAqB1b,gTCVlCC,oBAGIA,gCAASqS,sBAAoB,GAI7BrS,8BACJA,eAJIA,0CAAkC,wCAGlCA,gbCGEA,gCAEEA,0EAAwBA,wCAAoC,EAA5DA,CAA6D,gEAYzCA,8BAA0B,EAZ9CA,CAA6D,sDAanDA,oBAAgB,EAb1BA,CAA6D,2DAc7CA,sBAAa,wBAC/BA,iCAZEA,2CAAsC,oBAAtCA,CAAsC,0BAAtCA,CAAsC,uBAAtCA,CAAsC,sBAAtCA,CAAsC,sDAcxCA,2DArBFA,kBAEEA,oCAmBAA,wBAEAA,+BAKEA,6FAA2B,0DAMZA,uBAAmB,EANlCA,CAA2B,0DAOXA,4BAAmB,EAPnCA,CAA2B,yDAQZA,2BAAkB,EARjCA,CAA2B,wDASbA,iCAAwB,EATtCA,CAA2B,wDAUbA,0BAAiB,GAEjCA,kCAtCiBA,uCAmBXA,gCAKJA,4BAAW,kBAAXA,CAAW,0BAAXA,CAAW,0BAAXA,CAAW,qBAAXA,CAAW,wCAAXA,CAAW,gCAAXA,CAAW,kCAAXA,CAAW,0DAiCbA,2CAUIA,uDAAiDA,6DAGjDA,gCAA4CA,gEAAiBA,uBAAc,GAA2HA,gCAAzHA,uCAAgC,2BAAhCA,CAAgC,uFAG/GA,8BAQEA,gEAAgBA,uBAAmB,EAAnCA,CAAoC,uDACvBA,oBAAgB,EAD7BA,CAAoC,wDAErBA,iCAAwB,EAFvCA,CAAoC,yDAGpBA,2BAAkB,EAHlCA,CAAoC,wDAIrBA,0BAAiB,EAJhCA,CAAoC,0DAKnBA,4BAAmB,GAEtCA,gCAbEA,yBAAkB,sBAAlBA,CAAkB,0BAAlBA,CAAkB,gCAAlBA,CAAkB,wCAAlBA,CAAkB,kCAAlBA,CAAkB,6DAgBxBA,8CAAyCA,+TCEtC,MAAMoc,EAoJXtc,YACUuc,EACDC,EACAC,EACAhW,EACAiW,EACAC,EACAC,EACCC,EACAlV,EACAiS,EACAhS,EACAI,EACA3H,EACAE,EACAuc,GACA9J,GACAhP,GACAiP,GACD8J,GACCzc,GACAyH,GACD6T,GACAoB,GACCC,GACAC,GACAC,IAzBA3c,aACDA,sBACAA,mBACAA,oBACAA,oBACAA,yBACAA,2BACCA,oBACAA,gBACAA,kBACAA,mBACAA,kBACAA,2BACAA,qBACAA,sBACAA,aACAA,wBACAA,uBACDA,qBACCA,uBACAA,uBACDA,eACAA,qBACCA,2BACAA,mBACAA,yBA7KHA,yCAA0C,EAC1CA,gBAAqB,EACrBA,sBAA2B,EAC3BA,yBAA8B,EAC9BA,kCAAuC,gCACvCA,gCAAuD,IAAIC,KAAgB,GAC1ED,yBAAsC,GACrCA,wBAA+C,IAAIC,IAC1DD,KAAKF,eAAeiB,IAAI,sBAEnBf,wBAAiD,IAAIC,SAAgB,GACrED,oBAAgB,EAChBA,oBAAgB,EAGhBA,wBAAoB,EACpBA,yBAAqB,EACrBA,qBAAkB,IAAIC,SAAyB,GAK/CD,0BAAsB,EACtBA,oCAAyC,EAEzCA,8BAA0B,EAC1BA,sBAAgD,CACrD4c,SAAU,GACVC,gBAAiB,CAAC,EAAG,EAAG,GAAI,GAAI,GAAI,IAAK,MAEpC7c,wBAAqB,iBAErBA,gBAAaA,KAAKF,eAAeiB,IAAI,cAErCf,mBAAgB,IAAIC,SAAmC,GACvDD,mBAAgB,GAChBA,uBAAoB,IAAIC,SAAyB,GACjDD,uBAAmB,EACnBA,kBAAe,IACfA,gCAA4B,EAC3BA,mBAAgC,GAEjCA,oBAAgB,EAEhBA,sBAAmB,IAAIE,KAAY,IAGlCF,oBAAgB,EASjBA,4BAAwB,EAOxBA,kBAAeA,KAAKob,OAAOG,cAAc,kCA0BzCvb,sBAA2B,qBAC3BA,iBAAc8c,MACd9c,uBAA4B,GAgD5BA,qBAAiB,EACjBA,oBAAgB,EAChBA,iBAAa,EAIbA,yBAAsBA,KAAKwD,gBAAgBmB,UAAUC,QAAQ,eAuM3D5E,iBAAcA,KAAKyc,mBAC3BM,QAAQ/c,KAAKgd,kBACblZ,QACCgB,MAAI,SAAQ,EACZmY,SA7KEjd,KAAKkd,eAA0D,IAA9Cld,KAAKD,cAAc8G,UAAU,cAC5C7G,KAAKD,cAAc8G,UAAU,aAC/B7G,KAAKmd,qBAAsE,IAApDnd,KAAKD,cAAc8G,UAAU,oBAClD7G,KAAKD,cAAc8G,UAAU,mBAC/B7G,KAAKod,mBAAkE,IAAlDpd,KAAKD,cAAc8G,UAAU,kBAChD7G,KAAKD,cAAc8G,UAAU,iBAC7B7G,KAAKuZ,mBAA4E,IAA5DvZ,KAAKD,cAAc8G,UAAU,4BAClD7G,KAAKD,cAAc8G,UAAU,2BAC/B7G,KAAKqd,yBACkD,IAArDrd,KAAKD,cAAc8G,UAAU,oBAC/B7G,KAAKsd,wBAA4E,IAAvDtd,KAAKD,cAAc8G,UAAU,uBACrD7G,KAAKD,cAAc8G,UAAU,sBAC/B7G,KAAKud,oCAAoG,IAAnEvd,KAAKD,cAAc8G,UAAU,mCACjE7G,KAAKD,cAAc8G,UAAU,kCAC/B7G,KAAK+Z,cAAgB/Z,KAAKD,cAAc8G,UAAU,qBAClD7G,KAAK0H,8BAAgC1H,KAAKD,cAAc8G,UAAU,iCAClE7G,KAAKqa,+BAAiCra,KAAKD,cAAc8G,UAAU,gCACvB,IAAxC7G,KAAKqa,iCACPra,KAAKqa,+BAAiCra,KAAKF,eAAeiB,IAAI,iCAA6C,GAE7Gf,KAAKgd,sBAAwE,IAArDhd,KAAKD,cAAc8G,UAAU,oBAAoC,uBACvF7G,KAAKD,cAAc8G,UAAU,oBAC/B7G,KAAKqd,yBAA2E,IAArDrd,KAAKD,cAAc8G,UAAU,oBACxD7G,KAAKsb,mBAAkE,IAAlDtb,KAAKD,cAAc8G,UAAU,kBAChD7G,KAAKD,cAAc8G,UAAU,gBACnC,CArLA2W,6BACE,OAAOxd,KAAKD,cAAc8G,UAAU,gBACtC,CA4CItF,UACF,OAAOvB,KAAKmH,SAAS5F,GACvB,CAEIkc,WACF,OAAOzd,KAAKD,cAAc8G,UAAU,SAAW,EACjD,CAEA6W,WACE,OAAO1d,KAAKiG,aAAac,aAAeqL,WAC1C,CAEAuL,WACE,OAAO3d,KAAKiG,aAAac,aAAeqL,WAC1C,CAEAwL,cACE,OAAO5d,KAAKiG,aAAa4X,mBAAqBzL,cAChD,CAEA0L,aACE,OAAO9d,KAAKiG,aAAa4X,mBAAqBzL,aAChD,CAMI2L,oBACF,OAEE/d,KAAK8a,cAET,CAEIkD,6BACF,OAAOhe,KAAKgc,eAAeiC,sBAC7B,CACID,2BAAuB7a,GACzBnD,KAAKgc,eAAeiC,uBAAyB9a,EACzCA,EACFnD,KAAKuB,IAAIgI,eAAe2U,WAAW,CAACC,OAAQ,MAE5Cne,KAAKuB,IAAIgI,eAAe2U,WAAW,CAACC,OAAQ,GAEhD,CAEIC,gBACF,OAAOpe,KAAKgc,eAAeqC,WAAWlb,KACxC,CAEImb,oBACF,OAAOpe,YACT,CAEIqe,yBACF,OAAOve,KAAKse,gBAAkBpe,YAChC,CAEIsI,kBACF,OAAOxI,KAAKoH,YAAYlG,KAC1B,CAEIJ,mCACF,OAAOd,KAAKoH,YAAYpG,8BAA8BmC,KACxD,CAEIqb,qBACF,OAAOxe,KAAKgc,eAAe9a,KAC7B,CAEI6H,iBACF,OAAO/I,KAAKwH,WAAWtG,KACzB,CAgEA8H,WACEhJ,KAAKwc,aAAaiC,oBAAsB,EACxCzZ,OAAO0Z,IAAS1e,KAChBA,KAAKsd,wBAA4E,IAAvDtd,KAAKD,cAAc8G,UAAU,uBACrD7G,KAAKD,cAAc8G,UAAU,sBAE/B7G,KAAKuB,IAAI+L,GAAGqR,KAAK,iBAAkB,KACjC3e,KAAK4e,uBAC6D,IAA9D5e,KAAKD,cAAc8G,UAAU,+BAC/B7G,KAAKuB,IAAIkQ,sBAAsBoN,SAAW7e,KAAKD,cAAc8G,UAAU,6BAA2B,GAKtG7G,KAAKoH,YAAYmB,oBAAoBtH,KAAKjB,KAAKsI,cAE/CtI,KAAKic,YAAY6C,cAAc9a,UAAW+a,IACxC/e,KAAKgf,eAAgB,IAGvBhf,KAAK+b,MAAMkD,YAAYjb,UAAWkb,IAChClf,KAAKmf,kBAAkBD,EAAM,GAG/Blf,KAAKmG,UAAYnG,KAAKqc,aAAajW,SAASpC,UACzCqC,GAA6BrG,KAAKof,gBAAgB/Y,IAGrD,MAAMgZ,EAAiB,CAAC,CACtB7R,GAAI,cACJyE,MAAO,cACPqN,QAAS,IAAMtf,KAAKuf,iBAAiBvf,KAAKwf,mBAE5C,CACEhS,GAAI,aACJyE,MAAO,YACPqN,QAAS,IAAMtf,KAAKyf,eAAezf,KAAKwf,mBAE1C,CACEhS,GAAI,mBACJyE,MAAO,mBACPqN,QAAS,IAAMtf,KAAK0f,qBAAqB1f,KAAKwf,oBAGhDxf,KAAK2f,iBAAiBC,KAAKP,GAE3Brf,KAAKoH,YAAYnE,gBAAgBe,UAAWhB,IACtCA,GAAUhD,KAAK0d,YACjB1d,KAAK6f,aAAW,GAIpB7f,KAAKkJ,aAAelJ,KAAKoH,YAAY1E,YAAYoB,QAAKC,MAAK,IAAIC,UAAWvB,IACzB,MAAfA,GAC9BzC,KAAK2c,iBAAiBmD,YAAYrd,EAAYzC,KAAKoH,YAAYlG,MAAM6e,MAAK,GAI9E/f,KAAKwc,aAAaiC,oBAAsB,EAExCze,KAAK+I,WAAWuF,UACftK,UACEqU,IACGA,EAAS3I,OAAS,GACpB1P,KAAKggB,kBAAgB,GAIzBhgB,KAAKigB,YAAYjc,UAAU,IAC3BhE,KAAKkgB,oBAEP,CAEAC,qBACEngB,KAAKuB,IAAIgI,eAAe6W,iBAC1B,CAEAC,qBACOrgB,KAAKsgB,qBACRtgB,KAAKsgB,oBAAqB,EAE9B,CAEAzE,eACM7b,KAAKsb,eAAiBtb,KAAKgW,OACxBhW,KAAK6I,mBAaR7I,KAAKwb,oBAAsBxb,KAAKwD,gBAAgBmB,UAAUC,QAAQ,eAClE5E,KAAK8Y,qBAbL9Y,KAAKwb,oBAAsBxb,KAAKwD,gBAAgBmB,UAAUC,QAAQ,gBAClE5E,KAAKugB,kBACDvgB,KAAK2I,aACP3I,KAAKsY,cACLtY,KAAKwgB,cAEHxgB,KAAKyI,gBACPzI,KAAKygB,eACLzgB,KAAKyI,eAAgB,EACrBzI,KAAKwgB,eAQJxgB,KAAKsgB,qBACRtgB,KAAKsgB,oBAAqB,EAGhC,CAEAzI,YAAY5J,GACVjO,KAAK8a,eAAiB7M,CACxB,CAEAmF,SAASnF,GACPjO,KAAKyI,cAAgBwF,CACvB,CAEA6K,mBACE9Y,KAAK6I,mBAAoB,EACzB7I,KAAK6f,cACL7f,KAAKuB,IAAImX,gBAAgB/R,WAC3B,CAEA4Z,kBACEvgB,KAAK6I,mBAAoB,EACzB7I,KAAKwgB,aACLxgB,KAAKuB,IAAImX,gBAAgB1U,UAAU,KACjChE,KAAKia,uBAAyBja,KAAKuB,IAAI4W,OAAO/N,OAAOwO,IACzB,IAA1BA,EAAMsB,gBACP,EAEL,CAEOgG,oBACFlgB,KAAKyc,mBAAmBiE,UAAU,uBACnC1gB,KAAK2gB,kBAAoB3gB,KAAKgd,iBAC9Bhd,KAAKgW,QAAS,GAEdhW,KAAKgW,QAAS,CAElB,CAkEA4K,wBAAwBhI,GACtB,IAAIzF,EAAa,GACjB,SAAM0N,QAAQC,cAAcC,aAAazL,QAAQC,KAC1CA,EAAMyL,SAAWzL,EAAM0L,UAC1B9N,EAAWoC,EAAMnJ,MAAQ,MAGtB+G,CACT,CAEA+N,mBACElhB,KAAKmhB,2BAA2BlgB,MAAK,EACvC,CAEAyF,oBACE1G,KAAKmG,UAAUQ,cACf3G,KAAKohB,oBAAoB7f,IAAI8f,GAAKA,EAAE1a,eACvB,QAAbiE,OAAK0W,gBAAQ,SAAE3a,cACf3G,KAAKkJ,aAAavC,aACpB,CAEQ4a,uBACN,OAAOvhB,KAAKH,oBACT2hB,aACAvQ,KACEwQ,GACCA,aAAwBnX,MAEhC,CAEQoX,0BAA0B7Z,GAChC,GAAI7H,KAAKoe,UAAW,CAClB,MAAMxW,EAAeC,EAAQhG,KAAK8f,YAElC,OADiB3hB,KAAKoe,UAAUnM,QACfrK,EAMnB,OAAO,CACT,CAEQga,+BACN,GAAG5hB,KAAKoe,UAAW,CACjB,MAAMyD,EAAY7hB,KAAKoe,UACvB,GAAGyD,EAAUC,QAAUD,EAAUE,mBAAmB5e,OAASnD,KAAKgc,eAAeiC,uBAC/E,OAAO,EAGX,OAAO,CACR,CAED+D,WAAW/T,GACNjO,KAAKD,cAAc8G,UAAU,kBAC9BoH,EAAMmJ,SAAW,CAACnJ,EAAMmJ,SAAS,IACjCpX,KAAKuB,IAAI2I,oBAAoB4D,SAED9N,KAAKuhB,uBAAnC,MACMU,EAA8C,GACpD,GAAIhU,EAAMmJ,SAAS1H,OAAQ,CACrB1P,KAAK2I,YAAa3I,KAAKsY,cAC3BtY,KAAKkiB,mBAAmB,IACpBliB,KAAKyI,eACPzI,KAAKygB,eAEPzgB,KAAKggB,mBAuBL,MAAMmC,EAtBUlU,EAAMmJ,SAAS7V,IAAKsG,IAClC,IAAIua,EAAoBH,EAAuBhR,KAC5CoR,GAAMA,EAAEpQ,QAAUpK,EAAQhG,KAAK8f,aAElC,IAAI3hB,KAAK0hB,0BAA0B7Z,KAC7B7H,KAAK4hB,gCAAoC5hB,KAAKoe,UAA2BkE,4BAI/E,OAAIF,IACFpiB,KAAKygB,eACLzgB,KAAKggB,mBACLhgB,KAAKyI,eAAgB,GAElB2Z,IACHA,EAAoB,IAAI9X,MAAkB,CACxC2H,MAAOpK,EAAQhG,KAAK8f,cAEtBM,EAAuBhb,KAAKmb,KAAiB,EAEtC9X,OAAsBzC,EAASua,EAAiB,GAE3BhY,OAAO4B,QAAW,IAANA,IAE1C,EAASuW,OAAGJ,GAIGne,UAAWwe,IAC1BxiB,KAAK+I,WAAW6W,KAAK4C,EAAY,QAGnCxiB,KAAKyI,eAAgB,GAChBzI,KAAK2I,aAAe3I,KAAK6I,oBAAsB7I,KAAKgW,SACvDhW,KAAK8a,gBAAiB,IAEnB9a,KAAK2I,YAAc3I,KAAKgW,SAC3BhW,KAAK8a,gBAAiB,EAG5B,CAKS2H,wBACPziB,KAAK0iB,cAAcpN,QAASqN,GAAsBA,EAAIhc,eACtD3G,KAAK0iB,cAAgB,EACvB,CAEAE,kBACE5iB,KAAK6f,cACL7f,KAAKyI,eAAgB,CACvB,CAEA6R,mBAAmBnR,SAQjB,GAPGnJ,KAAKgW,SAAShW,KAAK8a,gBAAiB,IACnB,QAAhBlQ,OAAKiY,mBAAW,eAAEC,SAAU3Z,IAASnJ,KAAK6iB,YAAYC,QACxD9iB,KAAKoH,YAAYjF,qCAGnBnC,KAAKoH,YAAY5E,cAAc2G,GACJA,EAAKsK,QAAQ,aAAc,IAAI+G,OACnC9K,OAAS,EAG9B,OAFG1P,KAAKgW,SAAShW,KAAK8a,gBAAiB,QACvC9a,KAAKsY,cAGPtY,KAAK+iB,gBACP,CAEAb,mBAAmBjU,GACjBjO,KAAKgjB,UAAUC,QAAQ,GACzB,CAEAjV,SAASC,GACPjO,KAAK2I,YAAa,EAClB3I,KAAK6I,mBAAoB,EACzB7I,KAAK8a,gBAAiB,EAClB9a,KAAKyI,gBACPzI,KAAKygB,eACLzgB,KAAKyI,eAAgB,EACrBzI,KAAK8a,gBAAiB,GAExB,MAAM3M,EAAUF,EAAME,QAEhB+U,IAAkB,EAAC5Y,OAAgB2D,EAAMM,SAAS/M,QAExD,IAAI2hB,EAEFA,EADED,EACeljB,KAAKH,oBACnByB,oBACA8I,OAAOE,OAEOtK,KAAKH,oBACnByB,oBACA8I,OAAOE,OAGZ,MAAM+D,EAAarO,KAAKwI,YAAY8F,UAAUnL,MAC3CiH,OACEpH,GACCA,EAAOxB,SAAWyM,EAAMM,SAAS/M,QACjC2hB,EAAenc,SAAShE,EAAOxB,SAElCgN,OAAOL,GACVnO,KAAKwI,YAAYiG,WAAWJ,EAC9B,CAEQwR,eACD7f,KAAKyI,gBAAkBzI,KAAK2I,aAAe3I,KAAK6I,oBACnD7I,KAAK8a,gBAAiB,EAE1B,CAEQ0F,aACNxgB,KAAK8a,gBAAiB,CACxB,CAEQsI,wBAAwB/c,WACR,QAAlBqG,EAAY,QAAZ9B,EAAO,MAAPvE,OAAO,EAAPA,EAAS9E,WAAG,eAAE8hB,YAAI,SAAEC,YACtBtjB,KAAKsjB,WAAajd,EAAQ9E,IAAI8hB,KAAKC,WAAWvX,OAC9C/L,KAAKujB,WAAald,EAAQ9E,IAAI8hB,KAAKC,WAAWE,OAC9CxjB,KAAKyjB,SAAWpd,EAAQ9E,IAAI8hB,KAAKC,WAAWI,OAE5C1jB,KAAKsjB,gBAAa,EAClBtjB,KAAKujB,gBAAa,EAClBvjB,KAAKyjB,cAAW,EAGpB,CAEQrE,gBAAgB/Y,GACtBrG,KAAKyiB,6BACW,IAAZpc,IAGArG,KAAKoe,YAAcpe,KAAKoe,UAAUuF,YAAYzY,OAChDlL,KAAKoe,UAAUuF,YAAY7V,QAExB9N,KAAKwH,WAAWtG,MAAMgK,OACzBlL,KAAKwH,WAAWtG,MAAMgN,YAGxBlO,KAAKojB,wBAAwB/c,GAC7BrG,KAAK+b,MAAMkD,YAAYnb,QAAKmH,KAAa,MAAMjH,UAAW4f,MACnDA,EAAQvd,SAAcud,EAAQvd,UAAeA,EAAQwd,MACxD7jB,KAAK8jB,sBAAsBF,EAAO,GAItC5jB,KAAKgf,eAAgB,EACvB,CAEQ+D,iBACN/iB,KAAKwgB,YACP,CAEAlI,cACEtY,KAAKuB,IAAIuL,qBAAqBgB,QAC9B9N,KAAKwI,YAAYsF,QACjB9N,KAAKoH,YAAYrE,uBAAkB,GACnC/C,KAAKoH,YAAYjF,qCACjBnC,KAAK2I,YAAa,EAClB3I,KAAK+jB,cAAgB,GACrB/jB,KAAKoH,YAAY5E,cAAc,GACjC,CAEA+V,yBACEvY,KAAKyI,eAAgB,GACjBzI,KAAK2I,YAAc3I,KAAK6I,oBAC1B7I,KAAKwgB,YAET,CAEAR,mBACEhgB,KAAKyI,eAAgB,EACrBzI,KAAKwgB,WACLxgB,KAAK6I,mBAAoB,EACzB7I,KAAKsY,aACP,CAEAmI,eACEzgB,KAAKwH,WAAWtG,MAAM4M,QACtB9N,KAAKwH,WAAWtG,MAAMgN,YACtBlO,KAAKuB,IAAI2I,oBAAoB4D,OAC/B,CAEAyJ,SAASvU,GACP,SAAO9C,MAAe8C,EACxB,CAEAghB,kBAAkB/V,GAChBjO,KAAKwf,iBAAmBxf,KAAKikB,mBAAmBhW,EAClD,CAEQgW,mBAAmBhW,GACzB,MAAMiW,EAAmBjW,EACnBkW,EAAqBnkB,KAAKokB,WAAWzV,cAAc0V,wBACzDH,EAAiBjY,EACfiY,EAAiBjY,EACjBkY,EAAmBG,KAClBtf,OAAOuf,SAAWvf,OAAOwf,aAC5BN,EAAiBlY,EACfkY,EAAiBlY,EACjBmY,EAAmBM,MAClBzf,OAAO0f,SAAW1f,OAAO2f,aAC5B,MAAMC,EAAQ,CAACV,EAAiBlY,EAAGkY,EAAiBjY,GAE9CkF,EAAQnR,KAAKuB,IAAI+L,GAAGuX,uBAAuBD,GAC3CE,EAAO9kB,KAAKuB,IAAIiK,WACtB,OAAOqG,MAAiBV,EAAO2T,EAAM,YACvC,CAEQrF,eAAetO,GACrBnM,OAAOH,KAAKyF,6BAAmC6G,EAAM,GAAIA,EAAM,IACjE,CAEQuO,qBAAqBvO,GAC3BnM,OAAOH,KAAKyF,8BAAoC6G,EAAM,GAAIA,EAAM,IAClE,CAEAoO,iBAAiBpO,GACfnR,KAAK+jB,cAAgB5S,EAAM5P,IAAKwjB,GAAMA,EAAEC,QAAQ,IAAIlT,KAAK,KAC3D,CAEAsI,6BAA6BjX,GAC3BnD,KAAKF,eAAesD,IAAI,8BAA+BD,GACvDnD,KAAKqa,+BAAiClX,CACxC,CAEQyb,kBACN5e,KAAK+b,MAAMkD,YAAYjb,UAAWkb,IAChClf,KAAK6iB,YAAc3D,EACnBlf,KAAKilB,mBACLjlB,KAAKklB,iBACLllB,KAAKmlB,qBAAmB,EAE5B,CAEQhG,kBAAkBD,GACpBA,EAAOkG,OACTplB,KAAKic,YAAYoJ,eAAgB,EACjCrlB,KAAKwD,gBAAgB8hB,YAAYpG,EAAOkG,MAE5C,CAEQD,sBACN,GAAInlB,KAAK6iB,YAAY0C,WAAe,CAClC,MAAMC,EAAexlB,KAAK6iB,YAAY0C,WAAcE,MAAM,KACpDC,EAAW7T,MACf2T,EACA,YACAxlB,KAAKuB,IAAIiK,YAEXxL,KAAKuB,IAAIgI,eAAeoc,aAAaD,GAEzC,CAEAE,qBACE,OAAO5lB,KAAKge,uBACVhe,KAAK6lB,mBAAmB1iB,MAAQ,wCAA0C,8BAC1E,oBACJ,CAEQ2iB,oBACNvgB,WAAW,KACT,MAAMwgB,EAAkB5gB,SACrBoK,qBAAqB,2BACrByW,KAAK,GACJD,GACFA,EAAWE,OAAK,EAEjB,EACL,CAEQf,iBACN,GAA+B,MAA3BllB,KAAK6iB,YAAYqD,IAAiBlmB,KAAKmmB,iBAAkB,CAC3D,MAAMC,EAAapmB,KAAKwI,YAAYT,UAAU+B,OAC3ChG,QACCuiB,MAAWhO,GAAiC,IAApBA,EAAS3I,SAAY,EAC7CzE,KAAa,MAAI,EACjBqb,MAAK,IAENtiB,UAAWqU,IACV+N,EAAWzf,cACP0R,EAAS3I,SAAW1P,KAAKumB,4BAC3BvmB,KAAK8lB,oBACL9lB,KAAKumB,2BAA4B,KAI3C,CAEQtB,mBACN,GAAIjlB,KAAK6iB,YAAYC,OAAW,CAK9B,GAJA9iB,KAAKmmB,kBAAmB,EACe,MAAnCnmB,KAAK6iB,YAAY2D,YACnBxmB,KAAKoH,YAAYrF,mCAEf/B,KAAK6iB,YAAYC,SAAc9iB,KAAK6iB,YAAYa,MAAsC,MAA3B1jB,KAAK6iB,YAAYqD,GAAe,CAC7F,MAAME,EAAapmB,KAAKwI,YAAYT,UAAU+B,OAC3ChG,QACCuiB,MAAWhO,GAAiC,IAApBA,EAAS3I,SAAY,EAC7CzE,KAAa,MAAG,EAChBqb,MAAK,IAENtiB,UAAWqU,IACV+N,EAAWzf,cACX,MAAM8f,EAA0BpO,EAC7BjO,OAAOnC,GAAKA,EAAErG,OAAOC,KAAKwI,WAAaC,OACvC/I,IAAKK,IACJ,IAAI6F,MAAkB0I,YAAYvO,EAAOA,OAAOyG,KAAM,CACpD+H,eAAgBxO,EAAOA,OAAOyG,KAAKmD,WACnC6E,kBAAmBrQ,KAAKuB,IAAIiK,cAG5Bkb,KAAcpc,OAAwBtK,KAAKuB,IAAKklB,GACtDzmB,KAAKuB,IAAIgI,eAAeoc,aAAae,EAAW,GAGtD1mB,KAAK+jB,cAAgB/jB,KAAK6iB,YAAYC,OAED,MAAnC9iB,KAAK6iB,YAAY8D,YACnB3mB,KAAKoH,YAAYpG,8BAA8BC,MAAK,EAExD,CAEQ6iB,sBAAsB5E,GAC5Blf,KAAK4mB,4BAA4B1H,EAAQ,OACzClf,KAAK4mB,4BAA4B1H,EAAQ,QACzClf,KAAK4mB,4BAA4B1H,EAAQ,cACzClf,KAAK4mB,4BAA4B1H,EAAQ,mBACzClf,KAAK4mB,4BAA4B1H,EAAQ,kBACzClf,KAAK6mB,sBAAsB3H,EAC7B,CAEA4H,cAAc1a,EAAMgI,GAClB,IAAI2S,EACJ,OAAI3S,EAAIpN,SAAS,OAEf+f,EADmB,IAAIvU,MAAW,CAAEwU,WAAY5S,EAAIqR,MAAM,KAAK,KACvC1kB,IAAIqL,IAEvB2a,CACT,CAEQH,4BAA4B1H,EAAgBzd,GAClD,IAAIwlB,EACAC,EACJ,OAAQzlB,OACD,OACEyd,EAAO/G,QAAa+G,EAAOiI,YAAiBjI,EAAOkI,SACtDF,EAAU,SACVD,EAAqB/H,EAAOiI,UAAe,YAAc,UAE3D,UACG,OACCjI,EAAOmI,YAAiBnI,EAAOoI,UACjCJ,EAAU,UACVD,EAAqB,cAEvB,UACG,aACC/H,EAAOqI,cAAmBrI,EAAOsI,YACnCN,EAAU,YACVD,EAAqB,gBAEvB,UACG,kBACC/H,EAAOuI,eAAoBvI,EAAOwI,aACpCR,EAAU,aACVD,EAAqB,iBAEvB,UACG,iBACC/H,EAAOyI,eAAoBzI,EAAO0I,aACpCV,EAAU,aACVD,EAAqB,iBAI3B,IAAKA,IAAuBC,EAC1B,OAEF,MAAMW,EAAkB3I,EAAO+H,GAAoBxB,MAAM,OACnDqC,EAAO5I,EAAOgI,GAASzB,MAAM,KAEnC,IAAIsC,EAAM,EACVD,EAAKxS,QAAS0S,IACZ,IAAI5T,EAAM4T,EACV,MAAMtiB,EACJ1F,KAAK8mB,cAAc,UAAW1S,IAC9BpU,KAAK8mB,cAAc,UAAW1S,SAC9B,EACE1O,IACF0O,EAAMA,EAAIX,QAAQ,WAAa/N,EAAS,IAAI+N,QAAQ,WAAa/N,EAAS,KAG7C1F,KAAKioB,uBAClCJ,EAAgBE,IAEKzS,QAASsD,IAC9B,MAAMsP,EAAetP,EAAM6M,MAAM,SAC3B0C,EAAetS,sBAA4B,CAC/CpU,OACA2S,IAAKA,EACLwE,MAAOsP,EAAa,GACpBhJ,OAAiB,QAATzd,EAAiB,CAAE2mB,OAAQF,EAAa,SAAO,IAEnD1a,MAAKlD,OAA4B6d,GACjCE,GAAaroB,KAAKsoB,8BAA8BpJ,EAAQ1R,IAC9DxN,KAAKuoB,gBACHnU,EACA8T,EAAa,GACbzmB,EACAiE,EACA2iB,GACAH,EAAa,GAAKM,SAASN,EAAa,GAAI,SAAM,EAAS,GAG/DH,GAAO,GAEX,CAEQlB,sBAAsB3H,GAC5B,GAAIA,EAAOuJ,OAAW,CACpB,MAAMrU,EAAM8K,EAAOuJ,OACbC,EAAYtU,EAAIuU,YAAY,KAC5BC,EAAWxU,EAAIyU,MAAMH,EAAY,EAAGtU,EAAI1E,QAE9C1P,KAAKwS,KAAKzR,IAAI,GAAGqT,IAAO,CAAEG,aAAc,SAAUvQ,UAAWqE,IAC3D,MAAMygB,EAAO,IAAIC,KAAK,CAAC1gB,GAAOugB,EAAU,CACtCnnB,KAAM4G,EAAK5G,KACXunB,aAAcC,KAAKC,QAErBlpB,KAAKsc,cAAc6M,OAAOL,GAAM9kB,UAC7BoT,GAAwBpX,KAAKopB,oBAAoBN,EAAM1R,GACvD7S,GAAiBvE,KAAKqpB,kBAAkBP,EAAMvkB,GAAM,GAI7D,CAEQ6kB,oBAAoBN,EAAY1R,IACtC,SACE0R,EACA1R,EACApX,KAAKuB,IACLvB,KAAKqc,aAAajW,SAASjD,MAAM0gB,IACjC7jB,KAAKyS,eACLzS,KAAKkc,aAET,CAEQmN,kBAAkBP,EAAYvkB,IACpC,SACEukB,EACAvkB,EACAvE,KAAKyS,eAET,CAEQwV,uBAAuBJ,GAC7B,IAAIyB,EAAqBzB,EACzB,SAAqByB,EAAmBC,WAAW,KAC/CD,EAAmBE,OAAO,GAC1BF,EACJA,EAAqBA,EAAmBG,SAAS,KAC7CH,EAAmBT,MAAM,GAAG,GAC5BS,EACGA,EAAmB7D,MAAM,IAClC,CACQ8C,gBACNnU,EACAhI,EACA3K,EACAiE,EACA2iB,GAAsB,EACtBqB,GAEA,IAAK1pB,KAAKgf,cACR,OAEF,MAAM2K,EAAsB,CAC1BC,yBAAyB,EACzBC,gBAAgB,EAChBC,aAAa,EACbroB,OACA2S,OAEI2V,EAAyB,eAATtoB,GAAkC,oBAATA,GAAuC,mBAATA,EAC7E,IAAIqf,EAAgB,CAClBpb,QAAkB,SAATjE,EAAkB,aAAU,EACrCuoB,YAAWD,EACXE,YAAaF,EAAe,gBAAa,EACzCnR,MAAOxM,GAEI,QAAT3K,IACFqf,EAAgB,CAAE5B,OAAQ,CAAEkJ,OAAQhc,EAAM8d,QAASxkB,KAGrDob,EAAgBjL,sBAA4BnL,OAAOC,OAAO,GAAImW,EAAe6I,IAE7E3pB,KAAK0iB,cAAczb,KACjBjH,KAAKkc,aACFiO,iBAAiB,CAChBT,OAAQA,EACRzI,QAASoH,EACTvH,kBAED9c,UAAWomB,IACVpqB,KAAKuB,IAAI8oB,SAASD,EAAC,GAG3B,CAEQ9B,8BACNpJ,EACAoL,GAEA,MAAMrL,EAAcC,EACpB,IAAI+B,GAAU,EACd,IAAKhC,IAAgBqL,EACnB,OAAOrJ,EAET,IAAIsJ,EAAwB,GACxBC,EAAyB,GACzBC,EAA0B,GAC1BC,EAA4B,GAChC,OAAIzL,EAAYwL,gBACdF,EAAwBtL,EAAYwL,eAElCxL,EAAYyL,kBACdF,EAAyBvL,EAAYyL,iBAKT,MAA1BH,IACFtJ,GAAU,GAEmB,MAA3BuJ,IACFvJ,GAAU,GAIZwJ,EAAgBF,EAAsB9E,MAAM,KAC5CiF,EAAkBF,EAAuB/E,MAAM,MAC3CgF,EAAcE,QAAQL,IAAkB,GAAMG,EAAcE,QAAQL,EAAe9W,aAAc,KACnGyN,GAAU,IAERyJ,EAAgBC,QAAQL,IAAkB,GAAMI,EAAgBC,QAAQL,EAAe9W,aAAc,KACvGyN,GAAU,GAELA,CACT,wCAvgCWnF,GAAepc,sVAAfoc,EAAerc,sEAcOC,0iEDrHnCA,iCAAuB,0BAAvBA,CAAuB,oBAKjBA,gCAASqS,mBAAiB,GAC5BrS,QAEAA,yBA2CAA,+BAUEA,iCAASqS,eAAkB,EAA3BrS,CAA4B,kCAGZqS,sBAAyB,GAGzCrS,wBAEEA,qCAMAA,iBAEEA,yCACAA,8BAA+D,6BAE/DA,wCACFA,QAEAA,sCAgBJA,QAEAA,iCAEAA,8CAKFA,iBAxGIA,2BAIuBA,iCAkDvBA,4CAA+B,mBAA/BA,CAA+B,0BAA/BA,CAA+B,YAA/BA,CAA+B,mEASzBA,gCAGFA,2FAAiH,YAAjHA,CAAiH,gDAMnHA,6DACyBA,4CACNA,4BACIA,oEAAmD,aACpDA,yCAInBA,gCAiBMA,8CAGbA,kiPCRU,CCvCP,SAASkrB,KACd,MAAO,IACLC,MAAQ,kBAAmB,IACzBA,MAAM,WAASA,MAAM,MAAG,EACxBA,MACE,wBACAA,MAAM,CACJ1M,OAAQ,UACR,EAEJ0M,MACE,iCACAA,MAAM,CACJ1M,OAAQ,UACR,EAEJ0M,MACE,2CACAA,MAAM,CACJ1M,OAAQ,YACR,EAEJ0M,MACE,yBACAA,MAAM,CACJ1M,OAAQ,WACR,EAEJ0M,MACE,wBACAA,MAAM,CACJ1M,OAAQ,YACR,EAEJ0M,MACE,MACAA,MAAM,CACJ1M,OAAQ,kBACR,EAEJ0M,MACE,kCACAA,MAAM,CACJ1M,OAAQ,yBACR,EAEJ0M,MACE,iCACAA,MAAM,CACJ1M,OAAQ,0BACR,EAEJ0M,MAAW,YAAUA,MAAQ,YAGnC,CDfID,GCtFG,SAASE,KACd,SAAOD,MAAQ,gBAAiB,IAC9BA,MACE,UACAA,MAAM,CACJpG,KAAM,WACN,EAEJoG,MACE,WACAA,MAAM,CACJpG,KAAM,YACN,EAEJoG,MAAW,YAAUA,MAAQ,WAEjC,CDuEIC,GCrEG,SAASC,KACd,SAAOF,MAAQ,gBAAiB,IAC9BA,MAAM,WAASA,MAAM,MAAG,EACxBA,MACE,wBACAA,MAAM,CACJ1M,OAAQ,MACR,cAAe,UACf,EAEJ0M,MACE,iCACAA,MAAM,CACJ1M,OAAQ,QACR,cAAe,YACf,EAEJ0M,MACE,2CACAA,MAAM,CACJ1M,OAAQ,QACR,cAAe,YACf,EAEJ0M,MAAW,YAAUA,MAAQ,WAEjC,CD4CIE,OE3FG,MAAMC,GAGXxrB,YAAoBO,wBAFbC,gBAAY,EAIjBA,KAAKirB,eAAiE,IAArDjrB,KAAKD,cAAc8G,UAAU,qBAC5C7G,KAAKD,cAAc8G,UAAU,mBAChC,yCAPUmkB,IAAYtrB,uCAAZsrB,GAAYvrB,0FCRzBC,6BACIA,6iBCMJ,MAAMwrB,GAAiB,CACnB,CAAEC,KAAM,GAAIC,UAAW7rB,IACvB,CAAE4rB,KAAM,QAASC,UAAWJ,IAC5B,CAAEG,KAAM,iBAAkBC,UAAWzrB,KAWhC,MAAM0rB,2CAAiB,0BAAjBA,gCANDC,aAAqBJ,GAAQ,CACrCK,oBAAqB,SACrBC,uBAAwB,WAEhBF,QCEP,MAAMG,2CAAY,0BAAZA,gCATTC,KACAtZ,KACAuZ,MACAN,KCEG,MAAMO,2CAAY,0BAAZA,gCAPTF,KACAtZ,QCaG,MAAMyZ,2CAAkB,0BAAlBA,gCAZT3Z,KACAkJ,KACA9Q,MACAA,MACAwhB,KACAC,KACA3Z,QCOG,MAAM4Z,2CAAkB,0BAAlBA,gCAXTN,KACAxZ,KACA4Z,KACAxhB,MAAcA,MACdyhB,KACA3Z,KACAgJ,KACAyQ,KCRG,MAAMI,2CAAgB,0BAAhBA,gCALTP,wBCgCG,MAAMQ,2CAA6B,0BAA7BA,gCAjBTR,KACAxZ,KACAia,KACAJ,KACAD,KACA1Z,KACA9H,MACAA,MACApK,KACAA,KACAoK,MACApK,wBCAG,MAAMksB,2CAAuB,0BAAvBA,gCAjBTV,KACAxZ,KACAE,KACAlS,KACAorB,KACAprB,KACA6rB,QCNG,MAAMM,2CAAgB,0BAAhBA,gCATTX,KAGAU,EACA9hB,SCaG,MAAMgiB,2CAAoB,0BAApBA,gCAZTZ,KACAxZ,KACA4Z,KACAC,KACA3Z,KACAlS,KACAmsB,EACA/hB,SC8CG,MAAMiiB,2CAAe,0BAAfA,gCA/BTb,KACAxZ,KACA4Z,KACAU,MACAT,KACA3Z,KACAlS,KACAA,KACAusB,KACAvsB,KAEAwsB,MACAta,KACA9H,MACAA,MACApK,KACAA,KACAiS,KACA7H,gBACA4hB,EACAS,MACAL,EACAD,EACAD,EACA9hB,MACAA,SCyBG,MAAMsiB,2CAAY,0BAAZA,gCAtCTlB,KACAK,KACAD,KACA5Z,KACAE,KACA9H,MACAA,MACApK,KACAA,KACAiS,KACAsa,KACAb,EACAthB,MACApK,KACAoK,MACAA,gBACAA,gBACAmiB,KACArR,KACAlb,KACAoK,MACA2hB,EACAM,EACArsB,KACAA,KACAA,KACAA,KACAA,KACAA,KACA2rB,EACAW,MACAra,KACA7H,MACA0hB,KCjDG,MAAMa,2CAAU,0BAAVA,gCAZTnB,KACAL,EACAuB,EACAnB,EACAG,EACAD,MAIAN,KCAG,MAAMyB,GAA2B,CACtCC,YAAY,EACZC,IAAK,CACHC,IAAK,CACHlT,eAAe,EACfmT,QAAS,CACPC,SAAS,EACTC,SAAS,EACTC,aAAc,+BAEhBC,IAAK,CACHH,SAAS,IAGbI,SAAU,CACRC,OAAQ,CAAC,cAEXC,cAAe,CACbC,UAAW,CACTC,WAAW,GAEbC,cAAe,CACbT,SAAS,EACTQ,WAAW,GAEbE,SAAU,CACRC,UAAW,8CACXC,MAAO,EACP7O,OAAQ,CACN8O,MAAO,MAGXC,mBAAoB,CAClBC,sBAAsB,GAExBC,gBAAiB,CACfD,sBAAsB,EACtBJ,UAAW,6CACXC,MAAO,EACPZ,SAAS,GAEXiB,OAAQ,CACNN,UAAW,qDACXC,MAAO,EACP7O,OAAQ,CACN8O,MAAO,OAIbK,YAAa,CACX,CACEC,KAAM,aACNnZ,MAAO,iBACPoZ,IACE,qIAEFxiB,OAAQ,EAAC,OAAS,MAAO,SAAU,YAErC,CACEuiB,KAAM,YACNnZ,MAAO,cACPoZ,IACE,wIAEFxiB,OAAQ,CAAC,WAAY,YAAa,aAAc,gBAGpD5L,mBAAoB,CAClB0K,KAAM,CACJzK,YAAa,UACbC,cAAe,GACfC,mBAAoB,UACpBC,UAAW,UACXC,YAAa,GACbC,YAAa,UACbC,cAAe,GACfC,YAAa,GAEf8L,MAAO,CACLrM,YAAa,UACbC,cAAe,EACfC,mBAAoB,UACpBC,UAAW,UACXC,YAAa,GACbC,YAAa,UACbC,cAAe,EACfC,YAAa,GAEfiM,UAAW,CACTxM,YAAa,UACbC,cAAe,EACfC,mBAAoB,UACpBC,UAAW,UACXC,YAAa,GACbC,YAAa,UACbC,cAAe,EACfC,YAAa,IAGjB2W,kBAAmB,CACjBzM,KAAM,CACJzK,YAAa,UACbC,cAAe,GACfC,mBAAoB,UACpBC,UAAW,UACXC,YAAa,GACbC,YAAa,UACbC,cAAe,GACfC,YAAa,GAEf8L,MAAO,CACLrM,YAAa,UACbC,cAAe,EACfC,mBAAoB,UACpBC,UAAW,UACXC,YAAa,GACbC,YAAa,UACbC,cAAe,EACfC,YAAa,GAEfiM,UAAW,CACTxM,YAAa,UACbC,cAAe,EACfC,mBAAoB,UACpBC,UAAW,UACXC,YAAa,GACbC,YAAa,UACbC,cAAe,EACfC,YAAa,MCpJd,MAAM6tB,GAKXhvB,YACUO,EACEyD,GADFxD,qBACEA,uBACRA,KAAKyuB,eACP,CAEFA,gBACEzuB,KAAK0uB,WAAa1uB,KAAKD,cAAc8G,UAAU,eAC/C7G,KAAK2uB,gBAAkB3uB,KAAKD,cAAc8G,UAAU,mBACtD,yCAdW2nB,IAAe9uB,mDAAf8uB,GAAe/uB,6tBCR5BC,yBAA0D,UAA1DA,CAA0D,UAA1DA,CAA0D,UAA1DA,CAA0D,SAKtCA,iBAEJA,QACZA,iBACAA,eAAsEA,8BAA8BA,UAErGA,kBAAkE,UAAlEA,CAAkE,QAAlEA,CAAkE,iCAGwEA,gCAAkCA,cAG5KA,iBAAmE,QAAGA,gCAA8BA,uBAZlDA,yCAGVA,8CAC+BA,0CAKMA,+DAA6DA,gDAGpEA,mqICVlE,MAAMkvB,GAGXpvB,cAFOQ,WAAQ,QAEC,yCAHL4uB,GAAa,2BAAbA,GAAanvB,goBCP1BC,yBAAuD,UAAvDA,CAAuD,UAAvDA,CAAuD,SAG8BA,kBAACA,QAChFA,iBAAkC,SACuFA,mBAAOA,QAC5HA,eAAkEA,iBAAKA,QACvEA,gBAA2FA,2BAAcA,UAE7GA,gBAAgGA,mBAACA,cAIvGA,iCARsFA,i4DCHtFA,mDAEAA,6CAEAA,6CAA6BA,0DCStB,MAAMmvB,GAWXrvB,YACYgE,EACFzD,EACA+uB,EACAC,EACAC,EACAvc,EACAiK,GANE1c,uBACFA,qBACAA,gBACAA,oBACAA,mBACAA,sBACAA,kBAhBFA,gBAAa,aACdA,gBAAqB,EACrBA,gBAAqB,EAErBA,cAAmB,EAcxBA,KAAKivB,kBACLjvB,KAAKkvB,kBACLlvB,KAAKmvB,wBAELnvB,KAAKovB,mBAELpvB,KAAKirB,eAAiE,IAArDjrB,KAAKD,cAAc8G,UAAU,qBAC5C7G,KAAKD,cAAc8G,UAAU,oBAE/B7G,KAAKkd,eAA0D,IAA9Cld,KAAKD,cAAc8G,UAAU,cAC5C7G,KAAKD,cAAc8G,UAAU,aAE/B7G,KAAKqvB,aAAsD,IAA5CrvB,KAAKD,cAAc8G,UAAU,YAC1C7G,KAAKD,cAAc8G,UAAU,WAE/B7G,KAAKsvB,cACLtvB,KAAKuvB,gBACLvvB,KAAK0c,WAAW9Y,iBAClB,CAEQqrB,kBACNjvB,KAAKwD,gBAAgBmB,UAAU5D,IAAIf,KAAKD,cAAc8G,UAAU,UAAU7C,UAAUiO,IAC9EA,IACFjS,KAAK+uB,aAAaS,SAASvd,GAC3BjS,KAAKgvB,YAAYS,OAAO,CAAErjB,KAAM,QAASsjB,QAASzd,IAAO,EAG/D,CAEQqd,oBACN,MAAMK,EAAY3vB,KAAKD,cAAc8G,UAAU,OAC/C,GAAsB,QAAlB+D,EAAS,MAAT+kB,OAAS,EAATA,EAAWzC,eAAO,SAAEC,QAAS,CAC/B,MAAME,EAAesC,EAAUzC,QAAQG,cAAgB,uBACvDloB,SAASyJ,cAAc,wBAAwBghB,aAAa,OAAQvC,GAExE,CAEQkC,wBACN,MAAMI,EAAY3vB,KAAKD,cAAc8G,UAAU,QACzB,QAAlB+D,EAAS,MAAT+kB,OAAS,EAATA,EAAWzC,eAAO,eAAEC,WAA6B,QAAlBzgB,EAAS,MAATijB,OAAS,EAATA,EAAWzC,eAAO,eAAEE,UACvB,QAA1BvX,mBACF7Q,OAAO6qB,iBAAiB,sBAAwB5hB,IAC9CA,EAAM6hB,iBACN9vB,KAAK+vB,YAAc9hB,EACnBjJ,OAAO6qB,iBAAiB,QAAS,KAC/BtqB,WAAW,KACTvF,KAAK+vB,YAAYC,SACjBhwB,KAAK+vB,iBAAc,GAClB,IAAG,EACL,CAAEpR,MAAM,GAAM,EAChB,CAAEA,MAAM,GAGjB,CAEQuQ,kBACN,MAAMe,EAAQjwB,KAAKD,cAAc8G,UAAU,UAAY7G,KAAKkwB,WACxDD,GACFjwB,KAAK8uB,SAASqB,SAAShrB,SAASirB,KAAMH,EAE1C,CAEQd,wBACN,MAAMkB,EAAcrwB,KAAKD,cAAc8G,UAAU,eAC7CwpB,GACFrwB,KAAKgvB,YAAYS,OAAO,CAAErjB,KAAM,cAAesjB,QAASW,GAE5D,CAEQjB,mBACavZ,gBAAoB,CACrCya,GAAI,OACJC,OAAQ,MACRC,QAAS,MACTC,OAAQ,UAIRzwB,KAAKyS,eAAenN,MAAM,qBAAsB,mBAAoB,CAClEorB,QAAS,MAGf,yCAtGW7B,IAAYnvB,6GAAZmvB,GAAYpvB,mEAQSC,yMDvBlCA,yBAEAA,+BAEAA,6BAEAA,sCAJaA,mCAEFA,iCAEEA,msBEmGN,MAAMixB,8CAAS,2BAATA,GAASC,WAFR/B,oCAlCD,IACTzc,MAAqB,CACnBye,QAAS/D,OACT3B,KAAM,0BACP,EACD7gB,UAAqC,EACrCA,UAA2B,EAC3BA,UAA4B,EAC5BA,UAAkC,EAClCA,UAAyB,EACzBA,UAA2B,EAC3BA,SACAA,SACAA,UAA8C,EAC9CA,UAA2C,EAC3CA,SACAA,MACAA,SACAA,OAAwB,CACtB6gB,KAAM,6BAER/Y,QACA9H,SACA,CACEwmB,QAASpxB,MACTqxB,WAaN,SAASC,GACPC,EACAC,GAGA,MAAO,IAAM,IAAIC,QAAcC,IAC7BF,EAAeG,SAASvtB,QACtBwtB,MAAMD,IAAyB,IAAbA,IAAiB,EACnCE,MAAU,KACR,MAAM/tB,EAAkBytB,EAASlwB,IAAIqR,MAC/BgT,EAAO5hB,EAAgBguB,cAC7B,OAAOhuB,EAAgBmB,UAAU8sB,eAAerM,EAAI,IAErDphB,UAAW0tB,IACV,MAAMluB,EAAkBytB,EAASlwB,IAAIqR,MAC/BgT,EAAO5hB,EAAgBguB,cAC7BhuB,EAAgBmB,UAAUgtB,eAAevM,EAAMsM,GAC/CN,GAAO,EACR,EAEP,EAhCMQ,KAAM,CAAClyB,MAAUA,OACjBmyB,OAAO,MAETvnB,OAAwB,CACtB6gB,KAAM,6BAER,CAAE2F,QAAS/E,KAA6B+F,SA3DmB,CAC7DC,UAAW,IACXC,UAAW,EACXC,kBAAmB,EACnBC,6BAA6B,KAwD5BC,SAlDCC,KACAC,KACA/G,aAAqB,IACrBlZ,eACAA,KACAlS,KACAA,KACA0sB,EACAwF,KACA3G,EACAG,EACAiB,EACAyF,eAA6B,iBAAkB,CAC7CnF,QAASL,uBACTyF,qBAAsB,uCC1DxBzF,kBACFptB,SAGF0yB,OACGI,gBAAgB7B,IAChB8B,MAAMnuB,GAAOF,QAAQC,IAAIC,GAAI,mBCdhC,OACA,aACA,gBACA,WACA,eACA,kBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,cACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,aACA,gBACA,YACA,eACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,gBACA,mBACA,gBACA,mBACA,eACA,kBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,cACA,iBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,mBACA,gBACA,WACA,cACA,aACA,gBACA,aACA,gBACA,YACA,eACA,mBACA,sBACA,kBACA,qBACA,aACA,gBACA,aACA,gBACA,WACA,cACA,aACA,gBACA,aACA,gBACA,gBACA,mBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,aACA,gBACA,iBACA,oBACA,gBACA,mBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,kBACA,qBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,cACA,iBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,gBACA,mBACA,cACA,iBACA,aACA,gBACA,cACA,iBACA,cACA,kBACA,qBACA,iBACA,gBACA,mBACA,aACA,gBACA,aACA,gBACA,aACA,kBACA,qBACA,gBACA,aACA,gBACA,mBACA,sBACA,aACA,gBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,oBAIA,cACA,WACA,WACA,CACA,cACA,cACA,8CACA,gCACA2D,CACA,CACA,WACA,CACAyqB,kBACA,qBACA,EACAA,YACAC,YACAD","names":["HomeComponent","constructor","selectors","core","AboutComponent","SearchState","searchSourceService","storageService","configService","this","BehaviorSubject","igo2_common","searchOverlayStyle","markerColor","markerOpacity","markerOutlineColor","fillColor","fillOpacity","strokeColor","strokeOpacity","strokeWidth","searchOverlayStyleSelection","searchOverlayStyleFocus","searchResultsGeometryEnabled","get","searchResultsGeometryEnabled$","next","store","addStrategy","createCustomFilterTermStrategy","searchTypes","getEnabledSources","map","source","type","filterClauseFunc","record","entity","meta","score","activateCustomFilterTermStrategy","strategy","getStrategyOfType","activate","deactivateCustomFilterTermStrategy","deactivate","enableSearch","searchDisabled$","disableSearch","setSearchTerm","searchTerm","searchTerm$","setSearchType","searchType","enableSourcesByType","searchType$","setSelectedResult","result","selectedResult$","setSearchResultsGeometryStatus","value","set","factory","PwaService","updates","languageService","confirmDialogService","isEnabled","handleVersionUpdates","checkForUpdates","interval","pipe","skip","subscribe","__awaiter","updateFound","checkForUpdate","console","log","err","error","modalUpdatePWA","confirmOpened","message","translate","instant","open","tap","confirm","window","navigator","onLine","document","location","reload","alert","setTimeout","versionUpdates","evt","version","hash","currentVersion","latestVersion","FooterComponent","MapOverlayComponent","contextService","mediaService","ngAfterViewInit","context$$","context$","context","handleContextChange","media$$","media$","media","ngOnDestroy","unsubscribe","mapOverlay","getConfig","overlay","getMedia","includes","push","SearchResultsToolComponent","mapState","searchState","elRef","toolState","directionState","queryState","GeoJSON","hasFeatureEmphasisOnSelection","addFeaturetoLayer","featureTitle","feature","feature$","stateView","firstBy$","e","state","focused","element","data","termSplitter","searchTermSplitter$","searchStore","mapQueryClick","_mapQueryClick","searchInit","_searchInit","legendPanelOpened","_legendPanelOpened","queryStore","ngOnInit","initialized","searchTerm$$","term","focusedOrResolution$$","combineLatest","focusedResult$","viewController","resolution$","bunch","buildResultEmphasis","selectedOrResolution$$","monitorResultOutOfView","showResultsGeometries$$","all$","searchResults","clearFeatureEmphasis","shownResultsGeometries","queryResultsOverlay","removeFeature","filter","dataType","igo2_geo","geometry","selected","style","Object","assign","_a","base","addFeature","debouncedEmpty$$","empty$","debounceTime","empty","debouncedEmpty$","isSelectedResultOutOfView$$","state$","selectedResult","selectedOlFeature","projection","selectedOlFeatureExtent","isSelectedResultOutOfView$","trigger","olGeometry","getGeometry","getExtent","extent","x","y","feature1","Feature","name","Point","abstractResult","computedStyle","zIndexOffset","focus","_b","_c","selection","setZIndex","searchResultsOverlay","abstractFocusedResult","abstractSelectedResult","shownResultsEmphasisGeometries","shownResult","getRoute$$","onResultFocus","dataSource","ol","getFeatureById","id","setStyle","featureSelected","emit","onResultUnfocus","onResultSelect","clear","tryAddFeatureToMap","onSearch","event","softClear","results","updateAll","newResults","entities$","research","concat","updateMany","igoList","nativeElement","querySelector","moreResults","request","getId","isScrolledIntoView","scrollTop","offsetTop","offsetHeight","clientHeight","computeElementRef","items","getElementsByTagName","selectedItem","i","length","className","adjustTopPanel","elemSource","elem","children","zoomToFeatureExtent","localOlFeature","format","readFeature","dataProjection","featureProjection","docViewTop","docViewBottom","elemTop","getRoute","stopsStore","clearStops","routingCoordLoaded","storeInitialized$","init","stop","all","find","position","coord","coordinates","point","es","text","update","geolocationController","position$","currentPos","currentCoord","ol_proj","join","ctx","__decorate","title","icon","igo2_integration","igo2_core","FeatureDetailsComponent","cdRef","networkService","http","messageService","Subject","currentState","takeUntil","unsubscribe$","_source","detectChanges","_feature","selectFeature","ready","properties","mapQuery","complete","formatReading","reading","toString","replace","isObject","isDoc","isUrl","test","toLowerCase","isImg","isEmbeddedLink","matchRegex","match","openSecureUrl","url","regexDepot","RegExp","responseType","docOrImage","fileUrl","URL","createObjectURL","div","createElement","innerHTML","getAttribute","getEmbeddedLinkText","filterFeatureProperties","allowedFieldsAndAlias","alias","Route","keys","forEach","field","connection","excludeAttribute","attribute","excludeAttributeOffline","copyTextToClipboard","igo2_utils","success","FeatureDetailsCustomComponent","mobile","_mobile","tooltipPosition","matTooltipPosition","FeatureInfoComponent","storageState","customFeatureTitle","customFeatureDetails","_map","_store","displayStyle","selectResult","onEscapeHandler","clearButton","mapQueryInit","_mapQueryInit","resultSelected$","resultOrResolution$$","onTitleClick","closeQuery","features","queryOverlayStyleSelection","queryOverlayStyle","getTitle","removeFeatures","addFeatures","isResultSelected$","unselectResult","setFeatures","panelOpened","mapQueryFromFeatureDetails","SidePanelComponent","opened","_opened","openedChange","layers","_layers","entities","clearSearch","closePanelOnCloseQuery","destroy","clearQuery","propertyChange$","selectedFeature","layer","removeFeatureFromMap","closePanelLegend","closeLegend","panelOpenedFromFeature","mapQueryFromFeature","$event","BottomPanelComponent","mapService","searchService","setMap","showSearchBar","zoomAuto","_term","pageIterator","_zoomAuto","zoomAuto$","latestResult","closePanel","forceCoordsNA","openPanel","mapLayersShownInLegend","showInLayerList","res","onPointerSummaryStatusChange","igoSearchPointerSummaryEnabled","onSearchTermChange","clearedSearchbar","trim","onSearchCoordinate","reverseSearch","lonlat","_results","onSearchBarClick","panelOpenState","stopPropagation","clearSearchBar","LegendDialogComponent","layers$","LegendButtonComponent","dialog","toggleLegendButton","legendInPanel","getDialogById","legendButtonTooltip","dialogRef","close","hasBackdrop","closeOnNavigation","toggleLegend","PortalComponent","route","workspaceState","authService","layerService","dataSourceService","capabilitiesService","contextState","importService","dialogWindow","queryService","breakpointObserver","pwaService","analyticsService","pageSize","pageSizeOptions","layout","observe","mobileBreakPoint","distinctUntilChanged","hasFooter","hasLegendButton","hasSideSearch","hasHomeExtentButton","hasGeolocateButton","showRotationButtonIfNoRotation","getBaseLayersUseStaticIcon","auth","isMobile","isTablet","isLandscape","getOrientation","isPortrait","backdropShown","expansionPanelExpanded","workspacePanelExpanded","setPadding","bottom","workspace","workspace$","actionbarMode","actionbarWithTitle","workspaceStore","defaultFeatureCount","IGO","once","readQueryParams","tracking","authenticate$","authenticated","contextLoaded","queryParams","params","readLanguageParam","onChangeContext","contextActions","handler","searchCoordinate","contextMenuCoord","openGoogleMaps","openGoogleStreetView","contextMenuStore","load","closePanels","trackSearch","count","openPanelonQuery","breakpoint$","breakpointChanged","ngAfterContentInit","setInitialState","toggleDialogLegend","legendDialogOpened","openPanelLegend","openPanels","onClearQuery","isMatched","currentBreakpoint","createFeatureProperties","options","sourceOptions","sourceFields","primary","visible","entitySortChange","workspaceEntitySortChange$","workspaceMaximize$$","f","layers$$","getQuerySearchSource","getSources","searchSource","getFeatureIsSameActiveWks","sourceTitle","getWksActiveOpenInResolution","activeWks","active","inResolutionRange$","onMapQuery","querySearchSourceArray","clearSearchbarterm","filteredResults","querySearchSource","s","getLayerWksOptionMapQuery","of","queryResults","cancelOngoingAddLayer","addedLayers$$","sub","onBackdropClick","routeParams","search","onBeforeSearch","searchBar","setTerm","isReverseSearch","enabledSources","computeHomeExtentValues","view","homeExtent","homeCenter","center","homeZoom","zoom","entityStore","qParams","uri","readLayersQueryParams","searchBarTerm","onContextMenuOpen","getClickCoordinate","contextmenuPoint","boundingMapBrowser","mapBrowser","getBoundingClientRect","top","scrollY","pageYOffset","left","scrollX","pageXOffset","pixel","getCoordinateFromPixel","proj","c","toFixed","readSearchParams","readFocusFirst","computeZoomToExtent","lang","languageForce","setLanguage","zoomExtent","extentParams","split","olExtent","zoomToExtent","getControlsOffsetY","workspaceMaximize$","computeFocusFirst","resultItem","item","click","sf","termDefinedInUrl","entities$$","skipWhile","take","termDefinedInUrlTriggered","exactMatch","searchResultsOlFeatures","totalExtent","searchGeom","readLayersQueryParamsByType","readVectorQueryParams","getQueryParam","paramValue","fromString","nameParamLayersKey","urlsKey","wmsLayers","wmsUrl","wmtsLayers","wmtsUrl","arcgisLayers","arcgisUrl","iarcgisLayers","iarcgisUrl","tarcgisLayers","tarcgisUrl","layersByService","urls","cnt","urlSrc","extractLayersByService","layerFromUrl","layerOptions","LAYERS","visibility","computeLayerVisibilityFromUrl","addLayerFromURL","parseInt","vector","lastIndex","lastIndexOf","fileName","slice","file","File","lastModified","Date","now","import","onFileImportSuccess","onFileImportError","outLayersByService","startsWith","substr","endsWith","zIndex","commonSourceOptions","optionsFromCapabilities","optionsFromApi","crossOrigin","arcgisClause","queryable","queryFormat","VERSION","createAsyncLayer","l","addLayer","currentLayerid","visibleOnLayersParams","visibleOffLayersParams","visiblelayers","invisiblelayers","indexOf","controlsAnimations","fesm2015_animations","controlSlideX","controlSlideY","MapComponent","hasHeader","routes","path","component","MenuRoutingModule","router","onSameUrlNavigation","relativeLinkResolution","HeaderModule","common","toolbar","FooterModule","LegendDialogModule","fesm2015_button","tooltip","LegendButtonModule","MapOverlayModule","IgoAppSearchResultsToolModule","badge","IgoFeatureDetailsModule","IgoFeatureModule","AppFeatureInfoModule","AppPanelsModule","sidenav","igo2_context","card","expansion","PortalModule","MenuModule","environment","production","igo","app","install","enabled","promote","manifestPath","pwa","language","prefix","searchSources","nominatim","available","storedqueries","icherche","searchUrl","order","limit","coordinatesreverse","showInPointerSummary","icherchereverse","ilayer","projections","code","def","HeaderComponent","computeHeader","headerLogo","headerLogoPrint","MenuComponent","AppComponent","renderer","titleService","metaService","readTitleConfig","readThemeConfig","readDescriptionConfig","detectOldBrowser","hasMenu","setManifest","installPrompt","setTitle","addTag","content","appConfig","setAttribute","addEventListener","preventDefault","promptEvent","prompt","theme","themeClass","addClass","body","description","ie","chrome","firefox","safari","timeOut","AppModule","bootstrap","default","provide","useFactory","appInitializerFactory","injector","applicationRef","Promise","resolve","isStable","first","concatMap","getLanguage","getTranslation","translations","setTranslation","deps","multi","useValue","showDelay","hideDelay","touchendHideDelay","disableTooltipInteractivity","imports","platform_browser","animations","service_worker","registrationStrategy","bootstrapModule","catch","webpackContext","module"],"sourceRoot":"webpack:///","sources":["./src/app/pages/menu/menu-pages/home/home.component.ts","./src/app/pages/menu/menu-pages/home/home.component.html","./src/app/pages/menu/menu-pages/about/about.component.ts","./src/app/pages/menu/menu-pages/about/about.component.html","./src/app/pages/portal/panels/search-results-tool/search.state.ts","./src/app/services/pwa.service.ts","./src/app/pages/footer/footer.component.ts","./src/app/pages/footer/footer.component.html","./src/app/pages/portal/map-overlay/map-overlay.component.html","./src/app/pages/portal/map-overlay/map-overlay.component.ts","./src/app/pages/portal/panels/search-results-tool/search-results-tool.component.html","./src/app/pages/portal/panels/search-results-tool/search-results-tool.component.ts","./src/app/pages/portal/panels/feature/feature-details/feature-details.component.html","./src/app/pages/portal/panels/feature/feature-details/feature-details.component.ts","./src/app/pages/portal/panels/feature/feature-details/feature-details-custom.component.html","./src/app/pages/portal/panels/feature/feature-details/feature-details-custom.component.ts","./src/app/pages/portal/panels/feature/feature-info/feature-info.component.html","./src/app/pages/portal/panels/feature/feature-info/feature-info.component.ts","./src/app/pages/portal/panels/sidepanel/sidepanel.component.html","./src/app/pages/portal/panels/sidepanel/sidepanel.component.ts","./src/app/pages/portal/panels/bottompanel/bottompanel.component.html","./src/app/pages/portal/panels/bottompanel/bottompanel.component.ts","./src/app/pages/portal/legend-dialog/legend-dialog.component.ts","./src/app/pages/portal/legend-dialog/legend-dialog.component.html","./src/app/pages/portal/legend-button/legend-button.component.ts","./src/app/pages/portal/legend-button/legend-button.component.html","./src/app/pages/portal/portal.component.html","./src/app/pages/portal/portal.component.ts","./src/app/pages/portal/portal.animation.ts","./src/app/pages/menu/menu-pages/map/map.component.ts","./src/app/pages/menu/menu-pages/map/map.component.html","./src/app/pages/menu/menu-routing/menu-routing.module.ts","./src/app/pages/header/header.module.ts","./src/app/pages/footer/footer.module.ts","./src/app/pages/portal/legend-dialog/legend-dialog.module.ts","./src/app/pages/portal/legend-button/legend-button.module.ts","./src/app/pages/portal/map-overlay/map-overlay.module.ts","./src/app/pages/portal/panels/search-results-tool/search-results-tool.module.ts","./src/app/pages/portal/panels/feature/feature-details/feature-details.module.ts","./src/app/pages/portal/panels/feature/feature.module.ts","./src/app/pages/portal/panels/feature/feature-info/feature-info.module.ts","./src/app/pages/portal/panels/panels.module.ts","./src/app/pages/portal/portal.module.ts","./src/app/pages/menu/menu.module.ts","./src/environments/environment.github.ts","./src/app/pages/header/header.component.ts","./src/app/pages/header/header.component.html","./src/app/pages/menu/menu.component.ts","./src/app/pages/menu/menu.component.html","./src/app/app.component.html","./src/app/app.component.ts","./src/app/app.module.ts","./src/main.ts","./node_modules/moment/locale/ sync ^\\.\\/.*$"],"sourcesContent":["import { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-menu-home',\r\n  templateUrl: './home.component.html'\r\n})\r\nexport class HomeComponent {\r\n  getHomeComponent: any;\r\n\r\n  constructor() { }\r\n\r\n}\r\n","<div class=\"page\">\r\n    <div class=\"row\">\r\n        <h1 class=\"d-block themeTitre\">Accueil</h1>\r\n        <h2>Infrastructure géomatique ouverte 2.0 (IGO2) / Open GIS Infrastructure 2.0</h2>\r\n        <h4>Qu'est-ce qu'IGO?</h4>\r\n        <p>IGO2 est une solution Web gratuite en géomatique basée sur Angular - Material, OpenLayers et IGO2lib. IGO2 permet de tirer profit d’une multitude de données géographiques grâce à une interface cartographique accessible par un navigateur Web sur un poste de travail et par un appareil mobile. IGO2 a été initié par l'administration publique du Québec (Canada) et issu d’un travail collaboratif basé sur la philosophie des logiciels libres et ouverts (« open source »). Les membres du public en géomatique et du Web qui soumettent des contributions conservent leurs droits d'auteur s'ils partagent leur code source selon la LICENCE LiLiQ-R de type LGPL.</p>\r\n        <p style=\"display:inline;\">Téléchargement et code source : <a style=\"display:inline;\" href=\"https://github.com/infra-geo-ouverte/igo2\" target=\"_blank\" rel=\"noreferrer\">https://github.com/infra-geo-ouverte/igo2<!--img class=\"linkExtImg\" src=\"../../../../../assets/images/lien-externe.svg\" alt=\"Cet hyperlien s'ouvrira dans une nouvelle fenêtre.\"--></a></p>\r\n    </div>\r\n</div>\r\n","import { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-about',\r\n  templateUrl: './about.component.html'\r\n})\r\nexport class AboutComponent {\r\n\r\n  constructor() { }\r\n\r\n}\r\n","<div class=\"row\">\r\n    <div class=\"container-fluid page\">\r\n        <h1 class=\"d-block themeTitre\">En savoir plus</h1>\r\n        <h2>Notre Mission</h2>\r\n\r\n        <h3>Mission 1</h3>\r\n        <p>Paragraphe : Lorem ipsum dolor sit amet, consectetur adipiscing elit. Tu enim ista lenius, hic Stoicorum more nos vexat. Quo studio Aristophanem putamus aetatem in litteris duxisse? Honesta oratio, Socratica, Platonis etiam. Vitiosum est enim in dividendo partem in genere numerare. <i>Non est igitur voluptas bonum.</i> Duo Reges: constructio interrete. Non autem hoc: igitur ne illud quidem. <b>Magna laus.</b> <b>Quis istum dolorem timet?</b> Quod autem satis est, eo quicquid accessit, nimium est; <b>Sed ille, ut dixi, vitiose.</b> </p>\r\n\r\n        <p>Cur tantas regiones barbarorum pedibus obiit, tot maria transmisit? <a href=\"http://loripsum.net/\" target=\"_blank\">Nulla erit controversia.</a> Prave, nequiter, turpiter cenabat; <code>Multoque hoc melius nos veriusque quam Stoici.</code> Contineo me ab exemplis. <b>Sed nimis multa.</b> <code>Nos vero, inquit ille;</code> <mark>Occultum facinus esse potuerit, gaudebit;</mark> </p>\r\n\r\n        <ul>\r\n            <li>Iam doloris medicamenta illa Epicurea tamquam de narthecio proment: Si gravis, brevis;</li>\r\n            <li>Ergo et avarus erit, sed finite, et adulter, verum habebit modum, et luxuriosus eodem modo.</li>\r\n            <li>Sedulo, inquam, faciam.</li>\r\n            <li>Quid enim tanto opus est instrumento in optimis artibus comparandis?</li>\r\n            <li>Sic, et quidem diligentius saepiusque ista loquemur inter nos agemusque communiter.</li>\r\n        </ul>\r\n\r\n\r\n        <p><b> Bold Inde igitur, inquit, ordiendum est.</b> Quis hoc dicit? Quamquam te quidem video minime esse deterritum. <i>Bonum incolumis acies: misera caecitas.</i> Indicant pueri, in quibus ut in speculis natura cernitur. Duae sunt enim res quoque, ne tu verba solum putes. <code>Est enim effectrix multarum et magnarum voluptatum.</code> </p>\r\n\r\n        <pre> Pre Corporis igitur nostri partes totaque figura et forma et\r\n        statura quam apta ad naturam sit, apparet, neque est dubium,\r\n        quin frons, oculi, aures et reliquae partes quales propriae\r\n        sint hominis intellegatur.\r\n\r\n        Pungunt quasi aculeis interrogatiunculis angustis, quibus\r\n        etiam qui assentiuntur nihil commutantur animo et idem\r\n        abeunt, qui venerant.\r\n        </pre>\r\n\r\n\r\n        <ol>\r\n            <li>Atqui perspicuum est hominem e corpore animoque constare, cum primae sint animi partes, secundae corporis.</li>\r\n            <li>Nonne videmus quanta perturbatio rerum omnium consequatur, quanta confusio?</li>\r\n        </ol>\r\n\r\n\r\n        <dl>\r\n            <dt><dfn>Stoicos roga.</dfn></dt>\r\n            <dd>Quid enim de amicitia statueris utilitatis causa expetenda vides.</dd>\r\n            <dt><dfn>Qui convenit?</dfn></dt>\r\n            <dd>Que Manilium, ab iisque M.</dd>\r\n            <dt><dfn>Paria sunt igitur.</dfn></dt>\r\n            <dd>Quamquam ab iis philosophiam et omnes ingenuas disciplinas habemus;</dd>\r\n            <dt><dfn>Confecta res esset.</dfn></dt>\r\n            <dd>Cupiditates non Epicuri divisione finiebat, sed sua satietate.</dd>\r\n        </dl>\r\n    </div>\r\n</div>","import { Injectable } from '@angular/core';\r\n\r\nimport { EntityRecord, EntityStore, EntityStoreFilterCustomFuncStrategy, EntityStoreStrategyFuncOptions } from '@igo2/common';\r\nimport { ConfigService, StorageService } from '@igo2/core';\r\nimport { SearchResult, SearchSourceService, SearchSource, CommonVectorStyleOptions } from '@igo2/geo';\r\nimport { BehaviorSubject, Subscription } from 'rxjs';\r\n\r\n/**\r\n * Service that holds the state of the search module\r\n */\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class SearchState {\r\n  public searchOverlayStyle: CommonVectorStyleOptions = {};\r\n  public searchOverlayStyleSelection: CommonVectorStyleOptions = {};\r\n  public searchOverlayStyleFocus: CommonVectorStyleOptions = {};\r\n\r\n  public focusedOrResolution$$: Subscription;\r\n  public selectedOrResolution$$: Subscription;\r\n\r\n  readonly searchTermSplitter$: BehaviorSubject<string> = new BehaviorSubject('|');\r\n\r\n  readonly searchTerm$: BehaviorSubject<string> = new BehaviorSubject(undefined);\r\n\r\n  readonly searchType$: BehaviorSubject<string> = new BehaviorSubject(undefined);\r\n\r\n  readonly searchDisabled$: BehaviorSubject<boolean> = new BehaviorSubject(false);\r\n\r\n  readonly searchResultsGeometryEnabled$: BehaviorSubject<boolean> = new BehaviorSubject(false);\r\n\r\n  readonly selectedResult$: BehaviorSubject<SearchResult> = new BehaviorSubject(undefined);\r\n\r\n  /**\r\n   * Store that holds the search results\r\n   */\r\n  readonly store: EntityStore<SearchResult> = new EntityStore<SearchResult>([]);\r\n\r\n  /**\r\n   * Search types currently enabled in the search source service\r\n   */\r\n  get searchTypes(): string[] {\r\n    return this.searchSourceService\r\n      .getEnabledSources()\r\n      .map((source: SearchSource) => (source.constructor as any).type);\r\n  }\r\n\r\n  constructor(\r\n    private searchSourceService: SearchSourceService,\r\n    private storageService: StorageService,\r\n    private configService: ConfigService) {\r\n      this.searchOverlayStyle = {\r\n        markerColor: '#45D7E6', // marker fill\r\n        markerOpacity: 0.8, // marker opacity not applied if a rgba markerColor is provided\r\n        markerOutlineColor: '#ffffff', // marker contour\r\n        fillColor: 'transparent', // poly\r\n        fillOpacity: 0, // poly fill opacity not applied if a rgba fillColor is provided\r\n        strokeColor: '#45D7E6', // line and poly\r\n        strokeOpacity: 0.7, // line and poly not applied if a rgba strokeColor is provided\r\n        strokeWidth: 4 // line and poly\r\n      };\r\n      this.searchOverlayStyleSelection = {\r\n        markerColor: '#45D7E6', // marker fill\r\n        markerOpacity: 1, // marker opacity not applied if a rgba markerColor is provided\r\n        markerOutlineColor: '#ffffff', // marker contour\r\n        fillColor: 'transparent', // poly\r\n        fillOpacity: 0, // poly fill opacity not applied if a rgba fillColor is provided\r\n        strokeColor: '#45D7E6', // line and poly\r\n        strokeOpacity: 1, // line and poly not applied if a rgba strokeColor is provided\r\n        strokeWidth: 4 // line and poly\r\n      };\r\n      this.searchOverlayStyleFocus = {\r\n        markerColor: '#45D7E6', // marker fill\r\n        markerOpacity: 1, // marker opacity not applied if a rgba markerColor is provided\r\n        markerOutlineColor: '#ffffff', // marker contour\r\n        fillColor: 'transparent', // poly\r\n        fillOpacity: 0, // poly fill opacity not applied if a rgba fillColor is provided\r\n        strokeColor: '#45D7E6', // line and poly\r\n        strokeOpacity: 1, // line and poly not applied if a rgba strokeColor is provided\r\n        strokeWidth: 4 // line and poly\r\n      };\r\n\r\n    const searchResultsGeometryEnabled = this.storageService.get('searchResultsGeometryEnabled') as boolean;\r\n    if (searchResultsGeometryEnabled) {\r\n      this.searchResultsGeometryEnabled$.next(searchResultsGeometryEnabled);\r\n    }\r\n    this.store.addStrategy(this.createCustomFilterTermStrategy(), false);\r\n  }\r\n\r\n  private createCustomFilterTermStrategy(): EntityStoreFilterCustomFuncStrategy {\r\n    const filterClauseFunc = (record: EntityRecord<SearchResult>) => {\r\n      return record.entity.meta.score === 100;\r\n    };\r\n    return new EntityStoreFilterCustomFuncStrategy({filterClauseFunc} as EntityStoreStrategyFuncOptions);\r\n  }\r\n\r\n  /**\r\n   * Activate custom strategy\r\n   *\r\n   */\r\n  activateCustomFilterTermStrategy() {\r\n    const strategy = this.store.getStrategyOfType(EntityStoreFilterCustomFuncStrategy);\r\n    if (strategy !== undefined) {\r\n      strategy.activate();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Deactivate custom strategy\r\n   *\r\n   */\r\n  deactivateCustomFilterTermStrategy() {\r\n    const strategy = this.store.getStrategyOfType(EntityStoreFilterCustomFuncStrategy);\r\n    if (strategy !== undefined) {\r\n      strategy.deactivate();\r\n    }\r\n  }\r\n\r\n  enableSearch() {\r\n    this.searchDisabled$.next(false);\r\n  }\r\n\r\n  disableSearch() {\r\n    this.searchDisabled$.next(true);\r\n  }\r\n\r\n  setSearchTerm(searchTerm: string) {\r\n    this.searchTerm$.next(searchTerm);\r\n  }\r\n\r\n  setSearchType(searchType: string) {\r\n    this.searchSourceService.enableSourcesByType(searchType);\r\n    this.searchType$.next(searchType);\r\n  }\r\n\r\n  setSelectedResult(result: SearchResult) {\r\n    this.selectedResult$.next(result);\r\n  }\r\n\r\n  setSearchResultsGeometryStatus(value) {\r\n    this.storageService.set('searchResultsGeometryEnabled', value);\r\n    this.searchResultsGeometryEnabled$.next(value);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { LanguageService } from '@igo2/core';\r\nimport { SwUpdate } from '@angular/service-worker';\r\nimport { interval } from 'rxjs';\r\nimport { ConfirmDialogService } from '@igo2/common';\r\nimport { skip, tap } from 'rxjs/operators';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class PwaService {\r\n  private confirmOpened: boolean = false;\r\n  constructor(\r\n    private updates: SwUpdate,\r\n    private languageService: LanguageService,\r\n    private confirmDialogService: ConfirmDialogService\r\n  ) {\r\n    if (updates.isEnabled) {\r\n      this.handleVersionUpdates();\r\n    }\r\n  }\r\n\r\n  checkForUpdates() {\r\n    if (this.updates.isEnabled) {\r\n      interval(60 * 1000 * 2).pipe(skip(1)).subscribe(async () => {\r\n        try {\r\n          const updateFound = await this.updates.checkForUpdate();\r\n          console.log(updateFound ? 'A new version is available.' : 'Already on the latest version.');\r\n        } catch (err) {\r\n          console.error('Failed to check for updates:', err);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  private modalUpdatePWA() {\r\n    if (this.confirmOpened) {\r\n      return;\r\n    }\r\n    const title = this.languageService.translate.instant('pwa.new-version-title');\r\n    const body = this.languageService.translate.instant('pwa.new-version');\r\n    const message = `${title} ${body}`;\r\n    this.confirmDialogService.open(message).pipe(tap(() => this.confirmOpened = true)).subscribe((confirm) => {\r\n      if (confirm) {\r\n        this.confirmOpened = false;\r\n        if (window.navigator.onLine) {\r\n          document.location.reload();\r\n        } else {\r\n          alert(`Hors-ligne / Offline. Vous devez être en ligne pour mettre à jour l\\'application. You must be online to update the application.`);\r\n          setTimeout(() => {\r\n            this.modalUpdatePWA();\r\n          }, 900000);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  private handleVersionUpdates(): void {\r\n    this.updates.versionUpdates.subscribe(evt => {\r\n      switch (evt.type) {\r\n        case 'VERSION_DETECTED':\r\n          console.log(`Downloading new app version: ${evt.version.hash}`);\r\n          break;\r\n        case 'VERSION_READY':\r\n          console.log(`Current app version: ${evt.currentVersion.hash}`);\r\n          console.log(`New app version ready for use: ${evt.latestVersion.hash}`);\r\n          this.modalUpdatePWA();\r\n          break;\r\n        case 'VERSION_INSTALLATION_FAILED':\r\n          console.error(`Failed to install app version '${evt.version.hash}': ${evt.error}`);\r\n          break;\r\n      }\r\n    });\r\n  }\r\n}\r\n","import { Component } from '@angular/core';\r\nimport { LanguageService } from '@igo2/core';\r\n\r\n@Component({\r\n  selector: 'app-footer',\r\n  templateUrl: './footer.component.html',\r\n  styleUrls: ['./footer.component.scss']\r\n})\r\nexport class FooterComponent {\r\n\r\n  constructor(protected languageService: LanguageService) {}\r\n\r\n}\r\n","<div class=\"footer-right\" id=\"footer-id\">\r\n    <div id=\"scaleLine\"></div>\r\n    <span class=\"order2\">\r\n        <span class=\"footer-text\">\r\n            <a rel=\"noopener noreferrer\" alt=\"('externallinks' | translate)\" href=\"{{'footer.url-conditions' | translate}}\"\r\n            target=\"_blank\">{{'footer.conditions' | translate}}</a>\r\n        </span>\r\n        <span class=\"footer-text\">  |  </span>\r\n        <span class=\"footer-text\">\r\n            <a rel=\"noopener noreferrer\" alt=\"('externallinks' | translate)\" href=\"{{'footer.url-ministry' | translate}}\"\r\n            target=\"_blank\">{{'footer.ministry' | translate}}</a>\r\n        </span>\r\n        <span class=\"footer-text\">  |  </span>\r\n        <span class=\"footer-text\">\r\n            <a rel=\"noopener noreferrer\" alt=\"('externallinks' | translate)\" href=\"{{'footer.url-gov' | translate}}\"\r\n            target=\"_blank\">{{'footer.gov' | translate}}</a>\r\n        </span>\r\n    </span>\r\n</div>\r\n","<ng-container *ngFor=\"let element of mapOverlay; let i = index\">\r\n  <div class=\"mapOverlayDefault\" [ngClass]=\"element.cssClass\"\r\n       [style.position]=\"element.fixed ? 'fixed' : 'absolute'\"\r\n       [style.marginLeft]=\"element.marginLeft\"\r\n       [style.marginRight]=\"element.marginRight\"\r\n       [style.marginTop]=\"element.marginTop\"\r\n       [style.marginBottom]=\"element.marginBottom\"\r\n       [style.fontSize]=\"element.fontSize\">\r\n    <a *ngIf=\"element.link; else templateNoLink\"\r\n        target=\"_blank\" [href]='element.link'>\r\n        {{ element.text }}\r\n        <ng-container *ngIf=\"element.imgSrc\">\r\n          <img [src]=\"element.imgSrc\"\r\n               [alt]=\"element.alt\"\r\n               [ngStyle]=\"{ 'width': element.imgSize }\">\r\n        </ng-container>\r\n    </a>\r\n\r\n\r\n  <ng-template #templateNoLink>\r\n    {{ element.text }}\r\n    <ng-container *ngIf=\"element.imgSrc\">\r\n      <img [src]=\"element.imgSrc\" [alt]=\"element.alt\" [ngStyle]=\"{ 'width': element.imgSize }\">\r\n    </ng-container>\r\n\r\n  </ng-template>\r\n  </div>\r\n</ng-container>\r\n","import { Component, AfterViewInit, OnDestroy } from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\nimport { Context, ContextService } from '@igo2/context';\r\nimport { MediaService, ConfigService } from '@igo2/core';\r\nimport { MapOverlay } from './map-overlay.interface';\r\n\r\n@Component({\r\n  selector: 'app-map-overlay',\r\n  templateUrl: './map-overlay.component.html',\r\n  styleUrls: ['./map-overlay.component.scss']\r\n})\r\n\r\nexport class MapOverlayComponent implements AfterViewInit, OnDestroy {\r\n  public mapOverlay: MapOverlay[] = [];\r\n  private context$$: Subscription;\r\n  private media$$: Subscription;\r\n  private context: Context;\r\n\r\n  constructor(\r\n    private contextService: ContextService,\r\n    private mediaService: MediaService,\r\n    private configService: ConfigService\r\n  ) { }\r\n\r\n  ngAfterViewInit() {\r\n    this.context$$ = this.contextService.context$.subscribe(context => {\r\n        this.handleContextChange(context);\r\n        this.context = context;\r\n        }\r\n    );\r\n    this.media$$ = this.mediaService.media$.subscribe(media =>\r\n      this.handleContextChange(this.context)\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.context$$.unsubscribe();\r\n    this.media$$.unsubscribe();\r\n  }\r\n\r\n  private handleContextChange(context: Context) {\r\n    let mapOverlay = [];\r\n    if (context !== undefined) {\r\n      this.mapOverlay = [];\r\n\r\n      if (context['mapOverlay']) {\r\n        mapOverlay = context['mapOverlay'];\r\n      } else if (this.configService.getConfig('mapOverlay')) {\r\n        mapOverlay = this.configService.getConfig('mapOverlay');\r\n      }\r\n      for (const overlay of mapOverlay) {\r\n\r\n        // If no media define use default to desktop, display only if current media is on context definition\r\n        if ((!overlay.media && this.mediaService.getMedia() === 'desktop') ||\r\n        (overlay.media && overlay.media.includes(this.mediaService.getMedia()))) {\r\n          this.mapOverlay.push(overlay);\r\n        }\r\n      }\r\n    }\r\n\r\n  }\r\n}\r\n","<igo-flexible\r\n  *ngIf=\"store && (store.stateView.empty$ | async)===false\"\r\n  #topPanel\r\n  initial=\"100%\"\r\n  initialMobile=\"100%\"\r\n  collapsed=\"calc(100% - 58px)\"\r\n  collapsedMobile=\"calc(100% - 58px)\"\r\n  expanded=\"60%\"\r\n  expandedMobile=\"60%\"\r\n  [state]=\"(feature$ | async) ? topPanelState : 'initial'\">\r\n\r\n  <div class=\"igo-content\">\r\n    <igo-search-results\r\n      [store]=\"store\"\r\n      [showIcons]=\"showIcons\"\r\n      [term]=\"term\"\r\n      [termSplitter]=\"termSplitter\"\r\n      [settingsChange$]=\"settingsChange$\"\r\n      placeholder=\"false\"\r\n      (resultFocus)=\"onResultFocus($event)\"\r\n      (resultSelect)=\"onResultSelect($event)\"\r\n      (resultUnfocus)=\"onResultUnfocus($event)\"\r\n      (resultMouseenter)=\"onResultFocus($event)\"\r\n      (resultMouseleave)=\"onResultUnfocus($event)\"\r\n      (moreResults)=\"onSearch($event)\">\r\n      <ng-template #igoSearchItemToolbar let-result=\"result\">\r\n        <igo-search-add-button\r\n          *ngIf(addFeaturetoLayer)\r\n          [map]=\"map\"\r\n          [layer]=\"result\">\r\n        </igo-search-add-button>\r\n      </ng-template>\r\n    </igo-search-results>\r\n  </div>\r\n\r\n</igo-flexible>\r\n","import {\r\n  Component,\r\n  ChangeDetectionStrategy,\r\n  Input,\r\n  OnInit,\r\n  ElementRef,\r\n  OnDestroy,\r\n  HostListener,\r\n  Output, EventEmitter\r\n} from '@angular/core';\r\nimport { Observable, BehaviorSubject, Subscription, combineLatest } from 'rxjs';\r\nimport { debounceTime, map } from 'rxjs/operators';\r\nimport olFormatGeoJSON from 'ol/format/GeoJSON';\r\nimport olFeature from 'ol/Feature';\r\nimport olPoint from 'ol/geom/Point';\r\nimport type { default as OlGeometry } from 'ol/geom/Geometry';\r\n\r\nimport pointOnFeature from '@turf/point-on-feature';\r\nimport * as olProj from 'ol/proj';\r\nimport { ConfigService } from '@igo2/core';\r\n\r\nimport {\r\n  EntityStore,\r\n  ToolComponent,\r\n  getEntityTitle,\r\n  EntityState\r\n} from '@igo2/common';\r\n\r\nimport {\r\n  FEATURE,\r\n  Feature,\r\n  FeatureMotion,\r\n  SearchResult,\r\n  IgoMap,\r\n  moveToOlFeatures,\r\n  Research,\r\n  featuresAreTooDeepInView,\r\n  featureToOl,\r\n  featureFromOl,\r\n  getCommonVectorStyle,\r\n  getCommonVectorSelectedStyle,\r\n  computeOlFeaturesExtent,\r\n  featuresAreOutOfView,\r\n  roundCoordTo\r\n} from '@igo2/geo';\r\n\r\nimport { MapState, ToolState, DirectionState, QueryState } from '@igo2/integration';\r\nimport { SearchState } from './search.state';\r\n\r\n/**\r\n * Tool to browse the search results\r\n */\r\n@ToolComponent({\r\n  name: 'searchResults',\r\n  title: 'igo.integration.tools.searchResults',\r\n  icon: 'magnify'\r\n})\r\n@Component({\r\n  selector: 'app-search-results-tool',\r\n  templateUrl: './search-results-tool.component.html',\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class SearchResultsToolComponent implements OnInit, OnDestroy {\r\n  /**\r\n   * to show hide results icons\r\n   */\r\n  @Input() showIcons: boolean = true;\r\n\r\n  private hasFeatureEmphasisOnSelection: boolean;\r\n  private showResultsGeometries$$: Subscription;\r\n  private getRoute$$: Subscription;\r\n  private shownResultsGeometries: Feature[] = [];\r\n  private shownResultsEmphasisGeometries: Feature[] = [];\r\n  private focusedResult$: BehaviorSubject<SearchResult> = new BehaviorSubject(\r\n    undefined\r\n  );\r\n  public isSelectedResultOutOfView$ = new BehaviorSubject(false);\r\n  private isSelectedResultOutOfView$$: Subscription;\r\n  private abstractFocusedResult: Feature;\r\n  private abstractSelectedResult: Feature;\r\n\r\n  public debouncedEmpty$ :BehaviorSubject<boolean> = new BehaviorSubject(true);\r\n  private debouncedEmpty$$: Subscription;\r\n  @Output() featureSelected = new EventEmitter<boolean>();\r\n  public addFeaturetoLayer : boolean; // in the result features list, display an icon \"add this feature to a layer\"\r\n\r\n  /**\r\n   * Store holding the search results\r\n   * @internal\r\n   */\r\n  get store(): EntityStore<SearchResult> {\r\n    return this.searchState.store;\r\n  }\r\n\r\n  /**\r\n   * Map to display the results on\r\n   * @internal\r\n   */\r\n  get map(): IgoMap {\r\n    return this.mapState.map;\r\n  }\r\n\r\n  get featureTitle(): string {\r\n    return this.feature ? getEntityTitle(this.feature) : undefined;\r\n  }\r\n\r\n  get feature$(): Observable<Feature> {\r\n    return this.store.stateView\r\n      .firstBy$((e) => e.state.focused)\r\n      .pipe(\r\n        map(\r\n          (element) =>\r\n          (this.feature = element\r\n            ? (element.entity.data as Feature)\r\n            : undefined)\r\n        )\r\n      );\r\n  }\r\n  public feature: Feature;\r\n\r\n  public term = '';\r\n  private searchTerm$$: Subscription;\r\n  public settingsChange$ = new BehaviorSubject<boolean>(undefined);\r\n\r\n  get termSplitter(): string {\r\n    return this.searchState.searchTermSplitter$.value;\r\n  }\r\n\r\n  private format = new olFormatGeoJSON();\r\n\r\n  get searchStore(): EntityStore<SearchResult> {\r\n    return this.searchState.store;\r\n  }\r\n\r\n  public initialized: boolean = undefined;\r\n\r\n  @Output() searchEvent = new EventEmitter();\r\n\r\n  @Input()\r\n  get mapQueryClick(): boolean {\r\n    return this._mapQueryClick;\r\n  }\r\n  set mapQueryClick(value: boolean) {\r\n    this._mapQueryClick = value;\r\n  }\r\n  private _mapQueryClick: boolean;\r\n\r\n  @Input()\r\n  get searchInit(): boolean {\r\n    return this._searchInit;\r\n  }\r\n  set searchInit(value: boolean) {\r\n    this._searchInit = value;\r\n  }\r\n  private _searchInit: boolean;\r\n\r\n  @Input()\r\n  get legendPanelOpened(): boolean {\r\n    return this._legendPanelOpened;\r\n  }\r\n  set legendPanelOpened(value: boolean) {\r\n    this._legendPanelOpened = value;\r\n  }\r\n  private _legendPanelOpened: boolean;\r\n\r\n  get queryStore(): EntityStore<SearchResult> {\r\n    return this.queryState.store;\r\n  }\r\n\r\n  constructor(\r\n    private mapState: MapState,\r\n    private searchState: SearchState,\r\n    private elRef: ElementRef,\r\n    public toolState: ToolState,\r\n    private directionState: DirectionState,\r\n    configService: ConfigService,\r\n    private queryState: QueryState\r\n  ) {\r\n    this.hasFeatureEmphasisOnSelection = configService.getConfig(\r\n      'hasFeatureEmphasisOnSelection'\r\n    );\r\n    this.addFeaturetoLayer = configService.getConfig(\r\n      'addFeaturetoLayer'\r\n    );\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.initialized = true;\r\n    this.searchTerm$$ = this.searchState.searchTerm$.subscribe(\r\n      (searchTerm: string) => {\r\n        if (searchTerm !== undefined && searchTerm !== null) {\r\n          this.term = searchTerm;\r\n        }\r\n      }\r\n    );\r\n\r\n    if (this.hasFeatureEmphasisOnSelection) {\r\n      if (!this.searchState.focusedOrResolution$$) {\r\n        this.searchState.focusedOrResolution$$ = combineLatest([\r\n          this.focusedResult$,\r\n          this.map.viewController.resolution$\r\n        ]).subscribe((bunch: [SearchResult<Feature>, number]) =>\r\n          this.buildResultEmphasis(bunch[0], 'focused')\r\n        );\r\n      }\r\n\r\n      if (!this.searchState.selectedOrResolution$$) {\r\n        this.searchState.selectedOrResolution$$ = combineLatest([\r\n          this.searchState.selectedResult$,\r\n          this.map.viewController.resolution$\r\n        ]).subscribe((bunch: [SearchResult<Feature>, number]) =>\r\n          this.buildResultEmphasis(bunch[0], 'selected')\r\n        );\r\n      }\r\n    }\r\n    this.monitorResultOutOfView();\r\n\r\n    this.showResultsGeometries$$ = combineLatest([\r\n      this.searchState.searchResultsGeometryEnabled$,\r\n      this.store.stateView.all$(),\r\n      this.focusedResult$,\r\n      this.searchState.selectedResult$,\r\n      this.searchState.searchTerm$,\r\n      this.map.viewController.resolution$\r\n    ]).subscribe((bunch: [boolean, { entity: SearchResult, state: EntityState }[], SearchResult, SearchResult, string, number]) => {\r\n\r\n      const searchResultsGeometryEnabled = bunch[0];\r\n      const searchResults = bunch[1];\r\n\r\n      if (this.hasFeatureEmphasisOnSelection) {\r\n        this.clearFeatureEmphasis('shown');\r\n      }\r\n      this.shownResultsGeometries.map(result => this.map.queryResultsOverlay.removeFeature(result));\r\n      const featureToHandleGeom = searchResults\r\n        .filter(result =>\r\n          result.entity.meta.dataType === FEATURE &&\r\n          result.entity.data.geometry &&\r\n          !result.state.selected &&\r\n          !result.state.focused);\r\n\r\n      featureToHandleGeom.map(result => {\r\n        if (searchResultsGeometryEnabled) {\r\n          result.entity.data.meta.style =\r\n            getCommonVectorStyle(\r\n              Object.assign(\r\n                {},\r\n                { feature: result.entity.data as Feature | olFeature<OlGeometry> },\r\n                this.searchState.searchOverlayStyle,\r\n                result.entity.style?.base ? result.entity.style.base : {}\r\n              ));\r\n          this.shownResultsGeometries.push(result.entity.data as Feature);\r\n          this.map.queryResultsOverlay.addFeature(result.entity.data as Feature, FeatureMotion.None);\r\n          if (this.hasFeatureEmphasisOnSelection) {\r\n            this.buildResultEmphasis(result.entity as SearchResult<Feature>, 'shown');\r\n          }\r\n        }\r\n      });\r\n    });\r\n\r\n    this.debouncedEmpty$$ = this.store.stateView.empty$.pipe(debounceTime(1500)).subscribe(empty => this.debouncedEmpty$.next(empty));\r\n  }\r\n\r\n  private monitorResultOutOfView() {\r\n    this.isSelectedResultOutOfView$$ = combineLatest([\r\n      this.map.viewController.state$,\r\n      this.searchState.selectedResult$\r\n    ])\r\n      .pipe(debounceTime(100))\r\n      .subscribe((bunch) => {\r\n        const selectedResult = bunch[1] as SearchResult<Feature>;\r\n        if (!selectedResult) {\r\n          this.isSelectedResultOutOfView$.next(false);\r\n          return;\r\n        }\r\n        if (selectedResult.data.geometry) {\r\n          const selectedOlFeature = featureToOl(\r\n            selectedResult.data,\r\n            this.map.projection\r\n          );\r\n          const selectedOlFeatureExtent = computeOlFeaturesExtent(this.map, [\r\n            selectedOlFeature\r\n          ]);\r\n          this.isSelectedResultOutOfView$.next(\r\n            featuresAreOutOfView(this.map, selectedOlFeatureExtent)\r\n          );\r\n        }\r\n      });\r\n  }\r\n\r\n  private buildResultEmphasis(\r\n    result: SearchResult<Feature>,\r\n    trigger: 'selected' | 'focused' | 'shown' | undefined\r\n  ) {\r\n    if (trigger !== 'shown') {\r\n      this.clearFeatureEmphasis(trigger);\r\n    }\r\n    if (!result || !result.data.geometry) {\r\n      return;\r\n    }\r\n    const myOlFeature = featureToOl(result.data, this.map.projection);\r\n    const olGeometry = myOlFeature.getGeometry();\r\n    if (featuresAreTooDeepInView(this.map, olGeometry.getExtent() as [number, number, number, number], 0.0025)) {\r\n      const extent = olGeometry.getExtent();\r\n      const x = extent[0] + (extent[2] - extent[0]) / 2;\r\n      const y = extent[1] + (extent[3] - extent[1]) / 2;\r\n      const feature1 = new olFeature({\r\n        name: `${trigger}AbstractResult'`,\r\n        geometry: new olPoint([x, y])\r\n      });\r\n      const abstractResult = featureFromOl(feature1, this.map.projection);\r\n\r\n      let computedStyle;\r\n      let zIndexOffset = 0;\r\n\r\n      switch (trigger) {\r\n        case 'focused':\r\n          computedStyle = getCommonVectorSelectedStyle(\r\n            Object.assign({},\r\n              { feature: abstractResult },\r\n              this.searchState.searchOverlayStyleFocus,\r\n              result.style?.focus ? result.style.focus : {}));\r\n          zIndexOffset = 2;\r\n          break;\r\n        case 'shown':\r\n          computedStyle = getCommonVectorStyle(Object.assign({},\r\n            { feature: abstractResult },\r\n            this.searchState.searchOverlayStyle,\r\n            result.style?.base ? result.style.base : {}));\r\n          break;\r\n        case 'selected':\r\n          computedStyle = getCommonVectorSelectedStyle(\r\n            Object.assign({},\r\n              { feature: abstractResult },\r\n              this.searchState.searchOverlayStyleSelection,\r\n              result.style?.selection ? result.style.selection : {}));\r\n          zIndexOffset = 1;\r\n          break;\r\n      }\r\n      abstractResult.meta.style = computedStyle;\r\n      abstractResult.meta.style.setZIndex(2000 + zIndexOffset);\r\n      this.map.searchResultsOverlay.addFeature(abstractResult, FeatureMotion.None);\r\n      if (trigger === 'focused') {\r\n        this.abstractFocusedResult = abstractResult;\r\n      }\r\n      if (trigger === 'selected') {\r\n        this.abstractSelectedResult = abstractResult;\r\n      }\r\n      if (trigger === 'shown') {\r\n        this.shownResultsEmphasisGeometries.push(abstractResult);\r\n      }\r\n    } else {\r\n      this.clearFeatureEmphasis(trigger);\r\n    }\r\n  }\r\n\r\n  private clearFeatureEmphasis(trigger: 'selected' | 'focused' | 'shown') {\r\n    if (trigger === 'focused' && this.abstractFocusedResult) {\r\n      this.map.searchResultsOverlay.removeFeature(this.abstractFocusedResult);\r\n      this.abstractFocusedResult = undefined;\r\n    }\r\n    if (trigger === 'selected' && this.abstractSelectedResult) {\r\n      this.map.searchResultsOverlay.removeFeature(this.abstractSelectedResult);\r\n      this.abstractSelectedResult = undefined;\r\n    }\r\n    if (trigger === 'shown') {\r\n      this.shownResultsEmphasisGeometries.map(shownResult => this.map.searchResultsOverlay.removeFeature(shownResult));\r\n      this.shownResultsEmphasisGeometries = [];\r\n    }\r\n  }\r\n\r\n  @HostListener('change')\r\n  ngOnDestroy() {\r\n    this.searchTerm$$.unsubscribe();\r\n    if (this.isSelectedResultOutOfView$$) {\r\n      this.isSelectedResultOutOfView$$.unsubscribe();\r\n    }\r\n    if (this.showResultsGeometries$$) {\r\n      this.showResultsGeometries$$.unsubscribe();\r\n    }\r\n    if (this.getRoute$$) {\r\n      this.getRoute$$.unsubscribe();\r\n    }\r\n    if (this.debouncedEmpty$$) {\r\n      this.debouncedEmpty$$.unsubscribe();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Try to add a feature to the map when it's being focused\r\n   * @internal\r\n   * @param result A search result that could be a feature\r\n   */\r\n  onResultFocus(result: SearchResult) {\r\n    this.focusedResult$.next(result);\r\n    if (result.meta.dataType === FEATURE && result.data.geometry) {\r\n      result.data.meta.style = getCommonVectorSelectedStyle(\r\n        Object.assign({},\r\n          { feature: result.data as Feature | olFeature<OlGeometry> },\r\n          this.searchState.searchOverlayStyleFocus,\r\n          result.style?.focus ? result.style.focus : {}));\r\n\r\n      const feature = this.map.searchResultsOverlay.dataSource.ol.getFeatureById(result.meta.id);\r\n      if (feature) {\r\n        feature.setStyle(result.data.meta.style);\r\n        return;\r\n      }\r\n      this.map.searchResultsOverlay.addFeature(result.data as Feature, FeatureMotion.None);\r\n      this.featureSelected.emit();\r\n    }\r\n  }\r\n\r\n  onResultUnfocus(result: SearchResult) {\r\n    this.focusedResult$.next(undefined);\r\n    if (result.meta.dataType !== FEATURE) {\r\n      return;\r\n    }\r\n\r\n    if (this.store.state.get(result).selected === true) {\r\n      this.featureSelected.emit();\r\n      const feature = this.map.searchResultsOverlay.dataSource.ol.getFeatureById(result.meta.id);\r\n      if (feature) {\r\n        const style = getCommonVectorSelectedStyle(\r\n          Object.assign({},\r\n            { feature: result.data as Feature | olFeature<OlGeometry> },\r\n            this.searchState.searchOverlayStyleFocus,\r\n            result.style?.focus ? result.style.focus : {}));\r\n        feature.setStyle(style);\r\n      }\r\n      return;\r\n    }\r\n    this.map.searchResultsOverlay.removeFeature(result.data as Feature);\r\n  }\r\n\r\n  /**\r\n   * Try to add a feature to the map when it's being selected\r\n   * @internal\r\n   * @param result A search result that could be a feature or some layer options\r\n   */\r\n  onResultSelect(result: SearchResult) {\r\n    this.map.searchResultsOverlay.dataSource.ol.clear();\r\n    this.tryAddFeatureToMap(result);\r\n    this.searchState.setSelectedResult(result);\r\n  }\r\n\r\n  onSearch(event: { research: Research; results: SearchResult[] }) {\r\n    if (this.mapQueryClick = true) { // to clear the mapQuery if a search is initialized\r\n      this.queryState.store.softClear();\r\n      this.map.queryResultsOverlay.clear();\r\n      this.mapQueryClick = false;\r\n    }\r\n    this.store.clear();\r\n    this.searchInit = true;\r\n    this.legendPanelOpened = false;\r\n    const results = event.results;\r\n    this.searchStore.state.updateAll({ focused: false, selected: false });\r\n    const newResults = this.searchStore.entities$.value\r\n      .filter((result: SearchResult) => result.source !== event.research.source)\r\n      .concat(results);\r\n    this.searchStore.updateMany(newResults);\r\n\r\n    setTimeout(() => {\r\n      const igoList = this.elRef.nativeElement.querySelector('igo-list');\r\n      let moreResults;\r\n      event.research.request.subscribe((source) => {\r\n        if (!source[0] || !source[0].source) {\r\n          moreResults = null;\r\n        } else if (source[0].source.getId() === 'icherche') {\r\n          moreResults = igoList.querySelector('.icherche .moreResults');\r\n        } else if (source[0].source.getId() === 'ilayer') {\r\n          moreResults = igoList.querySelector('.ilayer .moreResults');\r\n        } else if (source[0].source.getId() === 'nominatim') {\r\n          moreResults = igoList.querySelector('.nominatim .moreResults');\r\n        } else {\r\n          moreResults = igoList.querySelector('.' + source[0].source.getId() + ' .moreResults');\r\n        }\r\n        if (\r\n          moreResults !== null &&\r\n          !this.isScrolledIntoView(igoList, moreResults)\r\n        ) {\r\n          igoList.scrollTop =\r\n            moreResults.offsetTop +\r\n            moreResults.offsetHeight -\r\n            igoList.clientHeight;\r\n        }\r\n      });\r\n    }, 250);\r\n  }\r\n\r\n  computeElementRef() {\r\n    const items = document.getElementsByTagName('igo-search-results-item');\r\n    const igoList = this.elRef.nativeElement.getElementsByTagName(\r\n      'igo-list'\r\n    )[0];\r\n    let selectedItem;\r\n    // eslint-disable-next-line\r\n    for (let i = 0; i < items.length; i++) {\r\n      if (items[i].className.includes('igo-list-item-selected')) {\r\n        selectedItem = items[i];\r\n      }\r\n    }\r\n    return [igoList, selectedItem];\r\n  }\r\n\r\n  adjustTopPanel(elemSource, elem) {\r\n    if (!this.isScrolledIntoView(elemSource, elem)) {\r\n      elemSource.scrollTop =\r\n        elem.offsetTop +\r\n        elem.children[0].offsetHeight -\r\n        elemSource.clientHeight;\r\n    }\r\n  }\r\n\r\n  zoomToFeatureExtent() {\r\n    if (this.feature.geometry) {\r\n      const localOlFeature = this.format.readFeature(this.feature, {\r\n        dataProjection: this.feature.projection,\r\n        featureProjection: this.map.projection\r\n      });\r\n      moveToOlFeatures(this.map, [localOlFeature], FeatureMotion.Zoom);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Try to add a feature to the map overlay\r\n   * @param result A search result that could be a feature\r\n   */\r\n  private tryAddFeatureToMap(result: SearchResult) {\r\n    if (result.meta.dataType !== FEATURE) {\r\n      return undefined;\r\n    }\r\n    const feature = (result as SearchResult<Feature>).data;\r\n\r\n    // Somethimes features have no geometry. It happens with some GetFeatureInfo\r\n    if (!feature.geometry) {\r\n      return;\r\n    }\r\n\r\n    feature.meta.style = getCommonVectorSelectedStyle(\r\n      Object.assign({},\r\n        { feature },\r\n        this.searchState.searchOverlayStyleSelection,\r\n        result.style?.selection ? result.style.selection : {}));\r\n\r\n    this.map.searchResultsOverlay.addFeature(feature);\r\n  }\r\n\r\n  isScrolledIntoView(elemSource, elem) {\r\n    const padding = 6;\r\n    const docViewTop = elemSource.scrollTop;\r\n    const docViewBottom = docViewTop + elemSource.clientHeight;\r\n\r\n    const elemTop = elem.offsetTop;\r\n    const elemBottom = elemTop + elem.clientHeight + padding;\r\n    return elemBottom <= docViewBottom && elemTop >= docViewTop;\r\n  }\r\n\r\n  getRoute() {\r\n    //this.toolState.toolbox.activateTool('directions');\r\n    this.directionState.stopsStore.clearStops();\r\n    setTimeout(() => {\r\n      let routingCoordLoaded = false;\r\n      if (this.getRoute$$) { this.getRoute$$.unsubscribe(); }\r\n      this.getRoute$$ = this.directionState.stopsStore.storeInitialized$.subscribe((init: boolean) => {\r\n        if (this.directionState.stopsStore.storeInitialized$.value && !routingCoordLoaded) {\r\n          routingCoordLoaded = true;\r\n          const stop = this.directionState.stopsStore.all().find((e) => e.position === 1);\r\n          let coord;\r\n          if (this.feature.geometry) {\r\n            if (this.feature.geometry.type === 'Point') {\r\n              coord = [this.feature.geometry.coordinates[0], this.feature.geometry.coordinates[1]];\r\n            } else {\r\n              const point = pointOnFeature(this.feature.geometry);\r\n              coord = [point.geometry.coordinates[0], point.geometry.coordinates[1]];\r\n            }\r\n          }\r\n          stop.text = this.featureTitle;\r\n          stop.coordinates = coord;\r\n          this.directionState.stopsStore.update(stop);\r\n          if (this.map.geolocationController.position$.value) {\r\n            const currentPos = this.map.geolocationController.position$.value;\r\n            const stop = this.directionState.stopsStore.all().find((e) => e.position === 0);\r\n            const currentCoord = olProj.transform(currentPos.position, currentPos.projection, 'EPSG:4326');\r\n            const coord: [number,number] = roundCoordTo([currentCoord[0], currentCoord[1]], 6);\r\n            stop.text = coord.join(',');\r\n            stop.coordinates = coord;\r\n            this.directionState.stopsStore.update(stop);\r\n          }\r\n\r\n        }\r\n      });\r\n    }, 250);\r\n  }\r\n}\r\n","\r\n<div class=\"flextable\" role=\"table\" class=\"igo-striped mat-typography table-container\" *ngIf=\"ready && feature && feature.properties\">\r\n  \r\n\r\n    <div *ngFor=\"let property of filterFeatureProperties(feature) | keyvalue\" title={{property.key}}>\r\n\r\n      <div class=\"table-row\">\r\n        <div *ngIf=\"feature.properties.target === '_blank' && property.key === 'url'\" class=\"key flex-row\" role=\"rowheader\">\r\n          <mat-icon mat-list-avatar svgIcon=\"{{icon}}\"></mat-icon>\r\n        </div>\r\n      \r\n        <div *ngIf=\"feature.properties.target === '_blank' && property.key === 'url'\" class=\"key flex-row\" role=\"rowheader\">\r\n          <a href=\"{{property.value}}\" target='_blank' rel=\"noopener noreferrer\"> {{ 'igo.geo.targetHtmlUrl' | translate }} {{title}}</a>\r\n          <button class=\"copyClipboard\" mat-icon-button (click)=\"copyTextToClipboard(property.value)\">\r\n            <mat-icon svgIcon=\"content-copy\"></mat-icon>\r\n          </button>\r\n        </div>\r\n\r\n        <div id=\"keyValue\" *ngIf=\"feature.properties.target === undefined\" class=\"key flex-row\" role=\"rowheader\">\r\n          {{property.key}}\r\n        </div>\r\n\r\n        <div *ngIf=\"feature.properties.target === undefined && !isObject(property.value) && !isUrl(property.value) && !isEmbeddedLink(property.value)\" [innerHTML]=\"property.value\"\r\n          class=\"value flex-row\" role=\"cell\">\r\n        </div>\r\n\r\n        <div *ngIf=\"feature.properties.target === undefined && isEmbeddedLink(property.value)\"\r\n          class=\"value flex-row\" role=\"cell\">\r\n          <u [ngStyle]=\"{'cursor': 'pointer', 'color': 'blue'}\" (click)=\"openSecureUrl(property.value)\">{{ getEmbeddedLinkText(property.value) }}</u>\r\n        </div>\r\n\r\n        <div *ngIf=\"feature.properties.target === undefined && !isObject(property.value) && (isDoc(property.value) || isUrl(property.value)) && !isImg(property.value)\"\r\n          class=\"value flex-row\" role=\"cell\">\r\n          <u [ngStyle]=\"{'cursor': 'pointer', 'color': 'blue'}\" (click)=\"openSecureUrl(property.value)\">{{ 'igo.geo.targetHtmlUrl' | translate }}</u>\r\n          <button class=\"copyClipboard\" mat-icon-button (click)=\"copyTextToClipboard(property.value)\">\r\n            <mat-icon svgIcon=\"content-copy\"></mat-icon>\r\n          </button>\r\n        </div>\r\n\r\n        <div *ngIf=\"feature.properties.target === undefined && !isObject(property.value) && isUrl(property.value) && isImg(property.value)\"\r\n          class=\"value flex-row\" role=\"cell\">\r\n          <a href=\"{{property.value}}\" target='_blank' (click)=\"openSecureUrl(property.value)\" rel=\"noopener noreferrer\">\r\n            <img igoImageError src=\"{{(property.value | secureImage) | async}}\" width=\"225\" height=\"auto\">\r\n          </a>\r\n        </div>\r\n\r\n        <div *ngIf=\"feature.properties.target === undefined && isObject(property.value)\" [innerHTML]=\"property.value | json\" class=\"value flex-row\" role=\"cell\">\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n  </div>","import {\r\n  Component,\r\n  Input,\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n  Output,\r\n  EventEmitter,\r\n  OnDestroy,\r\n  OnInit,\r\n} from '@angular/core';\r\n\r\nimport { Subject } from 'rxjs';\r\nimport { takeUntil } from 'rxjs/operators';\r\nimport { NetworkService, ConnectionState, MessageService } from '@igo2/core';\r\nimport { ConfigService } from '@igo2/core';\r\nimport { SearchSource, IgoMap, Feature } from '@igo2/geo';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Clipboard } from '@igo2/utils';\r\n\r\n@Component({\r\n  selector: 'app-feature-details',\r\n  templateUrl: './feature-details.component.html',\r\n  styleUrls: ['./feature-details.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n\r\nexport class FeatureDetailsComponent implements OnDestroy, OnInit {\r\n  private state: ConnectionState;\r\n  private unsubscribe$ = new Subject<void>();\r\n\r\n  @Input()\r\n  get source(): SearchSource {\r\n    return this._source;\r\n  }\r\n  set source(value: SearchSource) {\r\n    this._source = value;\r\n    this.cdRef.detectChanges();\r\n  }\r\n\r\n  @Input() map: IgoMap;\r\n\r\n  @Input()\r\n  get feature(): Feature {\r\n    return this._feature;\r\n  }\r\n  set feature(value: Feature) {\r\n    this._feature = value;\r\n    this.cdRef.detectChanges();\r\n    this.selectFeature.emit();\r\n  }\r\n\r\n  @Input() mobile: boolean;\r\n  @Input() mapQueryClick: boolean;\r\n  @Output() mapQuery = new EventEmitter<boolean>();\r\n\r\n  private _feature: Feature;\r\n  private _source: SearchSource;\r\n  public featureTitle: string;\r\n\r\n  @Output() selectFeature = new EventEmitter<boolean>();\r\n\r\n  public title: string;\r\n\r\n  public ready : boolean;\r\n\r\n  constructor(\r\n    private cdRef: ChangeDetectorRef,\r\n    private networkService: NetworkService,\r\n    private configService: ConfigService,\r\n    private http: HttpClient,\r\n    private messageService: MessageService,\r\n  ) {\r\n    this.networkService.currentState().pipe(takeUntil(this.unsubscribe$)).subscribe((state: ConnectionState) => {\r\n      this.state = state;\r\n    });\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.ready = true;\r\n    this.title = this.feature.properties.value;\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.mapQuery.emit(false);\r\n    this.unsubscribe$.next();\r\n    this.unsubscribe$.complete();\r\n  }\r\n\r\n  formatReading(reading: number): string {\r\n    return reading.toString().replace(\".\", \",\");\r\n  }\r\n\r\n    /**\r\n   * @internal\r\n   */\r\n\r\n  isObject(value) {\r\n    return typeof value === 'object';\r\n  }\r\n\r\n  isDoc(value) {\r\n    if (typeof value === 'string') {\r\n      if (this.isUrl(value)) {\r\n        const regex = /(pdf|docx?|xlsx?)$/;\r\n        return regex.test(value.toLowerCase());\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n\r\n  isUrl(value) {\r\n    if (typeof value === 'string') {\r\n      const regex = /^https?:\\/\\//;\r\n      return regex.test(value);\r\n    }\r\n  }\r\n\r\n  isImg(value) {\r\n    if (typeof value ==='string') {\r\n      if (this.isUrl(value)) {\r\n        const regex = /(jpe?g|png|gif)$/;\r\n        return regex.test(value.toLowerCase());\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n\r\n  isEmbeddedLink(value) {\r\n    if (typeof value === 'string') {\r\n        const matchRegex = /<a/g;\r\n        const match = value.match(matchRegex) || [];\r\n        const count = match.length;\r\n        if (count === 1) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n    return false;\r\n  }\r\n\r\nopenSecureUrl(value) {\r\n  let url: string;\r\n  const regexDepot = new RegExp(this.configService?.getConfig('depot.url') + '.*?(?=\"|$)');\r\n\r\n  if (regexDepot.test(value)) {\r\n    url = value.match(regexDepot)[0];\r\n\r\n    this.http.get(url, {\r\n      responseType: 'blob'\r\n    })\r\n    .subscribe((docOrImage) => {\r\n      const fileUrl = URL.createObjectURL(docOrImage);\r\n      window.open(fileUrl, '_blank');\r\n      this.cdRef.detectChanges();\r\n    },\r\n    (error: Error) => {\r\n      this.messageService.error('igo.geo.targetHtmlUrlUnauthorized', 'igo.geo.targetHtmlUrlUnauthorizedTitle');\r\n    });\r\n  } else {\r\n    let url = value;\r\n    if (this.isEmbeddedLink(value)) {\r\n      var div = document.createElement('div');\r\n      div.innerHTML = value;\r\n      url = div.children[0].getAttribute('href');\r\n    }\r\n    window.open(url, '_blank');\r\n  }\r\n}\r\n\r\ngetEmbeddedLinkText(value) {\r\n  const regex = /(?:>).*?(?=<|$)/;\r\n  let text = value.match(regex)[0] as string;\r\n  text = text.replace(/>/g, '');\r\n  return text;\r\n}\r\n\r\nfilterFeatureProperties(feature) {\r\n  const allowedFieldsAndAlias = feature.meta ? feature.meta.alias : undefined;\r\n  this.featureTitle = feature.meta ? feature.meta.title : undefined; // will define the feature info title in the panel\r\n  const properties = {};\r\n  let offlineButtonState;\r\n\r\n  if (feature.properties && feature.properties.Route) {\r\n    delete feature.properties.Route;\r\n  }\r\n\r\n  if (allowedFieldsAndAlias) {\r\n    Object.keys(allowedFieldsAndAlias).forEach(field => {\r\n      properties[allowedFieldsAndAlias[field]] = feature.properties[field];\r\n    });\r\n    return properties;\r\n    } else if (offlineButtonState !== undefined) {\r\n      if (!offlineButtonState) {\r\n        if (this.state.connection && feature.meta && feature.meta.excludeAttribute) {\r\n          const excludeAttribute = feature.meta.excludeAttribute;\r\n          excludeAttribute.forEach(attribute => {\r\n            delete feature.properties[attribute];\r\n          });\r\n        } else if (!this.state.connection && feature.meta && feature.meta.excludeAttributeOffline) {\r\n          const excludeAttributeOffline = feature.meta.excludeAttributeOffline;\r\n          excludeAttributeOffline.forEach(attribute => {\r\n            delete feature.properties[attribute];\r\n          });\r\n        }\r\n      } else {\r\n        if (feature.meta && feature.meta.excludeAttributeOffline) {\r\n          const excludeAttributeOffline = feature.meta.excludeAttributeOffline;\r\n          excludeAttributeOffline.forEach(attribute => {\r\n            delete feature.properties[attribute];\r\n          });\r\n        }\r\n      }\r\n    } else {\r\n      if (this.state.connection && feature.meta && feature.meta.excludeAttribute) {\r\n        const excludeAttribute = feature.meta.excludeAttribute;\r\n        excludeAttribute.forEach(attribute => {\r\n          delete feature.properties[attribute];\r\n        });\r\n      } else if (!this.state.connection && feature.meta && feature.meta.excludeAttributeOffline) {\r\n        const excludeAttributeOffline = feature.meta.excludeAttributeOffline;\r\n        excludeAttributeOffline.forEach(attribute => {\r\n          delete feature.properties[attribute];\r\n        });\r\n      }\r\n    }\r\n\r\n    return feature.properties;\r\n  }\r\n\r\n    /**\r\n   * Copy the url to a clipboard\r\n   */\r\n    copyTextToClipboard(value: string): void {\r\n      const successful = Clipboard.copy(value);\r\n      if (successful) {\r\n        this.messageService.success('igo.geo.query.link.message');\r\n      }\r\n    }\r\n\r\n}\r\n","\r\n<div class=\"flextable\" role=\"table\" class=\"igo-striped mat-typography table-container\" *ngIf=\"ready && feature && feature.properties\">\r\n  Custom feature details template\r\n  <mat-icon\r\n    class=\"info\"\r\n    color=\"primary\"\r\n    svgIcon=\"information\"\r\n    [matTooltip]=\"('feature.tooltip'| translate)\"\r\n    [matTooltipPosition]=\"mobile? 'above' : 'right'\"\r\n    [matTooltipClass]=\"mobile? 'tooltip-above' : 'tooltip-right'\">\r\n  </mat-icon> <!-- customise this template as you wish, even by layer using feature.meta.id or other layers metadatas -->\r\n\r\n    <div *ngFor=\"let property of filterFeatureProperties(feature) | keyvalue\">\r\n\r\n      <div class=\"table-row\">\r\n        <div *ngIf=\"feature.properties.target === '_blank' && property.key === 'url'\" class=\"key flex-row\" role=\"rowheader\">\r\n          <mat-icon mat-list-avatar svgIcon=\"{{icon}}\"></mat-icon>\r\n        </div>\r\n      \r\n        <div *ngIf=\"feature.properties.target === '_blank' && property.key === 'url'\" class=\"key flex-row\" role=\"rowheader\">\r\n          <a href=\"{{property.value}}\" target='_blank' rel=\"noopener noreferrer\"> {{ 'igo.geo.targetHtmlUrl' | translate }} {{title}}</a>\r\n          <button class=\"copyClipboard\" mat-icon-button (click)=\"copyTextToClipboard(property.value)\">\r\n            <mat-icon svgIcon=\"content-copy\"></mat-icon>\r\n          </button>\r\n        </div>\r\n\r\n        <div id=\"keyValue\" *ngIf=\"feature.properties.target === undefined\" class=\"key flex-row\" role=\"rowheader\">\r\n          {{property.key}}\r\n        </div>\r\n\r\n        <div *ngIf=\"feature.properties.target === undefined && !isObject(property.value) && !isUrl(property.value) && !isEmbeddedLink(property.value)\" [innerHTML]=\"property.value\"\r\n          class=\"value flex-row\" role=\"cell\">\r\n        </div>\r\n\r\n        <div *ngIf=\"feature.properties.target === undefined && isEmbeddedLink(property.value)\"\r\n          class=\"value flex-row\" role=\"cell\">\r\n          <u [ngStyle]=\"{'cursor': 'pointer', 'color': 'blue'}\" (click)=\"openSecureUrl(property.value)\">{{ getEmbeddedLinkText(property.value) }}</u>\r\n        </div>\r\n\r\n        <div *ngIf=\"feature.properties.target === undefined && !isObject(property.value) && (isDoc(property.value) || isUrl(property.value)) && !isImg(property.value)\"\r\n          class=\"value flex-row\" role=\"cell\">\r\n          <u [ngStyle]=\"{'cursor': 'pointer', 'color': 'blue'}\" (click)=\"openSecureUrl(property.value)\">{{ 'igo.geo.targetHtmlUrl' | translate }}</u>\r\n          <button class=\"copyClipboard\" mat-icon-button (click)=\"copyTextToClipboard(property.value)\">\r\n            <mat-icon svgIcon=\"content-copy\"></mat-icon>\r\n          </button>\r\n        </div>\r\n\r\n        <div *ngIf=\"feature.properties.target === undefined && !isObject(property.value) && isUrl(property.value) && isImg(property.value)\"\r\n          class=\"value flex-row\" role=\"cell\">\r\n          <a href=\"{{property.value}}\" target='_blank' (click)=\"openSecureUrl(property.value)\" rel=\"noopener noreferrer\">\r\n            <img igoImageError src=\"{{(property.value | secureImage) | async}}\" width=\"225\" height=\"auto\">\r\n          </a>\r\n        </div>\r\n\r\n        <div *ngIf=\"feature.properties.target === undefined && isObject(property.value)\" [innerHTML]=\"property.value | json\" class=\"value flex-row\" role=\"cell\">\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n  </div>","import {\r\n  Component,\r\n  Input,\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n  Output,\r\n  EventEmitter,\r\n  OnDestroy,\r\n  OnInit,\r\n} from '@angular/core';\r\n\r\nimport { Subject } from 'rxjs';\r\nimport { takeUntil } from 'rxjs/operators';\r\nimport { NetworkService, ConnectionState, LanguageService, MessageService } from '@igo2/core';\r\nimport { ConfigService } from '@igo2/core';\r\nimport { SearchSource, IgoMap, Feature } from '@igo2/geo';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { TooltipPosition } from '@angular/material/tooltip';\r\nimport { getEntityTitle } from '@igo2/common';\r\n\r\n@Component({\r\n  selector: 'app-feature-details-custom',\r\n  templateUrl: './feature-details-custom.component.html',\r\n  styleUrls: ['./feature-details-custom.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\n\r\nexport class FeatureDetailsCustomComponent implements OnDestroy, OnInit {\r\n  private state: ConnectionState;\r\n  private unsubscribe$ = new Subject<void>();\r\n\r\n  @Input()\r\n  get source(): SearchSource {\r\n    return this._source;\r\n  }\r\n  set source(value: SearchSource) {\r\n    this._source = value;\r\n    this.cdRef.detectChanges();\r\n  }\r\n\r\n  @Input() map: IgoMap;\r\n\r\n  @Input()\r\n  get feature(): Feature {\r\n    return this._feature;\r\n  }\r\n  set feature(value: Feature) {\r\n    this._feature = value;\r\n    this.cdRef.detectChanges();\r\n    this.selectFeature.emit();\r\n  }\r\n\r\n  @Input()\r\n  get mobile(): boolean {\r\n    return this._mobile;\r\n  }\r\n  set mobile(value: boolean) {\r\n    this._mobile = value;\r\n  }\r\n  private _mobile: boolean;\r\n\r\n  @Input()\r\n  get mapQueryClick(): boolean {\r\n    return this._mapQueryClick;\r\n  }\r\n  set mapQueryClick(value: boolean) {\r\n    this._mapQueryClick = value;\r\n  }\r\n  private _mapQueryClick: boolean;\r\n\r\n  private _feature: Feature;\r\n  private _source: SearchSource;\r\n  public featureTitle: string;\r\n\r\n  @Output() selectFeature = new EventEmitter<boolean>();\r\n\r\n  @Input()\r\n  matTooltipPosition: TooltipPosition;\r\n\r\n  public ready : boolean;\r\n\r\n  constructor(\r\n    private cdRef: ChangeDetectorRef,\r\n    private networkService: NetworkService,\r\n    private languageService: LanguageService,\r\n    private configService: ConfigService,\r\n    private http: HttpClient,\r\n    private messageService: MessageService,\r\n  ) {\r\n    this.networkService.currentState().pipe(takeUntil(this.unsubscribe$)).subscribe((state: ConnectionState) => {\r\n      this.state = state;\r\n    });\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.ready = true;\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.mapQueryClick = false;\r\n    this.unsubscribe$.next();\r\n    this.unsubscribe$.complete();\r\n  }\r\n\r\n  formatReading(reading: number): string {\r\n    return reading.toString().replace(\".\", \",\");\r\n  }\r\n\r\n  tooltipPosition(){\r\n    if (this.mobile) {\r\n      this.matTooltipPosition = 'above';\r\n    } else {\r\n      this.matTooltipPosition = 'right';\r\n    }\r\n  }\r\n\r\n    /**\r\n   * @internal\r\n   */\r\n    get title(): string {\r\n      return getEntityTitle(this.feature);\r\n    }\r\n\r\n  isObject(value) {\r\n    return typeof value === 'object';\r\n  }\r\n\r\n  isDoc(value) {\r\n    if (typeof value === 'string') {\r\n      if (this.isUrl(value)) {\r\n        const regex = /(pdf|docx?|xlsx?)$/;\r\n        return regex.test(value.toLowerCase());\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n\r\n  isUrl(value) {\r\n    if (typeof value === 'string') {\r\n      const regex = /^https?:\\/\\//;\r\n      return regex.test(value);\r\n    }\r\n  }\r\n\r\n  isImg(value) {\r\n    if (typeof value ==='string') {\r\n      if (this.isUrl(value)) {\r\n        const regex = /(jpe?g|png|gif)$/;\r\n        return regex.test(value.toLowerCase());\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n\r\n  isEmbeddedLink(value) {\r\n    if (typeof value === 'string') {\r\n        const matchRegex = /<a/g;\r\n        const match = value.match(matchRegex) || [];\r\n        const count = match.length;\r\n        if (count === 1) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n    return false;\r\n  }\r\n\r\nopenSecureUrl(value) {\r\n  let url: string;\r\n  const regexDepot = new RegExp(this.configService?.getConfig('depot.url') + '.*?(?=\"|$)');\r\n\r\n  if (regexDepot.test(value)) {\r\n    url = value.match(regexDepot)[0];\r\n\r\n    this.http.get(url, {\r\n      responseType: 'blob'\r\n    })\r\n    .subscribe((docOrImage) => {\r\n      const fileUrl = URL.createObjectURL(docOrImage);\r\n      window.open(fileUrl, '_blank');\r\n      this.cdRef.detectChanges();\r\n    },\r\n    (error: Error) => {\r\n      this.messageService.error('igo.geo.targetHtmlUrlUnauthorized', 'igo.geo.targetHtmlUrlUnauthorizedTitle');\r\n    });\r\n  } else {\r\n    let url = value;\r\n    if (this.isEmbeddedLink(value)) {\r\n      var div = document.createElement('div');\r\n      div.innerHTML = value;\r\n      url = div.children[0].getAttribute('href');\r\n    }\r\n    window.open(url, '_blank');\r\n  }\r\n}\r\n\r\ngetEmbeddedLinkText(value) {\r\n  const regex = /(?:>).*?(?=<|$)/;\r\n  let text = value.match(regex)[0] as string;\r\n  text = text.replace(/>/g, '');\r\n  return text;\r\n}\r\n\r\nfilterFeatureProperties(feature) {\r\n  const allowedFieldsAndAlias = feature.meta ? feature.meta.alias : undefined;\r\n  this.featureTitle = feature.meta ? feature.meta.title : undefined; // will define the feature info title in the panel\r\n  const properties = {};\r\n\r\n  if (feature.properties && feature.properties.Route) {\r\n    delete feature.properties.Route;\r\n  }\r\n\r\n  if (allowedFieldsAndAlias) {\r\n    Object.keys(allowedFieldsAndAlias).forEach(field => {\r\n      properties[allowedFieldsAndAlias[field]] = feature.properties[field];\r\n    });\r\n    return properties;\r\n    } else {\r\n      if (this.state.connection && feature.meta && feature.meta.excludeAttribute) {\r\n        const excludeAttribute = feature.meta.excludeAttribute;\r\n        excludeAttribute.forEach(attribute => {\r\n          delete feature.properties[attribute];\r\n        });\r\n      } else if (!this.state.connection && feature.meta && feature.meta.excludeAttributeOffline) {\r\n        const excludeAttributeOffline = feature.meta.excludeAttributeOffline;\r\n        excludeAttributeOffline.forEach(attribute => {\r\n          delete feature.properties[attribute];\r\n        });\r\n      }\r\n    }\r\n    return feature.properties;\r\n  }\r\n\r\n}\r\n","<ng-container\r\n  *ngIf= \"(store.entities$ | async)\"\r\n  class = \"featureInfo\"\r\n  (keydown)= \"handleKeyboardEvent($event)\">\r\n  <span class= \"title\">\r\n\r\n    <h4 color=\"primary\" (click)= \"onTitleClick()\" style=\"cursor:pointer;\">{{title}}</h4>\r\n\r\n    <button\r\n      class=\"clear-button\"\r\n      mat-icon-button\r\n      igoStopPropagation\r\n      (click)= \"clearButton()\"\r\n      [matTooltip]= \"('feature.close'| translate)\"\r\n      color=\"primary\">\r\n      <mat-icon svgIcon=\"close\"></mat-icon>\r\n    </button>\r\n\r\n  </span>\r\n\r\n\r\n    <app-feature-details\r\n      *ngIf= \"resultSelected$.value && !customFeatureDetails\"\r\n      [mobile]= \"mobile\"\r\n      [feature]= \"resultSelected$.value.data\"\r\n      [mapQueryClick]= \"mapQueryClick\">\r\n    </app-feature-details>\r\n\r\n    <app-feature-details-custom\r\n      *ngIf= \"resultSelected$.value && customFeatureDetails \"\r\n      [mobile]= \"mobile\"\r\n      [feature]= \"resultSelected$.value.data\"\r\n      (mapQuery) =\"mapQueryFromFeatureDetails($event)\"\r\n      [mapQueryClick]= \"mapQueryClick\">\r\n    </app-feature-details-custom>\r\n\r\n</ng-container>","import {\r\n  Component,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  HostBinding,\r\n  HostListener,\r\n  ChangeDetectionStrategy,\r\n  OnInit,\r\n  OnDestroy\r\n} from '@angular/core';\r\nimport { BehaviorSubject, combineLatest, Subscription } from 'rxjs';\r\nimport { debounceTime } from 'rxjs/operators';\r\n\r\nimport {\r\n  EntityStore\r\n} from '@igo2/common';\r\nimport {\r\n  Feature,\r\n  SearchResult,\r\n  IgoMap,\r\n  FeatureMotion,\r\n  getCommonVectorStyle,\r\n  getCommonVectorSelectedStyle,\r\n  featuresAreOutOfView,\r\n  computeOlFeaturesExtent,\r\n  featureToOl\r\n} from '@igo2/geo';\r\nimport {\r\n  MediaService,\r\n  LanguageService,\r\n  StorageService,\r\n  ConfigService\r\n} from '@igo2/core';\r\nimport { QueryState, StorageState } from '@igo2/integration';\r\nimport { SearchState } from '../../search-results-tool/search.state';\r\n\r\n@Component({\r\n  selector: 'app-feature-info',\r\n  templateUrl: './feature-info.component.html',\r\n  styleUrls: ['./feature-info.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class FeatureInfoComponent implements OnInit, OnDestroy {\r\n\r\n  get storageService(): StorageService {\r\n    return this.storageState.storageService;\r\n  }\r\n\r\n  @Input()\r\n  get map(): IgoMap {\r\n    return this._map;\r\n  }\r\n  set map(value: IgoMap) {\r\n    this._map = value;\r\n  }\r\n  private _map: IgoMap;\r\n\r\n  @Input()\r\n  get store(): EntityStore<SearchResult<Feature>> {\r\n    return this._store;\r\n  }\r\n  set store(value: EntityStore<SearchResult<Feature>>) {\r\n    this._store = value;\r\n  }\r\n  private _store: EntityStore<SearchResult<Feature>>;\r\n\r\n  @Output() closeQuery = new EventEmitter<boolean>();\r\n\r\n  @Input() mapQueryClick: boolean;\r\n\r\n  @Output() mapQuery = new EventEmitter<boolean>();\r\n\r\n  @Input() panelOpenState: boolean;\r\n\r\n  @Input() mobile: boolean;\r\n\r\n  @Output() panelOpened = new EventEmitter<boolean>();\r\n\r\n  private isResultSelected$ = new BehaviorSubject(false);\r\n  public isSelectedResultOutOfView$ = new BehaviorSubject(false);\r\n  private isSelectedResultOutOfView$$: Subscription;\r\n  private initialized = true;\r\n  public featureTitle: string;\r\n  public title: string;\r\n  public customFeatureTitle: boolean;\r\n  public customFeatureDetails: boolean;\r\n\r\n  @Input()\r\n  get feature(): Feature {\r\n    return this._feature;\r\n  }\r\n  set feature(value: Feature) {\r\n    this._feature = value;\r\n  }\r\n  private _feature: Feature;\r\n\r\n  private resultOrResolution$$: Subscription;\r\n\r\n  resultSelected$ = new BehaviorSubject<SearchResult<Feature>>(undefined);\r\n\r\n  @HostBinding('style.visibility')\r\n  get displayStyle() {\r\n    if (this.results.length) {\r\n      if (this.results.length === 1 && this.initialized) {\r\n        this.selectResult(this.results[0]);\r\n      }\r\n      return 'visible';\r\n    }\r\n    return 'hidden';\r\n  }\r\n\r\n  @HostListener('document:keydown.escape', ['$event']) onEscapeHandler(\r\n    event: KeyboardEvent\r\n  ) {\r\n    this.clearButton();\r\n  }\r\n\r\n  get results(): SearchResult<Feature>[] {\r\n    return this.store.all();\r\n  }\r\n\r\n  get searchStore(): EntityStore<SearchResult> {\r\n    return this.searchState.store;\r\n  }\r\n\r\n  @Input()\r\n  get mapQueryInit(): boolean { return this._mapQueryInit; }\r\n  set mapQueryInit(mapQueryInit: boolean) {\r\n    this._mapQueryInit = mapQueryInit;\r\n  }\r\n  private _mapQueryInit = false;\r\n\r\n  constructor(\r\n    public mediaService: MediaService,\r\n    public languageService: LanguageService,\r\n    private storageState: StorageState,\r\n    private queryState: QueryState,\r\n    private configService: ConfigService,\r\n    private searchState: SearchState\r\n  ) {\r\n    this.customFeatureTitle = this.configService.getConfig('customFeatureTitle') === undefined ? false :\r\n      this.configService.getConfig('customFeatureTitle');\r\n    this.customFeatureDetails = this.configService.getConfig('customFeatureDetails') === undefined ? false :\r\n      this.configService.getConfig('customFeatureDetails');\r\n  }\r\n\r\n  private monitorResultOutOfView() {\r\n    this.isSelectedResultOutOfView$$ = combineLatest([\r\n      this.map.viewController.state$,\r\n      this.resultSelected$\r\n    ])\r\n      .pipe(debounceTime(100))\r\n      .subscribe((bunch) => {\r\n        const selectedResult = bunch[1];\r\n        if (!selectedResult) {\r\n          this.isSelectedResultOutOfView$.next(false);\r\n          return;\r\n        }\r\n        const selectedOlFeature = featureToOl(selectedResult.data, this.map.projection);\r\n        const selectedOlFeatureExtent = computeOlFeaturesExtent(this.map, [selectedOlFeature]);\r\n        this.isSelectedResultOutOfView$.next(featuresAreOutOfView(this.map, selectedOlFeatureExtent));\r\n      });\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.store.entities$.subscribe(() => {\r\n      this.initialized = true;\r\n    });\r\n    this.monitorResultOutOfView();\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.clearButton();\r\n    if (this.resultOrResolution$$) {\r\n      this.resultOrResolution$$.unsubscribe();\r\n    }\r\n    if (this.isSelectedResultOutOfView$$) {\r\n      this.isSelectedResultOutOfView$$.unsubscribe();\r\n    }\r\n  }\r\n\r\n  onTitleClick(){\r\n    /// define your own function, ex zoom to feature\r\n    this.closeQuery.emit();\r\n  }\r\n\r\n  selectResult(result: SearchResult<Feature>) {\r\n    this.store.state.update(\r\n      result,\r\n      {\r\n        focused: true,\r\n        selected: true\r\n      },\r\n      true\r\n    );\r\n    this.resultSelected$.next(result);\r\n\r\n    const features = [];\r\n    for (const feature of this.store.all()) {\r\n      if (feature.meta.id === result.meta.id) {\r\n        feature.data.meta.style = getCommonVectorSelectedStyle(\r\n          Object.assign({}, { feature: feature.data },\r\n            this.queryState.queryOverlayStyleSelection));\r\n        feature.data.meta.style.setZIndex(2000);\r\n      } else {\r\n        feature.data.meta.style = getCommonVectorStyle(\r\n          Object.assign({},\r\n            { feature: feature.data },\r\n            this.queryState.queryOverlayStyle));\r\n      }\r\n      features.push(feature.data);\r\n      this.featureTitle = feature.meta.title; // will define the feature info title in the panel\r\n      this.getTitle();\r\n    }\r\n    this.map.queryResultsOverlay.removeFeatures(features);\r\n    this.map.queryResultsOverlay.addFeatures(features, FeatureMotion.None);\r\n\r\n    this.isResultSelected$.next(true);\r\n    this.initialized = false;\r\n  }\r\n\r\n  getTitle(){\r\n    this.title = this.customFeatureTitle? this.languageService.translate.instant('feature.title') : this.featureTitle;\r\n  }\r\n\r\n  public unselectResult() {\r\n    this.resultSelected$.next(undefined);\r\n    this.isResultSelected$.next(false);\r\n    this.store.state.clear();\r\n\r\n    const features = [];\r\n    for (const feature of this.store.all()) {\r\n      feature.data.meta.style = getCommonVectorStyle(\r\n        Object.assign({},\r\n          { feature: feature.data },\r\n          this.queryState.queryOverlayStyle));\r\n      features.push(feature.data);\r\n    }\r\n    this.map.queryResultsOverlay.setFeatures(features, FeatureMotion.None, 'map');\r\n  }\r\n\r\n  public clearButton() {\r\n    this.map.queryResultsOverlay.clear();\r\n    this.store.clear();\r\n    this.unselectResult();\r\n    this.mapQuery.emit(false);\r\n    this.panelOpened.emit(false);\r\n    this.closeQuery.emit();\r\n  }\r\n\r\n  mapQueryFromFeatureDetails(event) {\r\n    this.mapQuery.emit(event);\r\n  }\r\n\r\n}\r\n","<div id=\"sidepanel\" class=\"sidepanel\">\r\n  <mat-sidenav \r\n    #sidenav\r\n    mode=\"side\"\r\n    [autoFocus]=\"false\"\r\n    [(opened)]=\"panelOpenState\"\r\n    (closed)= \"closePanelLegend()\"\r\n    (closeLegend)=\"closePanelLegend()\">\r\n\r\n    <div #content class=\"app-sidenav-content\">\r\n\r\n      <div id=\"legend\" *ngIf=\"legendPanelOpened\" [mapQueryClick]=\"mapQueryClick\" [legendPanelOpened]=\"legendPanelOpened\" [panelOpenState]=\"panelOpenState\" >\r\n        <button\r\n          mat-icon-button\r\n          [matTooltip]=\"'legend.close' | translate\"\r\n          color=\"primary\"\r\n          (click)=\"closePanelLegend()\"><mat-icon svgIcon=\"close\"></mat-icon>\r\n        </button>\r\n        <h4 mat-dialog-title>{{ 'legend.title' | translate }}</h4>\r\n        <igo-layer-legend-list\r\n          [layers]=\"mapLayersShownInLegend\"\r\n          [excludeBaseLayers]=\"true\"\r\n          [allowShowAllLegends]=\"false\"\r\n          [updateLegendOnResolutionChange]=\"true\"\r\n          [showAllLegendsValue]=\"false\"\r\n          [layers]=\"layers\">\r\n        </igo-layer-legend-list>\r\n      </div>\r\n\r\n      <div style=\"margin: 24px;\" *ngIf=\"!searchInit && (queryStore.empty$ | async)===true && !legendPanelOpened\">\r\n        <section class=\"mat-typography\">\r\n          <h5><strong>{{ 'igo.integration.searchResultsTool.noResults' | translate }}</strong></h5>\r\n          <h6><strong>{{ 'igo.integration.searchResultsTool.doSearch' | translate }}</strong></h6>\r\n          <p [innerHTML]=\"'igo.integration.searchResultsTool.examples' | translate\"></p>\r\n      </section>\r\n      </div>\r\n\r\n      <div #getInfo *ngIf=\"mapQueryClick\">\r\n\r\n        <app-feature-info\r\n          [map]=\"map\"\r\n          [mobile]=\"mobile\"\r\n          [store]=\"queryStore\"\r\n          [mapQueryClick]=\"mapQueryClick\"\r\n          (closeQuery)=\"closePanelOnCloseQuery()\"\r\n          (clearSearchbarterm)=\"$event\"\r\n          (panelOpened)= \"panelOpenedFromFeature($event)\"\r\n          (mapQuery)= \"mapQueryFromFeature($event)\"\r\n          [title]=\"featureTitle\"\r\n          [hasFeatureEmphasisOnSelection]=\"hasFeatureEmphasisOnSelection\">\r\n        </app-feature-info>\r\n\r\n      </div>\r\n\r\n      <div #search *ngIf=\"searchInit\">\r\n        <app-search-results-tool \r\n          #searchresults\r\n          [showIcons]=\"true\"\r\n          placeholder=\"false\"\r\n          [mapQueryClick]=\"mapQueryClick\"\r\n          [legendPanelOpened]=\"legendPanelOpened\"\r\n          [panelOpenState]=\"panelOpenState\"\r\n          [searchInit]=\"searchInit\"\r\n          >\r\n        </app-search-results-tool>\r\n    </div></div>\r\n\r\n  </mat-sidenav>\r\n  <button\r\n    [ngClass]=\"sidenav.opened ? 'sidepanel-opened' : 'sidepanel-closed'\"\r\n    #sidenavbutton\r\n    mat-raised-button\r\n    color=\"primary\"\r\n    id=\"sidepanel-button\"\r\n    isRoundButton=false\r\n    isIconButton=true\r\n    MatDrawerMode=\"push\"\r\n    [matTooltip]=\"sidenav.opened ? ('sidePanel.close' | translate) : 'sidePanel.open' | translate\"\r\n    matTooltipPosition=\"after\"\r\n    (click)=\"sidenav.toggle()\">\r\n    <mat-icon\r\n      class=\"icon\"\r\n      [svgIcon]=\"sidenav.opened ? 'chevron-left' : 'chevron-right'\">\r\n    </mat-icon>\r\n  </button>\r\n</div>","import {\r\n  Component,\r\n  Input,\r\n  Output,\r\n  OnInit,\r\n  OnDestroy,\r\n  EventEmitter,\r\n  ChangeDetectionStrategy,\r\n  HostListener,\r\n  ChangeDetectorRef\r\n} from '@angular/core';\r\n\r\nimport { EntityStore, ActionStore } from '@igo2/common';\r\n\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\nimport {\r\n  IgoMap,\r\n  FEATURE,\r\n  Feature,\r\n  FeatureMotion,\r\n  SearchResult,\r\n  Layer\r\n} from '@igo2/geo';\r\nimport { QueryState } from '@igo2/integration';\r\nimport { ConfigService } from '@igo2/core';\r\nimport { SearchState } from '../search-results-tool/search.state';\r\n\r\n@Component({\r\n  selector: 'app-sidepanel',\r\n  templateUrl: './sidepanel.component.html',\r\n  styleUrls: ['./sidepanel.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class SidePanelComponent implements OnInit, OnDestroy {\r\n  title$: BehaviorSubject<string> = new BehaviorSubject<string>(undefined);\r\n\r\n  @Input()\r\n  get map(): IgoMap {\r\n    return this._map;\r\n  }\r\n  set map(value: IgoMap) {\r\n    this._map = value;\r\n  }\r\n  private _map: IgoMap;\r\n\r\n  @Input()\r\n  get opened(): boolean {\r\n    return this._opened;\r\n  }\r\n  set opened(value: boolean) {\r\n    if (value === this._opened) {\r\n      return;\r\n    }\r\n\r\n    this._opened = value;\r\n    this.openedChange.emit(this._opened);\r\n  }\r\n  private _opened: boolean;\r\n\r\n  @Output() openedChange = new EventEmitter<boolean>();\r\n\r\n  @Input() mobile: boolean; // for tooltipPosition in featureDetails\r\n\r\n  @Input() mapQueryClick: boolean;\r\n\r\n  @Output() mapQuery = new EventEmitter<boolean>();\r\n\r\n  get queryStore(): EntityStore<SearchResult> {\r\n    return this.queryState.store;\r\n  }\r\n\r\n  @Output() selectFeature = new EventEmitter<boolean>();\r\n\r\n  @Input()\r\n  get feature(): Feature {\r\n    return this._feature;\r\n  }\r\n  set feature(value: Feature) {\r\n    this._feature = value;\r\n    this.cdRef.detectChanges();\r\n    this.selectFeature.emit();\r\n  }\r\n  private _feature: Feature;\r\n\r\n  public selectedFeature: Feature;\r\n  public hasFeatureEmphasisOnSelection: Boolean = true;\r\n\r\n  @Input() featureTitle: string;\r\n\r\n  @Input()\r\n  get searchInit(): boolean {\r\n    return this._searchInit;\r\n  }\r\n  set searchInit(value: boolean) {\r\n    this._searchInit = value;\r\n  }\r\n  private _searchInit: boolean;\r\n\r\n  public store = new ActionStore([]);\r\n\r\n  public lonlat;\r\n  public mapProjection: string;\r\n\r\n  public settingsChange$ = new BehaviorSubject<boolean>(undefined);\r\n\r\n  get searchStore(): EntityStore<SearchResult> {\r\n    return this.searchState.store;\r\n  }\r\n\r\n  @Input()\r\n  get layers(): Layer[] {\r\n    return this._layers;\r\n  }\r\n  set layers(value: Layer[]) {\r\n    this._layers = value;\r\n  }\r\n  private _layers: Layer[];\r\n\r\n  @Input()\r\n  get legendPanelOpened(): boolean {\r\n    return this._legendPanelOpened;\r\n  }\r\n  set legendPanelOpened(value: boolean) {\r\n    this._legendPanelOpened = value;\r\n  }\r\n  private _legendPanelOpened: boolean;\r\n\r\n  @Input() panelOpenState: boolean;\r\n\r\n  @Output() closeLegend = new EventEmitter<boolean>();\r\n  @Output() closeQuery = new EventEmitter<boolean>();\r\n  @Output() panelOpened = new EventEmitter<boolean>();\r\n\r\n  public mapLayersShownInLegend: Layer[];\r\n\r\n  constructor(\r\n    private configService: ConfigService,\r\n    private searchState: SearchState,\r\n    private queryState: QueryState,\r\n    private cdRef: ChangeDetectorRef\r\n    ) {\r\n    }\r\n\r\n    ngOnInit(){\r\n      this.queryStore.entities$ // clear the search when a mapQuery is initialised\r\n      .subscribe(\r\n        (entities) => {\r\n        if (entities.length > 0) {\r\n          this.mapQuery.emit(true);\r\n          this.legendPanelOpened = false;\r\n          this.panelOpened.emit(true);\r\n          this.clearSearch();\r\n        }\r\n        else {\r\n          this.closePanelOnCloseQuery();\r\n        }\r\n      });\r\n    }\r\n\r\n    @HostListener('change')\r\n    ngOnDestroy() {\r\n      this.store.destroy();\r\n      this.store.entities$.unsubscribe();\r\n      this.legendPanelOpened = false;\r\n      this.clearSearch();\r\n      this.clearQuery();\r\n      this.map.propertyChange$.unsubscribe;\r\n    }\r\n\r\n    isScrolledIntoView(elemSource, elem) {\r\n      const padding = 6;\r\n      const docViewTop = elemSource.scrollTop;\r\n      const docViewBottom = docViewTop + elemSource.clientHeight;\r\n      const elemTop = elem.offsetTop;\r\n      const elemBottom = elemTop + elem.clientHeight + padding;\r\n      return elemBottom <= docViewBottom && elemTop >= docViewTop;\r\n    }\r\n\r\n    /**\r\n     * Try to add a feature to the map when it's being focused\r\n     * @internal\r\n     * @param result A search result that could be a feature\r\n     */\r\n    onResultFocus(result: SearchResult) {\r\n      this.tryAddFeatureToMap(result);\r\n      this.selectedFeature = (result as SearchResult<Feature>).data;\r\n    }\r\n\r\n    /**\r\n     * Try to add a feature to the map overlay\r\n     * @param layer A search result that could be a feature\r\n     */\r\n    private tryAddFeatureToMap(layer: SearchResult) {\r\n      if (layer.meta.dataType !== FEATURE) {\r\n        return undefined;\r\n      }\r\n\r\n      // Somethimes features have no geometry. It happens with some GetFeatureInfo\r\n      if (layer.data.geometry === undefined) {\r\n        return;\r\n      }\r\n\r\n      this.map.searchResultsOverlay.setFeatures(\r\n        [layer.data] as Feature[],\r\n        FeatureMotion.Default\r\n      );\r\n\r\n      this.hasFeatureEmphasisOnSelection = this.configService.getConfig('hasFeatureEmphasisOnSelection');\r\n    }\r\n\r\n  /*\r\n   * Remove a feature to the map overlay\r\n   */\r\n  removeFeatureFromMap() {\r\n    this.map.searchResultsOverlay.clear();\r\n  }\r\n\r\n  closePanelOnCloseQuery(){\r\n    this.closeQuery.emit();\r\n    this.mapQuery.emit(false);\r\n    if (!this.searchInit && !this.legendPanelOpened){\r\n      this.panelOpened.emit(false);\r\n    } if (this.searchInit || this.legendPanelOpened) {\r\n      this.panelOpened.emit(true);\r\n    }\r\n  }\r\n\r\n  clearSearch() {\r\n    this.map.searchResultsOverlay.clear();\r\n    this.searchStore.clear();\r\n    this.searchState.setSelectedResult(undefined);\r\n    this.searchState.deactivateCustomFilterTermStrategy();\r\n    this.searchInit = false;\r\n    this.searchState.setSearchTerm('');\r\n  }\r\n\r\n  clearQuery(): void{\r\n    this.queryState.store.softClear();\r\n    this.queryState.store.clear();\r\n    this.mapQuery.emit(false);\r\n    this.removeFeatureFromMap();\r\n  }\r\n\r\n  closePanelLegend() { // this flushes the legend whenever a user closes the panel. if not, the user has to click twice on the legend button to open the legend with the button\r\n    this.legendPanelOpened = false;\r\n    this.closeLegend.emit();\r\n    this.map.propertyChange$.unsubscribe;\r\n  }\r\n\r\n  panelOpenedFromFeature(event) {\r\n    this.panelOpened.emit(event);\r\n  }\r\n\r\n  mapQueryFromFeature(event) {\r\n    this.mapQuery.emit(event);\r\n  }\r\n\r\n}\r\n\r\n","<div id=\"bottomPanelMobile\" >\r\n  <mat-expansion-panel \r\n    #bottompanel\r\n    [hideToggle]=\"false\"\r\n    (opened) =\"openPanel()\"\r\n    (closed)= \"closePanelLegend()\"\r\n    [expanded]= \"panelOpenState\"\r\n    (closeLegend)= \"closePanelLegend()\"\r\n    (keydown.Enter)= \"$event.stopPropagation()\"\r\n    (click)= \"$event.stopPropagation()\"\r\n    >\r\n    <mat-expansion-panel-header>\r\n      <igo-search-bar *ngIf= \"showSearchBar\"\r\n        #searchbar\r\n        (click)= \"onSearchBarClick($event)\"\r\n        (keydown.Enter)= \"$event.stopPropagation()\"\r\n        (keydown.Space)= \"$event.stopPropagation()\"\r\n        appearance=\"outline\"\r\n        [mobile]=\"mobile\"\r\n        searchIcon =\"magnify\"\r\n        [matTooltip]=\"'searchBar' | translate\"\r\n        matTooltipShowDelay=\"500\"\r\n        tooltip-position=\"after\"\r\n        [searchSettings]=\"false\"\r\n        color=\"primary\"\r\n        [term]= \"term\"\r\n        (searchTermChange)= \"onSearchTermChange($event)\"\r\n        [termSplitter]= \"termSplitter\"\r\n        [forceNA]= \"forceCoordsNA\"\r\n        [store]= \"searchStore\"\r\n        [pointerSummaryEnabled]= \"igoSearchPointerSummaryEnabled\"\r\n        (pointerSummaryStatus)= \"onPointerSummaryStatusChange($event)\"\r\n        [searchResultsGeometryEnabled]= \"searchResultsGeometryEnabled\"\r\n        (searchResultsGeometryStatus)= \"onSearchResultsGeometryStatusChange($event)\"\r\n        (clearFeature)= \"clearSearchBar($event)\"\r\n        (search)= \"onSearch($event)\">\r\n      </igo-search-bar>\r\n\r\n    </mat-expansion-panel-header>\r\n\r\n    <div id=\"legend\" [legendPanelOpened]= \"legendPanelOpened\" *ngIf= \"legendPanelOpened === true\">\r\n      <button\r\n        mat-icon-button\r\n        color=\"primary\"\r\n        [matTooltip]= \"'legend.close' | translate\"\r\n        (click)= \"closePanelLegend()\"><mat-icon svgIcon=\"close\"></mat-icon>\r\n      </button>\r\n      <h4 mat-dialog-title>{{ 'legend.title' | translate }}</h4>\r\n      <igo-layer-legend-list\r\n        [layers]= \"mapLayersShownInLegend\"\r\n        [excludeBaseLayers]=\"true\"\r\n        [allowShowAllLegends]=\"false\"\r\n        [updateLegendOnResolutionChange]=\"true\"\r\n        [showAllLegendsValue]=\"false\"\r\n        [layers]= \"layers\">\r\n      </igo-layer-legend-list>\r\n    </div>\r\n\r\n      <div style=\"margin: 20px;\" *ngIf= \"searchInit !== true && (queryStore.empty$ | async)===true && legendPanelOpened === false\">\r\n        <section class=\"mat-typography\">\r\n          <h5><strong>{{ 'igo.integration.searchResultsTool.noResults' | translate }}</strong></h5>\r\n          <h6><strong>{{ 'igo.integration.searchResultsTool.doSearch' | translate }}</strong></h6>\r\n          <p [innerHTML]= \"'igo.integration.searchResultsTool.examples' | translate\"></p>\r\n      </section>\r\n      </div>\r\n\r\n      <div #getInfo *ngIf= \"mapQueryClick === true\" >\r\n\r\n        <app-feature-info\r\n          [map]= \"map\"\r\n          [store]= \"queryStore\"\r\n          [mobile]= \"mobile\"\r\n          (closeQuery)= \"closePanelOnCloseQuery()\"\r\n          [mapQueryClick]= \"mapQueryClick\"\r\n          [panelOpenState]= \"panelOpenState\"\r\n          (panelOpened)= \"panelOpenedFromFeature($event)\"\r\n          (mapQuery)= \"mapQueryFromFeature($event)\"\r\n          >\r\n        </app-feature-info>\r\n\r\n      </div>\r\n\r\n      <div #search *ngIf=\" searchInit === true\" >\r\n\r\n        <igo-search-results\r\n          [store]= \"searchStore\"\r\n          [term]= \"term\"\r\n          [showIcons]= \"true\"\r\n          [termSplitter]= \"termSplitter\"\r\n          placeholder =\"false\"\r\n          (searchTermChange)= \"onSearchTermChange($event)\"\r\n          (featureSelected) =\"closePanel()\"\r\n          (resultFocus) =\"onResultFocus($event)\"\r\n          (resultSelect) =\"onResultFocus($event)\"\r\n          (moreResults)= \"onSearch($event)\"\r\n          [zoomAuto]= \"false\" >\r\n        </igo-search-results>\r\n\r\n        </div>\r\n\r\n  </mat-expansion-panel>\r\n</div>","import {\r\n  Component,\r\n  Input,\r\n  OnInit,\r\n  Output,\r\n  OnDestroy,\r\n  EventEmitter,\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n  ElementRef\r\n} from '@angular/core';\r\n\r\nimport olFeature from 'ol/Feature';\r\nimport olPoint from 'ol/geom/Point';\r\n\r\nimport { StorageService } from '@igo2/core';\r\nimport { EntityStore, ActionStore } from '@igo2/common';\r\nimport { BehaviorSubject, Subscription, combineLatest, tap} from 'rxjs';\r\n\r\nimport {\r\n  IgoMap,\r\n  FEATURE,\r\n  Feature,\r\n  FeatureMotion,\r\n  MapService,\r\n  Research,\r\n  SearchResult,\r\n  SearchService,\r\n  Layer,\r\n  featureToOl,\r\n  featuresAreTooDeepInView,\r\n  featureFromOl,\r\n  getCommonVectorSelectedStyle,\r\n  getCommonVectorStyle\r\n} from '@igo2/geo';\r\nimport { MapState, QueryState, StorageState } from '@igo2/integration';\r\nimport { SearchState } from '../search-results-tool/search.state';\r\nimport { ConfigService } from '@igo2/core';\r\n\r\nimport type { default as OlGeometry } from 'ol/geom/Geometry';\r\n@Component({\r\n  selector: 'app-bottompanel',\r\n  templateUrl: './bottompanel.component.html',\r\n  styleUrls: ['./bottompanel.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class BottomPanelComponent implements OnInit, OnDestroy {\r\n\r\n  title$: BehaviorSubject<string> = new BehaviorSubject<string>(undefined);\r\n\r\n  @Input()\r\n  get legendPanelOpened(): boolean {\r\n    return this._legendPanelOpened;\r\n  }\r\n  set legendPanelOpened(value: boolean) {\r\n    this._legendPanelOpened = value;\r\n  }\r\n  private _legendPanelOpened: boolean;\r\n\r\n  @Output() closeLegend = new EventEmitter<boolean>();\r\n\r\n  @Input()\r\n  get map(): IgoMap {\r\n    return this.mapState.map;\r\n  }\r\n\r\n  @Input() hideToggle = false;\r\n\r\n  @Input() mobile : boolean; // to pass the input to featureDetails tooltip\r\n\r\n  @Input() mapQueryClick : boolean;\r\n\r\n  @Output() mapQuery = new EventEmitter<boolean>();\r\n\r\n  get queryStore(): EntityStore<SearchResult> {\r\n    return this.queryState.store;\r\n  }\r\n\r\n  private focusedResult$: BehaviorSubject<SearchResult> = new BehaviorSubject(\r\n    undefined\r\n  );\r\n\r\n  resultSelected$ = new BehaviorSubject<SearchResult<Feature>>(undefined);\r\n\r\n  @Output() selectFeature = new EventEmitter<boolean>();\r\n\r\n  @Input()\r\n  get feature(): Feature {\r\n    return this._feature;\r\n  }\r\n  set feature(value: Feature) {\r\n    this._feature = value;\r\n    this.cdRef.detectChanges();\r\n    this.selectFeature.emit();\r\n  }\r\n  private _feature: Feature;\r\n\r\n  public selectedFeature: Feature;\r\n  public hasFeatureEmphasisOnSelection = false;\r\n\r\n  @Input()\r\n  get term(): string {\r\n    return this._term;\r\n  }\r\n  set term(value: string) {\r\n    this._term = value;\r\n    this.pageIterator = [];\r\n  }\r\n  public _term: string;\r\n\r\n  @Input()\r\n  get searchInit(): boolean {\r\n    return this._searchInit;\r\n  }\r\n  set searchInit(value: boolean) {\r\n    this._searchInit = value;\r\n  }\r\n  private _searchInit: boolean;\r\n\r\n  public store = new ActionStore([]);\r\n  public showSearchBar: boolean;\r\n  public igoSearchPointerSummaryEnabled: boolean = false;\r\n    get termSplitter(): string {\r\n    return this.searchState.searchTermSplitter$.value;\r\n  }\r\n  public forceCoordsNA: boolean = false;\r\n\r\n  public clearedSearchbar = false;\r\n\r\n  public lonlat;\r\n  public mapProjection: string;\r\n\r\n  get searchStore(): EntityStore<SearchResult> {\r\n    return this.searchState.store;\r\n  }\r\n\r\n  public pageIterator: {sourceId: string}[] = [];\r\n\r\n  get storageService(): StorageService {\r\n    return this.storageState.storageService;\r\n  }\r\n  private abstractFocusedResult: Feature;\r\n  private abstractSelectedResult: Feature;\r\n  public withZoomButton = false;\r\n\r\n  zoomAuto$: BehaviorSubject<boolean> = new BehaviorSubject(false);\r\n\r\n  get zoomAuto(): boolean {\r\n    return this._zoomAuto;\r\n  }\r\n  set zoomAuto(value) {\r\n    if (value !== !this._zoomAuto) {\r\n      return;\r\n    }\r\n    this._zoomAuto = value;\r\n    this.zoomAuto$.next(value);\r\n    this.storageService.set('zoomAuto', value);\r\n  }\r\n  private _zoomAuto = false;\r\n\r\n  private resultOrResolution$$: Subscription;\r\n\r\n  private shownResultsEmphasisGeometries: Feature[] = [];\r\n\r\n  @Input()\r\n  get layers(): Layer[] {\r\n    return this._layers;\r\n  }\r\n  set layers(value: Layer[]) {\r\n    this._layers = value;\r\n  }\r\n  private _layers: Layer[];\r\n\r\n  public mapLayersShownInLegend: Layer[];\r\n\r\n  @Input() panelOpenState: boolean;\r\n\r\n  @Output() panelOpened = new EventEmitter<boolean>();\r\n\r\n  @Output() closeQuery = new EventEmitter<boolean>();\r\n\r\n  constructor(\r\n    private configService: ConfigService,\r\n    private mapService: MapService,\r\n    private searchState: SearchState,\r\n    private searchService: SearchService,\r\n    private queryState: QueryState,\r\n    private cdRef: ChangeDetectorRef,\r\n    private mapState: MapState,\r\n    private storageState: StorageState,\r\n    private elRef: ElementRef\r\n    ) {\r\n      this.mapService.setMap(this.map);\r\n      this.showSearchBar = this.configService.getConfig('showSearchBar') === undefined ? true :\r\n      this.configService.getConfig('showSearchBar');\r\n      this.zoomAuto = this.storageService.get('zoomAuto') as boolean;\r\n    }\r\n\r\n  ngOnInit(){\r\n    this.closePanel();\r\n    this.forceCoordsNA = this.configService.getConfig('app.forceCoordsNA');\r\n\r\n    this.queryStore.entities$\r\n    .subscribe(\r\n      (entities) => {\r\n      if (entities.length > 0) {\r\n        this.openPanel();\r\n        this.mapQuery.emit(true);\r\n        this.clearSearch();\r\n        this.searchInit = false;\r\n      } else {\r\n        if (!this.legendPanelOpened && !this.searchInit){\r\n          this.closePanel();\r\n        }\r\n      }\r\n    });\r\n\r\n    this.map.propertyChange$.subscribe(() => {\r\n      this.mapLayersShownInLegend = this.map.layers.filter(layer => (\r\n        layer.showInLayerList !== false\r\n      ));\r\n    });\r\n\r\n    let latestResult;\r\n    let trigger;\r\n    if (this.hasFeatureEmphasisOnSelection) {\r\n      this.resultOrResolution$$ = combineLatest([\r\n        this.focusedResult$.pipe(\r\n          tap((res) => {\r\n            latestResult = res;\r\n            trigger = 'focused';\r\n          })\r\n        ),\r\n        this.resultSelected$.pipe(\r\n          tap((res) => {\r\n            latestResult = res;\r\n            trigger = 'selected';\r\n          })\r\n        ),\r\n        this.map.viewController.resolution$,\r\n        this.store.entities$\r\n      ]).subscribe(() => this.buildResultEmphasis(latestResult, trigger));\r\n    }\r\n\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.searchInit = false;\r\n    this.mapQuery.emit(false);\r\n    this.store.destroy();\r\n    this.store.entities$.unsubscribe();\r\n    this.map.propertyChange$.unsubscribe;\r\n    this.queryState.store.destroy();\r\n    this.clearSearch();\r\n  }\r\n\r\n  onPointerSummaryStatusChange(value) {\r\n    this.igoSearchPointerSummaryEnabled = value;\r\n  }\r\n\r\n  onSearchTermChange(term = '') {\r\n    this.term = term;\r\n    this.clearedSearchbar = false;\r\n    const termWithoutHashtag = term.replace(/(#[^\\s]*)/g, '').trim();\r\n\r\n    if (termWithoutHashtag.length < 2) {\r\n      this.searchStore.clear();\r\n      this.selectedFeature = undefined;\r\n      this.searchInit = false;\r\n      this.clearSearch();\r\n    } else {\r\n      if (this.mapQueryClick){\r\n        this.queryState.store.softClear();\r\n        this.mapQuery.emit(false);\r\n        this.searchInit = true;\r\n      }\r\n    }\r\n  }\r\n\r\n  onSearch(event: { research: Research; results: SearchResult[] }) {\r\n    this.openPanel();\r\n    if (this.mapQueryClick) { // to clear the mapQuery if a search is initialized\r\n      this.queryState.store.softClear();\r\n      this.map.queryResultsOverlay.clear();\r\n      this.mapQuery.emit(false);\r\n    }\r\n    this.legendPanelOpened = false;\r\n    this.queryState.store.softClear();\r\n    this.searchInit = true;\r\n    this.clearedSearchbar = false;\r\n    this.store.clear();\r\n    const results = event.results;\r\n    this.searchStore.state.updateAll({ focused: false, selected: false });\r\n    const newResults = this.searchStore.entities$.value\r\n      .filter((result: SearchResult) => result.source !== event.research.source)\r\n      .concat(results);\r\n    this.searchStore.updateMany(newResults);\r\n\r\n    setTimeout(() => {\r\n      const igoList = this.elRef.nativeElement.querySelector('igo-list');\r\n      let moreResults;\r\n      event.research.request.subscribe((source) => {\r\n        if (!source[0] || !source[0].source) {\r\n          moreResults = null;\r\n        } else if (source[0].source.getId() === 'icherche') {\r\n          moreResults = igoList.querySelector('.icherche .moreResults');\r\n        } else if (source[0].source.getId() === 'ilayer') {\r\n          moreResults = igoList.querySelector('.ilayer .moreResults');\r\n        } else if (source[0].source.getId() === 'nominatim') {\r\n          moreResults = igoList.querySelector('.nominatim .moreResults');\r\n        } else {\r\n          moreResults = igoList.querySelector('.' + source[0].source.getId() + ' .moreResults');\r\n        }\r\n        if (\r\n          moreResults !== null &&\r\n          !this.isScrolledIntoView(igoList, moreResults)\r\n        ) {\r\n          igoList.scrollTop =\r\n            moreResults.offsetTop +\r\n            moreResults.offsetHeight -\r\n            igoList.clientHeight;\r\n        }\r\n      });\r\n    }, 250);\r\n  }\r\n\r\n  isScrolledIntoView(elemSource, elem) {\r\n    const padding = 6;\r\n    const docViewTop = elemSource.scrollTop;\r\n    const docViewBottom = docViewTop + elemSource.clientHeight;\r\n\r\n    const elemTop = elem.offsetTop;\r\n    const elemBottom = elemTop + elem.clientHeight + padding;\r\n    return elemBottom <= docViewBottom && elemTop >= docViewTop;\r\n  }\r\n  /**\r\n   * Try to add a feature to the map when it's being focused\r\n   * @internal\r\n   * @param result A search result that could be a feature\r\n   */\r\n\r\n  onResultFocus(result: SearchResult) {\r\n    this.focusedResult$.next(result);\r\n    if (result.meta.dataType === FEATURE && result.data.geometry) {\r\n      result.data.meta.style = getCommonVectorSelectedStyle(\r\n        Object.assign({},\r\n          { feature: result.data as Feature | olFeature<OlGeometry> },\r\n          this.searchState.searchOverlayStyleFocus,\r\n          result.style?.focus ? result.style.focus : {}));\r\n\r\n      const feature = this.map.searchResultsOverlay.dataSource.ol.getFeatureById(result.meta.id);\r\n      if (feature) {\r\n        feature.setStyle(result.data.meta.style);\r\n        return;\r\n      }\r\n      this.map.searchResultsOverlay.addFeature(result.data as Feature, FeatureMotion.None);\r\n    }\r\n    this.tryAddFeatureToMap(result);\r\n    this.selectedFeature = (result as SearchResult<Feature>).data;\r\n    if (this.selectedFeature !== undefined ){\r\n      this.closePanel();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Try to add a feature to the map overlay\r\n   * @param layer A search result that could be a feature\r\n   */\r\n  private tryAddFeatureToMap(layer: SearchResult) {\r\n    if ( this.searchState.setSelectedResult !== undefined){\r\n      this.closePanel();\r\n    }\r\n    if (layer.meta.dataType !== FEATURE) {\r\n      return undefined;\r\n    }\r\n\r\n    // Somethimes features have no geometry. It happens with some GetFeatureInfo\r\n    if (layer.data.geometry === undefined) {\r\n      return;\r\n    }\r\n\r\n    this.map.searchResultsOverlay.setFeatures(\r\n      [layer.data] as Feature[],\r\n      FeatureMotion.Default\r\n    );\r\n    this.closePanel();\r\n    this.hasFeatureEmphasisOnSelection = this.configService.getConfig('hasFeatureEmphasisOnSelection');\r\n  }\r\n\r\n  /*\r\n   * Remove a feature to the map overlay\r\n   */\r\n  removeFeatureFromMap() {\r\n    this.map.searchResultsOverlay.clear();\r\n    this.closePanel();\r\n  }\r\n\r\n  onSearchCoordinate() {\r\n    this.searchStore.clear();\r\n    const results = this.searchService.reverseSearch(this.lonlat);\r\n\r\n    for (const i in results) {\r\n      if (results.length > 0) {\r\n        results[i].request.subscribe((_results: SearchResult<Feature>[]) => {\r\n          this.onSearch({ research: results[i], results: _results });\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  onSearchBarClick(event){ /// prevents panel to close on clear search\r\n    if (!this.panelOpenState && this.clearedSearchbar === false){\r\n      this.openPanel();\r\n    }\r\n    event.stopPropagation();\r\n  }\r\n\r\n  clearQuery(): void{\r\n    this.queryState.store.softClear();\r\n    this.queryState.store.clear();\r\n    this.mapQuery.emit(false);\r\n    this.removeFeatureFromMap();\r\n  }\r\n\r\n  closePanelOnCloseQuery(){\r\n    this.mapQuery.emit(false);\r\n    this.closeQuery.emit();\r\n    this.cdRef.detectChanges();\r\n    if (this.searchInit || this.legendPanelOpened) {\r\n      this.openPanel();\r\n    }\r\n  }\r\n\r\n  clearSearchBar(event){\r\n    this.searchInit = false;\r\n    this.clearSearch();\r\n    this.closePanel();\r\n    this.clearedSearchbar = true;\r\n    if (event){\r\n      event.stopPropagation(); //prevents panel toggling on click or focus\r\n    }\r\n  }\r\n\r\n  clearSearch() {\r\n    this.map.searchResultsOverlay.clear();\r\n    this.searchStore.clear();\r\n    this.searchState.setSelectedResult(undefined);\r\n    this.searchState.deactivateCustomFilterTermStrategy();\r\n    this.term=\"\";\r\n  }\r\n\r\n  closePanelLegend() { // this flushes the legend whenever a user closes the panel. if not, the user has to click twice on the legend button to open the legend with the button\r\n    this.legendPanelOpened = false;\r\n    this.closePanel();\r\n    this.closeLegend.emit();\r\n    this.map.propertyChange$.unsubscribe;\r\n  }\r\n\r\n  panelOpenedFromFeature(event) {\r\n    this.panelOpened.emit(event);\r\n  }\r\n\r\n  mapQueryFromFeature(event) {\r\n    this.mapQuery.emit(event);\r\n  }\r\n\r\n  closePanel(){\r\n    if (!this.searchInit && !this.mapQueryClick && !this.legendPanelOpened){\r\n      this.panelOpened.emit(false);\r\n    }\r\n  }\r\n\r\n  openPanel(){\r\n    this.panelOpened.emit(true);\r\n  }\r\n\r\n  private clearFeatureEmphasis(trigger: 'selected' | 'focused' | 'shown') {\r\n    if (trigger === 'focused' && this.abstractFocusedResult) {\r\n      this.map.searchResultsOverlay.removeFeature(this.abstractFocusedResult);\r\n      this.abstractFocusedResult = undefined;\r\n    }\r\n    if (trigger === 'selected' && this.abstractSelectedResult) {\r\n      this.map.searchResultsOverlay.removeFeature(this.abstractSelectedResult);\r\n      this.abstractSelectedResult = undefined;\r\n    }\r\n    if (trigger === 'shown') {\r\n      this.shownResultsEmphasisGeometries.map(shownResult => this.map.searchResultsOverlay.removeFeature(shownResult));\r\n      this.shownResultsEmphasisGeometries = [];\r\n    }\r\n  }\r\n\r\n  private buildResultEmphasis(\r\n    result: SearchResult<Feature>,\r\n    trigger: 'selected' | 'focused' | 'shown' | undefined\r\n  ) {\r\n    if (trigger !== 'shown') {\r\n      this.clearFeatureEmphasis(trigger);\r\n    }\r\n    if (!result || !result.data.geometry) {\r\n      return;\r\n    }\r\n    const myOlFeature = featureToOl(result.data, this.map.projection);\r\n    const olGeometry = myOlFeature.getGeometry();\r\n    if (featuresAreTooDeepInView(this.map, olGeometry.getExtent() as [number, number, number, number], 0.0025)) {\r\n      const extent = olGeometry.getExtent();\r\n      const x = extent[0] + (extent[2] - extent[0]) / 2;\r\n      const y = extent[1] + (extent[3] - extent[1]) / 2;\r\n      const feature1 = new olFeature({\r\n        name: `${trigger}AbstractResult'`,\r\n        geometry: new olPoint([x, y])\r\n      });\r\n      const abstractResult = featureFromOl(feature1, this.map.projection);\r\n\r\n      let computedStyle;\r\n      let zIndexOffset = 0;\r\n\r\n      switch (trigger) {\r\n        case 'focused':\r\n          computedStyle = getCommonVectorSelectedStyle(\r\n            Object.assign({},\r\n              { feature: abstractResult },\r\n              this.searchState.searchOverlayStyleFocus,\r\n              result.style?.focus ? result.style.focus : {}));\r\n          zIndexOffset = 2;\r\n          break;\r\n        case 'shown':\r\n          computedStyle = getCommonVectorStyle(Object.assign({},\r\n            { feature: abstractResult },\r\n            this.searchState.searchOverlayStyle,\r\n            result.style?.base ? result.style.base : {}));\r\n          break;\r\n        case 'selected':\r\n          computedStyle = getCommonVectorSelectedStyle(\r\n            Object.assign({},\r\n              { feature: abstractResult },\r\n              this.searchState.searchOverlayStyleSelection,\r\n              result.style?.selection ? result.style.selection : {}));\r\n          zIndexOffset = 1;\r\n          break;\r\n      }\r\n      abstractResult.meta.style = computedStyle;\r\n      abstractResult.meta.style.setZIndex(2000 + zIndexOffset);\r\n      this.map.searchResultsOverlay.addFeature(abstractResult, FeatureMotion.None);\r\n      if (trigger === 'focused') {\r\n        this.abstractFocusedResult = abstractResult;\r\n      }\r\n      if (trigger === 'selected') {\r\n        this.abstractSelectedResult = abstractResult;\r\n      }\r\n      if (trigger === 'shown') {\r\n        this.shownResultsEmphasisGeometries.push(abstractResult);\r\n      }\r\n    } else {\r\n      this.clearFeatureEmphasis(trigger);\r\n    }\r\n  }\r\n\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { MatDialogState } from '@angular/material/dialog';\r\nimport { IgoMap, Layer } from '@igo2/geo';\r\nimport { MapState } from '@igo2/integration';\r\nimport { Observable } from 'rxjs';\r\n\r\n@Component({\r\n  selector: 'app-legend-dialog',\r\n  templateUrl: 'legend-dialog.component.html',\r\n  styleUrls: ['./legend-dialog.component.scss']\r\n})\r\nexport class LegendDialogComponent implements OnInit {\r\n\r\n  public getState: MatDialogState;\r\n\r\n  get map(): IgoMap {\r\n    return this.mapState.map;\r\n  }\r\n\r\n  get layers$(): Observable<Layer[]> {\r\n    return this.map.layers$;\r\n  }\r\n\r\n  public mapLayersShownInLegend: Layer[];\r\n\r\n  constructor(\r\n    private mapState: MapState\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.mapLayersShownInLegend = this.map.layers.filter(layer => (\r\n      layer.showInLayerList !== false\r\n    ));\r\n  }\r\n}\r\n","<div mat-dialog-actions><button mat-button mat-icon-button mat-dialog-close class=\"close\"><mat-icon svgIcon = \"close\"></mat-icon></button></div>\r\n<h4 mat-dialog-title>{{\"legend.title\" | translate}}</h4>\r\n\r\n<igo-layer-legend-list\r\n  [layers]=\"mapLayersShownInLegend\"\r\n  [excludeBaseLayers]=\"true\"\r\n  [allowShowAllLegends]=\"false\"\r\n  [updateLegendOnResolutionChange]=\"true\"\r\n  [showAllLegendsValue]=\"false\">\r\n</igo-layer-legend-list>","import { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { LanguageService } from '@igo2/core';\r\nimport { LegendDialogComponent } from '../legend-dialog/legend-dialog.component';\r\n\r\n@Component({\r\n  selector: 'app-legend-button',\r\n  templateUrl: './legend-button.component.html',\r\n  styleUrls: ['./legend-button.component.scss']\r\n})\r\nexport class LegendButtonComponent {\r\n\r\n  public dialogRef = null;\r\n\r\n  public legendButtonTooltip = this.languageService.translate.instant('legend.open');\r\n\r\n  @Output() toggleLegend = new EventEmitter<boolean>();\r\n\r\n  @Input() tooltipDisabled: boolean;\r\n\r\n  @Input() legendInPanel: boolean;\r\n\r\n  @Input() mobile: boolean;\r\n\r\n  constructor(public dialog: MatDialog, protected languageService: LanguageService) { }\r\n\r\n  toggleLegendButton(): void {\r\n    if (!this.legendInPanel && !this.mobile){\r\n      const dialogOpened = this.dialog.getDialogById('legend-dialog-container');\r\n      if (!dialogOpened) {\r\n        this.legendButtonTooltip = this.languageService.translate.instant('legend.close');\r\n        this.dialogRef = this.dialog.open(LegendDialogComponent, {\r\n          id: 'legend-dialog-container',\r\n          hasBackdrop: false,\r\n          closeOnNavigation: true\r\n        });\r\n      } else {\r\n        this.legendButtonTooltip = this.languageService.translate.instant('legend.open');\r\n        this.dialogRef.close();\r\n      }\r\n    }\r\n      this.toggleLegend.emit();\r\n  }\r\n}\r\n","<button\r\n    id=\"legend-button\"\r\n    mat-raised-button\r\n    (click)=\"toggleLegendButton()\"\r\n    [matTooltip]=\"legendButtonTooltip\"\r\n    [matTooltipDisabled]=\"tooltipDisabled\"\r\n    >\r\n    {{ 'legend.button' | translate }}\r\n</button>\r\n","<mat-sidenav-container>\r\n  <mat-sidenav-content position=\"end\">\r\n\r\n    <igo-backdrop\r\n      [shown]=\"false\"\r\n      (click)=\"onBackdropClick()\">\r\n    </igo-backdrop>\r\n\r\n    <div id=\"searchDesktop\" *ngIf=!mobile>\r\n\r\n      <igo-search-bar *ngIf=\"showSearchBar\"\r\n        #searchbar\r\n        (pointerSummaryStatus)=\"onPointerSummaryStatusChange($event)\"\r\n        appearance=\"outline\"\r\n        searchIcon =\"magnify\"\r\n        [matTooltip]=\"'searchBar' | translate\"\r\n        matTooltipShowDelay=\"500\"\r\n        tooltip-position=\"after\"\r\n        [searchSettings]=\"false\"\r\n        color=\"primary\"\r\n        [forceNA]=\"forceCoordsNA\"\r\n        [term]=\"searchBarTerm\"\r\n        [store]=\"searchStore\"\r\n        [termSplitter]=\"termSplitter\"\r\n        (searchTermChange)=\"onSearchTermChange($event)\"\r\n        (search)=\"onSearch($event)\"\r\n        (clearFeature)=\"clearSearch()\">\r\n      </igo-search-bar>\r\n\r\n      <div *ngIf=\"mobile\" id=\"scaleLine\"></div>\r\n\r\n      <app-sidepanel\r\n        #sidepanel\r\n        class=\"sidepanel\"\r\n        [map]=\"map\"\r\n        [mobile]=\"mobile\"\r\n        [(opened)]=\"panelOpenState\"\r\n        [searchInit]=\"searchInit\"\r\n        [store]=\"queryStore\"\r\n        [legendPanelOpened]=\"legendPanelOpened\"\r\n        [mapQueryClick]=\"mapQueryClick\"\r\n        [panelOpenState]=\"panelOpenState\"\r\n        (panelOpened)=\"panelOpened($event)\"\r\n        (toggleLegend)=\"togglePanelLegend()\"\r\n        (closeLegend)=\"closePanelLegend()\"\r\n        (closeQuery)=\"closePanelOnCloseQuery()\"\r\n        (openLegend)=\"openPanelLegend()\"\r\n        [layers]=\"mapLayersShownInLegend\">\r\n      </app-sidepanel>\r\n    </div>\r\n\r\n    <igo-map-browser      \r\n      igoMapOffline\r\n      #mapBrowser\r\n      igoMapContext\r\n      igoLayerContext\r\n      igoDropGeoFile\r\n      igoHoverFeature\r\n      [igoHoverFeatureEnabled]=\"true\"\r\n      igoQuery\r\n      [queryFeatures]=\"true\"\r\n      (query)=\"onMapQuery($event)\"\r\n      [igoHoverFeatureDelay]=10\r\n      [map]=\"map\"\r\n      (menuPosition)=\"onContextMenuOpen($event)\"\r\n      [ngClass]=\"{'igo-attribution-offset': map.getBaseLayers().length > 1, 'map-hasfooter': hasFooter}\">\r\n\r\n      <div *ngIf=\"mobile\" id=\"scaleLine\"></div>\r\n\r\n        <igo-baselayers-switcher\r\n          [ngClass]=\"mobile? ['igo-baselayers-switcher-mobile'] : (panelOpenState? ['baselayers-pushed'] : ['baselayers'])\"\r\n          [map]=\"map\"\r\n          [useStaticIcon]=\"getBaseLayersUseStaticIcon()\">\r\n        </igo-baselayers-switcher>\r\n\r\n        <div id=\"map-buttons\"\r\n        [ngClass]=\"mobile? ['map-buttons-mobile'] : ['map-buttons']\">\r\n          <igo-geolocate-button *ngIf=\"hasGeolocateButton\" [map]=\"map\" color=\"primary\"></igo-geolocate-button>\r\n          <igo-zoom-button [map]=\"map\" color=\"primary\"></igo-zoom-button>\r\n          <igo-rotation-button [showIfNoRotation]=\"showRotationButtonIfNoRotation\" [map]=\"map\" color=\"primary\"></igo-rotation-button>\r\n          <app-legend-button *ngIf= \"hasLegendButton\" (toggleLegend)= \"toggleLegend()\" [legendInPanel]= \"legendInPanel\" [tooltipDisabled]=\"mobile\" [legendButtonTooltip]=\"legendButtonTooltip\" color= \"primary\"></app-legend-button>\r\n        </div>\r\n\r\n        <app-bottompanel\r\n          *ngIf= \"mobile\"\r\n          [mobile]= \"mobile\"\r\n          [store]= \"searchStore\"\r\n          [searchInit]= \"searchInit\"\r\n          [mapQueryClick]= \"mapQueryClick\"\r\n          [legendPanelOpened]= \"legendPanelOpened\"\r\n          [panelOpenState]= \"panelOpenState\"\r\n          (panelOpened)= \"panelOpened($event)\"\r\n          (mapQuery)= \"mapQuery($event)\"\r\n          (closeQuery)= \"closePanelOnCloseQuery()\"\r\n          (closeLegend)= \"closePanelLegend()\"\r\n          (openLegend)= \"openPanelLegend()\"\r\n          (toggleLegend)= \"togglePanelLegend()\"\r\n          [layers]= \"mapLayersShownInLegend\">\r\n        </app-bottompanel>\r\n    </igo-map-browser>\r\n\r\n    <app-footer *ngIf=\"hasFooter && !mobile\" [mobile]=\"mobile\"></app-footer>\r\n\r\n    <app-map-overlay\r\n    [@controlStateX]=\"(mediaService.media$ | async) !== 'mobile' &&\r\n                            panelOpenState ? 'right' : 'left'\">\r\n    </app-map-overlay>\r\n\r\n  </mat-sidenav-content>\r\n\r\n</mat-sidenav-container>\r\n","import {\r\n  Component,\r\n  OnInit,\r\n  AfterContentInit,\r\n  OnDestroy,\r\n  ViewChild,\r\n  ElementRef\r\n} from '@angular/core';\r\nimport { ActivatedRoute, Params } from '@angular/router';\r\nimport { Subscription, BehaviorSubject, of, skip } from 'rxjs';\r\nimport { debounceTime, take, skipWhile, distinctUntilChanged, tap } from 'rxjs/operators';\r\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\r\nimport * as olProj from 'ol/proj';\r\nimport { MatPaginator } from '@angular/material/paginator';\r\nimport { AuthOptions, AuthService } from '@igo2/auth';\r\nimport { HttpClient, HttpParams } from '@angular/common/http';\r\nimport olFormatGeoJSON from 'ol/format/GeoJSON';\r\nimport { BreakpointObserver, Breakpoints } from '@angular/cdk/layout';\r\nimport { ObjectUtils } from '@igo2/utils';\r\n\r\nimport {\r\n  MediaService,\r\n  Media,\r\n  MediaOrientation,\r\n  ConfigService,\r\n  LanguageService,\r\n  MessageService,\r\n  StorageService,\r\n  AnalyticsService\r\n  } from '@igo2/core';\r\n\r\n  import {\r\n    ActionbarMode,\r\n    Workspace,\r\n    WorkspaceStore,\r\n    ActionStore,\r\n    EntityStore,\r\n    getEntityTitle,\r\n    EntityTablePaginatorOptions,\r\n    EntityRecord\r\n  } from '@igo2/common';\r\n\r\n  import { DetailedContext } from '@igo2/context';\r\n\r\n  import {\r\n  FEATURE,\r\n  Feature,\r\n  GoogleLinks,\r\n  LayerService,\r\n  Research,\r\n  SearchResult,\r\n  SearchSourceService,\r\n  CapabilitiesService,\r\n  sourceCanSearch,\r\n  sourceCanReverseSearch,\r\n  ImportService,\r\n  handleFileImportError,\r\n  handleFileImportSuccess,\r\n  WfsWorkspace,\r\n  generateIdFromSourceOptions,\r\n  computeOlFeaturesExtent,\r\n  ImageLayer,\r\n  VectorLayer,\r\n  MapExtent,\r\n  IgoMap,\r\n  DataSourceService,\r\n  SearchSource,\r\n  QuerySearchSource,\r\n  featureToSearchResult,\r\n  QueryService,\r\n  Layer,\r\n  MapService,\r\n  SearchBarComponent\r\n  } from '@igo2/geo';\r\n\r\nimport {\r\n  MapState,\r\n  WorkspaceState,\r\n  QueryState,\r\n  ContextState,\r\n  DirectionState\r\n} from '@igo2/integration';\r\n\r\nimport { SearchState } from './panels/search-results-tool/search.state';\r\n\r\nimport { PwaService } from '../../services/pwa.service';\r\n\r\nimport {\r\n  controlsAnimations, controlSlideX, controlSlideY\r\n} from './portal.animation';\r\nimport { MapBrowserEvent } from 'ol';\r\n\r\n@Component({\r\n  selector: 'app-portal',\r\n  templateUrl: './portal.component.html',\r\n  styleUrls: ['./portal.component.scss'],\r\n  animations: [\r\n    controlsAnimations(),\r\n    controlSlideX(),\r\n    controlSlideY()\r\n  ]\r\n})\r\n\r\nexport class PortalComponent implements OnInit, AfterContentInit, OnDestroy {\r\n  public showRotationButtonIfNoRotation: boolean = undefined;\r\n  public hasFooter: boolean = true;\r\n  public hasLegendButton: boolean = true;\r\n  public hasGeolocateButton: boolean = true;\r\n  public workspaceNotAvailableMessage: String = 'workspace.disabled.resolution';\r\n  public workspaceEntitySortChange$: BehaviorSubject<boolean> = new BehaviorSubject(false);\r\n  private workspaceMaximize$$: Subscription[] = [];\r\n  readonly workspaceMaximize$: BehaviorSubject<boolean> = new BehaviorSubject(\r\n    this.storageService.get('workspaceMaximize') as boolean\r\n  );\r\n  public selectedWorkspace$: BehaviorSubject<Workspace> = new BehaviorSubject(undefined);;\r\n  public hasSideSearch = true;\r\n  public showSearchBar = true;\r\n  @ViewChild('mapBrowser', { read: ElementRef, static: true })\r\n  mapBrowser: ElementRef;\r\n  public legendPanelOpened = false;\r\n  public legendDialogOpened = false;\r\n  public settingsChange$ = new BehaviorSubject<boolean>(undefined);\r\n\r\n  getBaseLayersUseStaticIcon(): Boolean {\r\n    return this.configService.getConfig('useStaticIcon');\r\n  }\r\n  public hasHomeExtentButton = false;\r\n  public hasFeatureEmphasisOnSelection: Boolean = false;\r\n  public workspacePaginator: MatPaginator;\r\n  public workspaceSwitchDisabled = false;\r\n  public paginatorOptions: EntityTablePaginatorOptions = {\r\n    pageSize: 50, // Number of items to display on a page.\r\n    pageSizeOptions: [1, 5, 10, 20, 50, 100, 500] // The set of provided page size options to display to the user.\r\n  };\r\n  public workspaceMenuClass = 'workspace-menu';\r\n\r\n  public fullExtent = this.storageService.get('fullExtent') as boolean;\r\n\r\n  public matDialogRef$ = new BehaviorSubject<MatDialogRef<any>>(undefined);\r\n  public searchBarTerm = '';\r\n  public onSettingsChange$ = new BehaviorSubject<boolean>(undefined);\r\n  public termDefinedInUrl = false;\r\n  public termSplitter = '|';\r\n  public termDefinedInUrlTriggered = false;\r\n  private addedLayers$$: Subscription[] = [];\r\n  private layers$$: Subscription;\r\n  public forceCoordsNA = false;\r\n\r\n  public contextMenuStore = new ActionStore([]);\r\n  private contextMenuCoord: [number, number];\r\n\r\n  private contextLoaded = false;\r\n  private context$$: Subscription;\r\n  private openPanels$$: Subscription;\r\n  private sidenavMediaAndOrientation$$: Subscription;\r\n  private searchTerm$$: Subscription;\r\n\r\n  public igoSearchPointerSummaryEnabled: boolean;\r\n\r\n  private routeParams: Params;\r\n  public toastPanelHtmlDisplay = false;\r\n  public mobile: boolean;\r\n  public homeExtent: MapExtent;\r\n  public homeCenter: [number, number];\r\n  public homeZoom: number;\r\n  @ViewChild('searchbar') searchBar: SearchBarComponent;\r\n\r\n  public dialogOpened = this.dialog.getDialogById('legend-button-dialog-container');\r\n\r\n  get map(): IgoMap {\r\n    return this.mapState.map;\r\n  }\r\n\r\n  get auth(): AuthOptions {\r\n    return this.configService.getConfig('auth') || [];\r\n  }\r\n\r\n  isMobile(): boolean {\r\n    return this.mediaService.getMedia() === Media.Mobile;\r\n  }\r\n\r\n  isTablet(): boolean {\r\n    return this.mediaService.getMedia() === Media.Tablet;\r\n  }\r\n\r\n  isLandscape(): boolean {\r\n    return this.mediaService.getOrientation() === MediaOrientation.Landscape;\r\n  }\r\n\r\n  isPortrait(): boolean {\r\n    return this.mediaService.getOrientation() === MediaOrientation.Portrait;\r\n  }\r\n\r\n  public mobileBreakPoint: string = '(min-width: 768px)';\r\n  public Breakpoints = Breakpoints;\r\n  public currentBreakpoint: string = '';\r\n\r\n  get backdropShown(): boolean {\r\n    return (\r\n      ('(min-width: 768px)' &&\r\n      this.panelOpenState\r\n    ));\r\n  }\r\n\r\n  get expansionPanelExpanded(): boolean {\r\n    return this.workspaceState.workspacePanelExpanded;\r\n  }\r\n  set expansionPanelExpanded(value: boolean) {\r\n    this.workspaceState.workspacePanelExpanded = value;\r\n    if (value) {\r\n      this.map.viewController.setPadding({bottom: 280});\r\n    } else {\r\n      this.map.viewController.setPadding({bottom: 0});\r\n    }\r\n  }\r\n\r\n  get workspace(): Workspace {\r\n    return this.workspaceState.workspace$.value;\r\n  }\r\n\r\n  get actionbarMode(): ActionbarMode {\r\n    return ActionbarMode.Overlay;\r\n  }\r\n\r\n  get actionbarWithTitle(): boolean {\r\n    return this.actionbarMode === ActionbarMode.Overlay;\r\n  }\r\n\r\n  get searchStore(): EntityStore<SearchResult> {\r\n    return this.searchState.store;\r\n  }\r\n\r\n  get searchResultsGeometryEnabled(): boolean {\r\n    return this.searchState.searchResultsGeometryEnabled$.value;\r\n  }\r\n\r\n  get workspaceStore(): WorkspaceStore {\r\n    return this.workspaceState.store;\r\n  }\r\n\r\n  get queryStore(): EntityStore<SearchResult> { //FeatureInfo\r\n    return this.queryState.store;\r\n  }\r\n  public panelOpenState = false;\r\n  public mapQueryClick = false;\r\n  public searchInit = false;\r\n\r\n  public mapLayersShownInLegend: Layer[];\r\n  public legendInPanel: boolean;\r\n  public legendButtonTooltip = this.languageService.translate.instant('legend.open');\r\n\r\n  constructor(\r\n    private route: ActivatedRoute,\r\n    public workspaceState: WorkspaceState,\r\n    public authService: AuthService,\r\n    public mediaService: MediaService,\r\n    public layerService: LayerService,\r\n    public dataSourceService: DataSourceService,\r\n    public capabilitiesService: CapabilitiesService,\r\n    private contextState: ContextState,\r\n    private mapState: MapState,\r\n    private mapService: MapService,\r\n    private searchState: SearchState,\r\n    private queryState: QueryState,\r\n    private searchSourceService: SearchSourceService,\r\n    private configService: ConfigService,\r\n    private importService: ImportService,\r\n    private http: HttpClient,\r\n    private languageService: LanguageService,\r\n    private messageService: MessageService,\r\n    public dialogWindow: MatDialog,\r\n    private storageService: StorageService,\r\n    private directionState: DirectionState,\r\n    public dialog: MatDialog,\r\n    public queryService: QueryService,\r\n    private breakpointObserver: BreakpointObserver,\r\n    private pwaService: PwaService,\r\n    private analyticsService: AnalyticsService\r\n  ) {\r\n      this.hasFooter = this.configService.getConfig('hasFooter') === undefined ? false :\r\n        this.configService.getConfig('hasFooter');\r\n      this.hasLegendButton = this.configService.getConfig('hasLegendButton') === undefined ? false :\r\n        this.configService.getConfig('hasLegendButton');\r\n      this.hasSideSearch = this.configService.getConfig('hasSideSearch') === undefined ? true :\r\n        this.configService.getConfig('hasSideSearch');\r\n        this.showSearchBar = this.configService.getConfig('searchBar.showSearchBar') === undefined ? true :\r\n        this.configService.getConfig('searchBar.showSearchBar');\r\n      this.hasHomeExtentButton =\r\n        this.configService.getConfig('homeExtentButton') === undefined ? false : true;\r\n      this.hasGeolocateButton = this.configService.getConfig('hasGeolocateButton') === undefined ? true :\r\n        this.configService.getConfig('hasGeolocateButton');\r\n      this.showRotationButtonIfNoRotation = this.configService.getConfig('showRotationButtonIfNoRotation') === undefined ? false :\r\n        this.configService.getConfig('showRotationButtonIfNoRotation');\r\n      this.forceCoordsNA = this.configService.getConfig('app.forceCoordsNA');\r\n      this.hasFeatureEmphasisOnSelection = this.configService.getConfig('hasFeatureEmphasisOnSelection');\r\n      this.igoSearchPointerSummaryEnabled = this.configService.getConfig('hasSearchPointerSummary');\r\n      if (this.igoSearchPointerSummaryEnabled === undefined) {\r\n        this.igoSearchPointerSummaryEnabled = this.storageService.get('searchPointerSummaryEnabled') as boolean || false;\r\n      }\r\n      this.mobileBreakPoint = this.configService.getConfig('mobileBreakPoint') === undefined ? \"'(min-width: 768px)'\" :\r\n        this.configService.getConfig('mobileBreakPoint');\r\n      this.hasHomeExtentButton = this.configService.getConfig('homeExtentButton') === undefined ? false : true;\r\n      this.legendInPanel = this.configService.getConfig('legendInPanel') === undefined ? true :\r\n        this.configService.getConfig('legendInPanel');\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.queryService.defaultFeatureCount = 1;\r\n    window['IGO'] = this;\r\n    this.hasGeolocateButton = this.configService.getConfig('hasGeolocateButton') === undefined ? true :\r\n      this.configService.getConfig('hasGeolocateButton');\r\n\r\n    this.map.ol.once('rendercomplete', () => {\r\n      this.readQueryParams();\r\n      if (this.configService.getConfig('geolocate.activateDefault') !== undefined) {\r\n        this.map.geolocationController.tracking = this.configService.getConfig('geolocate.activateDefault');\r\n      }\r\n\r\n    });\r\n\r\n    this.searchState.searchTermSplitter$.next(this.termSplitter);\r\n\r\n    this.authService.authenticate$.subscribe((authenticated) => {\r\n      this.contextLoaded = false;\r\n    });\r\n\r\n    this.route.queryParams.subscribe((params) => {\r\n      this.readLanguageParam(params);\r\n    });\r\n\r\n    this.context$$ = this.contextState.context$.subscribe(\r\n      (context: DetailedContext) => this.onChangeContext(context)\r\n    );\r\n\r\n    const contextActions = [{\r\n      id: 'coordinates',\r\n      title: 'coordinates',\r\n      handler: () => this.searchCoordinate(this.contextMenuCoord)\r\n    },\r\n    {\r\n      id: 'googleMaps',\r\n      title: 'googleMap',\r\n      handler: () => this.openGoogleMaps(this.contextMenuCoord)\r\n    },\r\n    {\r\n      id: 'googleStreetView',\r\n      title: 'googleStreetView',\r\n      handler: () => this.openGoogleStreetView(this.contextMenuCoord)\r\n    }];\r\n\r\n    this.contextMenuStore.load(contextActions);\r\n\r\n    this.searchState.selectedResult$.subscribe((result) => {\r\n      if (result && this.isMobile()) {\r\n        this.closePanels();\r\n      }\r\n    });\r\n\r\n    this.searchTerm$$ = this.searchState.searchTerm$.pipe(skip(1)).subscribe((searchTerm: string) => {\r\n      if (searchTerm !== undefined && searchTerm !== null) {\r\n        this.analyticsService.trackSearch(searchTerm, this.searchState.store.count);\r\n      }\r\n    });\r\n\r\n    this.queryService.defaultFeatureCount = 1;\r\n\r\n    this.queryStore.entities$\r\n    .subscribe(\r\n      (entities) => {\r\n      if (entities.length > 0) {\r\n        this.openPanelonQuery();\r\n      }\r\n    });\r\n\r\n    this.breakpoint$.subscribe(() =>\r\n    this.breakpointChanged()\r\n    );\r\n  }\r\n\r\n  ngAfterContentInit(): void {\r\n    this.map.viewController.setInitialState();\r\n  }\r\n\r\n  toggleDialogLegend(){\r\n    if (!this.legendDialogOpened) {\r\n      this.legendDialogOpened = true;\r\n    }\r\n  }\r\n\r\n  toggleLegend(){\r\n    if (this.legendInPanel || this.mobile){\r\n      if (!this.legendPanelOpened) {\r\n        this.legendButtonTooltip = this.languageService.translate.instant('legend.close');\r\n        this.openPanelLegend();\r\n        if (this.searchInit){\r\n          this.clearSearch();\r\n          this.openPanels();\r\n        }\r\n        if (this.mapQueryClick){\r\n          this.onClearQuery();\r\n          this.mapQueryClick = false;\r\n          this.openPanels();\r\n        }\r\n      } else {\r\n        this.legendButtonTooltip = this.languageService.translate.instant('legend.open');\r\n        this.closePanelLegend();\r\n      }\r\n    }\r\n    else {\r\n      if (!this.legendDialogOpened) {\r\n        this.legendDialogOpened = true;\r\n      }\r\n    }\r\n  }\r\n\r\n  panelOpened(event) {\r\n    this.panelOpenState = event;\r\n  }\r\n\r\n  mapQuery(event) {\r\n    this.mapQueryClick = event;\r\n  }\r\n\r\n  closePanelLegend(){\r\n    this.legendPanelOpened = false;\r\n    this.closePanels();\r\n    this.map.propertyChange$.unsubscribe;\r\n  }\r\n\r\n  openPanelLegend(){\r\n    this.legendPanelOpened = true;\r\n    this.openPanels();\r\n    this.map.propertyChange$.subscribe(() => {\r\n      this.mapLayersShownInLegend = this.map.layers.filter(layer => (\r\n        layer.showInLayerList !== false\r\n      ));\r\n    });\r\n  }\r\n\r\n  public breakpointChanged() {\r\n    if(this.breakpointObserver.isMatched('(min-width: 768px)')) {\r\n      this.currentBreakpoint = this.mobileBreakPoint;\r\n      this.mobile = false;\r\n    } else {\r\n      this.mobile = true;\r\n    }\r\n  }\r\n\r\n  readonly breakpoint$ = this.breakpointObserver\r\n  .observe(this.mobileBreakPoint)\r\n  .pipe(\r\n    tap(() => {}),\r\n    distinctUntilChanged()\r\n  );\r\n\r\n  /*\r\n  private initSW() {\r\n    const dataDownload = this.configService.getConfig('pwa.dataDownload');\r\n    if ('serviceWorker' in navigator && dataDownload) {\r\n      let downloadMessage;\r\n      let currentVersion;\r\n      const dataLoadSource = this.storageService.get('dataLoadSource');\r\n      navigator.serviceWorker.ready.then((registration) => {\r\n        console.log('Service Worker Ready');\r\n        this.http.get('ngsw.json').pipe(\r\n          concatMap((ngsw: any) => {\r\n            const datas$ = [];\r\n            let hasDataInDataDir: boolean = false;\r\n            if (ngsw) {\r\n              // IF FILE NOT IN THIS LIST... DELETE?\r\n              currentVersion = ngsw.appData.version;\r\n              const cachedDataVersion = this.storageService.get('cachedDataVersion');\r\n              if (currentVersion !== cachedDataVersion && dataLoadSource === 'pending') {\r\n                this.pwaService.updates.checkForUpdate();\r\n              }\r\n              if (dataLoadSource === 'newVersion' || !dataLoadSource) {\r\n                ((ngsw as any).assetGroups as any).map((assetGroup) => {\r\n                  if (assetGroup.name === 'contexts') {\r\n                    const elemToDownload = assetGroup.urls.concat(assetGroup.files).filter(f => f);\r\n                    elemToDownload.map((url, i) => datas$.push(this.http.get(url).pipe(delay(750))));\r\n                  }\r\n                });\r\n                if (hasDataInDataDir) {\r\n                  const message = this.languageService.translate.instant('pwa.data-download-start');\r\n                  downloadMessage = this.messageService\r\n                    .info(message, undefined, { disableTimeOut: true, progressBar: false, closeButton: true, tapToDismiss: false });\r\n                  this.storageService.set('cachedDataVersion', currentVersion);\r\n                }\r\n                return zip(...datas$);\r\n              }\r\n\r\n            }\r\n            return zip(...datas$);\r\n          })\r\n        )\r\n          .pipe(delay(1000))\r\n          .subscribe(() => {\r\n            if (downloadMessage) {\r\n              this.messageService.remove((downloadMessage as any).toastId);\r\n              const message = this.languageService.translate.instant('pwa.data-download-completed');\r\n              this.messageService.success(message, undefined, { timeOut: 40000 });\r\n              if (currentVersion) {\r\n                this.storageService.set('dataLoadSource', 'pending');\r\n                this.storageService.set('cachedDataVersion', currentVersion);\r\n              }\r\n            }\r\n          });\r\n\r\n      });\r\n    }\r\n  }*/\r\n\r\n  createFeatureProperties(layer: ImageLayer | VectorLayer) {\r\n    let properties = {};\r\n    layer.options.sourceOptions.sourceFields.forEach(field => {\r\n      if (!field.primary && field.visible) {\r\n        properties[field.name] = '';\r\n      }\r\n    });\r\n    return properties;\r\n  }\r\n\r\n  entitySortChange() {\r\n    this.workspaceEntitySortChange$.next(true);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.context$$.unsubscribe();\r\n    this.workspaceMaximize$$.map(f => f.unsubscribe());\r\n    this.layers$$?.unsubscribe();\r\n    this.searchTerm$$.unsubscribe();\r\n  }\r\n\r\n  private getQuerySearchSource(): SearchSource {\r\n    return this.searchSourceService\r\n      .getSources()\r\n      .find(\r\n        (searchSource: SearchSource) =>\r\n          searchSource instanceof QuerySearchSource\r\n      );\r\n  }\r\n\r\n  private getFeatureIsSameActiveWks(feature: Feature): boolean {\r\n    if (this.workspace) {\r\n      const featureTitle = feature.meta.sourceTitle;\r\n      const wksTitle = this.workspace.title;\r\n      if (wksTitle === featureTitle) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private getWksActiveOpenInResolution(): boolean {\r\n    if(this.workspace) {\r\n      const activeWks = this.workspace as WfsWorkspace;\r\n      if(activeWks.active && activeWks.inResolutionRange$.value && this.workspaceState.workspacePanelExpanded) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n   }\r\n\r\n  onMapQuery(event: { features: Feature[]; event: MapBrowserEvent<any> }) {\r\n    if(this.configService.getConfig('queryOnlyOne')){\r\n      event.features = [event.features[0]];\r\n      this.map.queryResultsOverlay.clear(); // to avoid double-selection in the map\r\n    }\r\n    const baseQuerySearchSource = this.getQuerySearchSource();\r\n    const querySearchSourceArray: QuerySearchSource[] = [];\r\n    if (event.features.length) {\r\n      if (this.searchInit) {this.clearSearch();}\r\n      this.clearSearchbarterm('');\r\n      if (this.mapQueryClick) {\r\n        this.onClearQuery();\r\n      }\r\n      this.openPanelonQuery();\r\n      const results = event.features.map((feature: Feature) => {\r\n        let querySearchSource = querySearchSourceArray.find(\r\n          (s) => s.title === feature.meta.sourceTitle\r\n        );\r\n        if (this.getFeatureIsSameActiveWks(feature)) {\r\n          if (this.getWksActiveOpenInResolution() && !(this.workspace as WfsWorkspace).getLayerWksOptionMapQuery()) {\r\n            return;\r\n          }\r\n        }\r\n        if (querySearchSource) {\r\n          this.onClearQuery();\r\n          this.openPanelonQuery();\r\n          this.mapQueryClick = true;\r\n        }\r\n        if (!querySearchSource) {\r\n          querySearchSource = new QuerySearchSource({\r\n            title: feature.meta.sourceTitle\r\n          });\r\n          querySearchSourceArray.push(querySearchSource);\r\n        }\r\n          return featureToSearchResult(feature, querySearchSource);\r\n      });\r\n      const filteredResults = results.filter(x => x !== undefined);\r\n      const research = {\r\n        request: of(filteredResults),\r\n        reverse: false,\r\n        source: baseQuerySearchSource\r\n      };\r\n      research.request.subscribe((queryResults: SearchResult<Feature>[]) => {\r\n        this.queryStore.load(queryResults);\r\n      });\r\n    } else {\r\n      this.mapQueryClick = false;\r\n      if (!this.searchInit && !this.legendPanelOpened && !this.mobile){ // in desktop keep legend opened if user clicks on the map\r\n        this.panelOpenState = false;\r\n      }\r\n      if (!this.searchInit && this.mobile){ // mobile mode, close legend when user click on the map\r\n        this.panelOpenState = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Cancel ongoing add layer, if any\r\n   */\r\n   private cancelOngoingAddLayer() {\r\n    this.addedLayers$$.forEach((sub: Subscription) => sub.unsubscribe());\r\n    this.addedLayers$$ = [];\r\n  }\r\n\r\n  onBackdropClick() {\r\n    this.closePanels();\r\n    this.mapQueryClick = false;\r\n  }\r\n\r\n  onSearchTermChange(term?: string) {\r\n    if(this.mobile) {this.panelOpenState = true;}\r\n    if (this.routeParams?.search && term !== this.routeParams.search) {\r\n      this.searchState.deactivateCustomFilterTermStrategy();\r\n    }\r\n\r\n    this.searchState.setSearchTerm(term);\r\n    const termWithoutHashtag = term.replace(/(#[^\\s]*)/g, '').trim();\r\n    if (termWithoutHashtag.length < 2) {\r\n      if(this.mobile) {this.panelOpenState = true;}\r\n      this.clearSearch();\r\n      return;\r\n    }\r\n    this.onBeforeSearch();\r\n  }\r\n\r\n  clearSearchbarterm(event){\r\n    this.searchBar.setTerm('');\r\n  }\r\n\r\n  onSearch(event: { research: Research; results: SearchResult[] }) {\r\n    this.searchInit = true;\r\n    this.legendPanelOpened = false;\r\n    this.panelOpenState = true;\r\n    if (this.mapQueryClick) {\r\n      this.onClearQuery();\r\n      this.mapQueryClick = false;\r\n      this.panelOpenState = true;\r\n    }\r\n    const results = event.results;\r\n\r\n    const isReverseSearch = !sourceCanSearch(event.research.source);\r\n\r\n    let enabledSources;\r\n    if (isReverseSearch) {\r\n      enabledSources = this.searchSourceService\r\n        .getEnabledSources()\r\n        .filter(sourceCanReverseSearch);\r\n    } else {\r\n      enabledSources = this.searchSourceService\r\n        .getEnabledSources()\r\n        .filter(sourceCanSearch);\r\n    }\r\n\r\n    const newResults = this.searchStore.entities$.value\r\n      .filter(\r\n        (result: SearchResult) =>\r\n          result.source !== event.research.source &&\r\n          enabledSources.includes(result.source)\r\n      )\r\n      .concat(results);\r\n    this.searchStore.updateMany(newResults);\r\n  }\r\n\r\n  private closePanels() {\r\n    if (!this.mapQueryClick && !this.searchInit && !this.legendPanelOpened){\r\n      this.panelOpenState = false;\r\n    }\r\n  }\r\n\r\n  private openPanels() {\r\n    this.panelOpenState = true;\r\n  }\r\n\r\n  private computeHomeExtentValues(context: DetailedContext) {\r\n    if (context?.map?.view?.homeExtent) {\r\n      this.homeExtent = context.map.view.homeExtent.extent;\r\n      this.homeCenter = context.map.view.homeExtent.center;\r\n      this.homeZoom = context.map.view.homeExtent.zoom;\r\n    } else {\r\n      this.homeExtent = undefined;\r\n      this.homeCenter = undefined;\r\n      this.homeZoom = undefined;\r\n    }\r\n\r\n  }\r\n\r\n  private onChangeContext(context: DetailedContext) {\r\n    this.cancelOngoingAddLayer();\r\n    if (context === undefined) {\r\n      return;\r\n    }\r\n    if (this.workspace && !this.workspace.entityStore.empty) {\r\n      this.workspace.entityStore.clear();\r\n    }\r\n    if (!this.queryState.store.empty) {\r\n      this.queryState.store.softClear();\r\n    }\r\n\r\n    this.computeHomeExtentValues(context);\r\n    this.route.queryParams.pipe(debounceTime(250)).subscribe((qParams) => {\r\n      if (!qParams['context'] || qParams['context'] === context.uri) {\r\n        this.readLayersQueryParams(qParams);\r\n      }\r\n    });\r\n\r\n    this.contextLoaded = true;\r\n  }\r\n\r\n  private onBeforeSearch() {\r\n    this.openPanels();\r\n  }\r\n\r\n  clearSearch() {\r\n    this.map.searchResultsOverlay.clear();\r\n    this.searchStore.clear();\r\n    this.searchState.setSelectedResult(undefined);\r\n    this.searchState.deactivateCustomFilterTermStrategy();\r\n    this.searchInit = false;\r\n    this.searchBarTerm = ''; // the searchbarterm doesn't clear up\r\n    this.searchState.setSearchTerm('');\r\n  }\r\n\r\n  closePanelOnCloseQuery(){\r\n    this.mapQueryClick = false;\r\n    if (this.searchInit || this.legendPanelOpened) {\r\n      this.openPanels(); // to prevent the panel to close when click searchbar after query\r\n    }\r\n  }\r\n\r\n  openPanelonQuery(){\r\n    this.mapQueryClick = true;\r\n    this.openPanels;\r\n    this.legendPanelOpened = false;\r\n    this.clearSearch();\r\n  }\r\n\r\n  onClearQuery(){\r\n    this.queryState.store.clear(); // clears the info panel\r\n    this.queryState.store.softClear(); // clears the info panel\r\n    this.map.queryResultsOverlay.clear(); // to avoid double-selection in the map\r\n  }\r\n\r\n  getTitle(result: SearchResult) {\r\n    return getEntityTitle(result);\r\n  }\r\n\r\n  onContextMenuOpen(event: { x: number; y: number }) {\r\n    this.contextMenuCoord = this.getClickCoordinate(event) as [number, number];\r\n  }\r\n\r\n  private getClickCoordinate(event: { x: number; y: number }) {\r\n    const contextmenuPoint = event;\r\n    const boundingMapBrowser = this.mapBrowser.nativeElement.getBoundingClientRect();\r\n    contextmenuPoint.y =\r\n      contextmenuPoint.y -\r\n      boundingMapBrowser.top +\r\n      (window.scrollY || window.pageYOffset);\r\n    contextmenuPoint.x =\r\n      contextmenuPoint.x -\r\n      boundingMapBrowser.left +\r\n      (window.scrollX || window.pageXOffset);\r\n    const pixel = [contextmenuPoint.x, contextmenuPoint.y];\r\n\r\n    const coord = this.map.ol.getCoordinateFromPixel(pixel);\r\n    const proj = this.map.projection;\r\n    return olProj.transform(coord, proj, 'EPSG:4326');\r\n  }\r\n\r\n  private openGoogleMaps(coord: [number, number]) {\r\n    window.open(GoogleLinks.getGoogleMapsCoordLink(coord[0], coord[1]));\r\n  }\r\n\r\n  private openGoogleStreetView(coord: [number, number]) {\r\n    window.open(GoogleLinks.getGoogleStreetViewLink(coord[0], coord[1]));\r\n  }\r\n\r\n  searchCoordinate(coord: [number, number]) {\r\n    this.searchBarTerm = coord.map((c) => c.toFixed(6)).join(', ');\r\n  }\r\n\r\n  onPointerSummaryStatusChange(value) {\r\n    this.storageService.set('searchPointerSummaryEnabled', value);\r\n    this.igoSearchPointerSummaryEnabled = value;\r\n  }\r\n\r\n  private readQueryParams() {\r\n    this.route.queryParams.subscribe((params) => {\r\n      this.routeParams = params;\r\n      this.readSearchParams();\r\n      this.readFocusFirst();\r\n      this.computeZoomToExtent();\r\n    });\r\n  }\r\n\r\n  private readLanguageParam(params) {\r\n    if (params['lang']) {\r\n      this.authService.languageForce = true;\r\n      this.languageService.setLanguage(params['lang']);\r\n    }\r\n  }\r\n\r\n  private computeZoomToExtent() {\r\n    if (this.routeParams['zoomExtent']) {\r\n      const extentParams = this.routeParams['zoomExtent'].split(',');\r\n      const olExtent = olProj.transformExtent(\r\n        extentParams,\r\n        'EPSG:4326',\r\n        this.map.projection\r\n      );\r\n      this.map.viewController.zoomToExtent(olExtent as [number, number, number, number]);\r\n    }\r\n  }\r\n\r\n  getControlsOffsetY() {\r\n    return this.expansionPanelExpanded ?\r\n      this.workspaceMaximize$.value ? 'firstRowFromBottom-expanded-maximized' : 'firstRowFromBottom-expanded' :\r\n      'firstRowFromBottom';\r\n  }\r\n\r\n  private computeFocusFirst() {\r\n    setTimeout(() => {\r\n      const resultItem: any = document\r\n        .getElementsByTagName('igo-search-results-item')\r\n        .item(0);\r\n      if (resultItem) {\r\n        resultItem.click();\r\n      }\r\n    }, 1);\r\n  }\r\n\r\n  private readFocusFirst() {\r\n    if (this.routeParams['sf'] === '1' && this.termDefinedInUrl) {\r\n      const entities$$ = this.searchStore.stateView.all$()\r\n        .pipe(\r\n          skipWhile((entities) => entities.length === 0),\r\n          debounceTime(1000),\r\n          take(1)\r\n        )\r\n        .subscribe((entities) => {\r\n          entities$$.unsubscribe();\r\n          if (entities.length && !this.termDefinedInUrlTriggered) {\r\n            this.computeFocusFirst();\r\n            this.termDefinedInUrlTriggered = true;\r\n          }\r\n        });\r\n    }\r\n  }\r\n\r\n  private readSearchParams() {\r\n    if (this.routeParams['search']) {\r\n      this.termDefinedInUrl = true;\r\n      if (this.routeParams['exactMatch'] === '1') {\r\n        this.searchState.activateCustomFilterTermStrategy();\r\n      }\r\n      if (this.routeParams['search'] && !this.routeParams['zoom'] && this.routeParams['sf'] !== '1') {\r\n        const entities$$ = this.searchStore.stateView.all$()\r\n          .pipe(\r\n            skipWhile((entities) => entities.length === 0),\r\n            debounceTime(500),\r\n            take(1)\r\n          )\r\n          .subscribe((entities) => {\r\n            entities$$.unsubscribe();\r\n            const searchResultsOlFeatures = entities\r\n              .filter(e => e.entity.meta.dataType === FEATURE)\r\n              .map((entity: EntityRecord<SearchResult>) =>\r\n                new olFormatGeoJSON().readFeature(entity.entity.data, {\r\n                  dataProjection: entity.entity.data.projection,\r\n                  featureProjection: this.map.projection\r\n                })\r\n              );\r\n            const totalExtent = computeOlFeaturesExtent(this.map, searchResultsOlFeatures);\r\n            this.map.viewController.zoomToExtent(totalExtent);\r\n          });\r\n      }\r\n      this.searchBarTerm = this.routeParams['search'];\r\n    }\r\n    if (this.routeParams['searchGeom'] === '1') {\r\n      this.searchState.searchResultsGeometryEnabled$.next(true);\r\n    }\r\n  }\r\n\r\n  private readLayersQueryParams(params: Params) {\r\n    this.readLayersQueryParamsByType(params, 'wms');\r\n    this.readLayersQueryParamsByType(params, 'wmts');\r\n    this.readLayersQueryParamsByType(params, 'arcgisrest');\r\n    this.readLayersQueryParamsByType(params, 'imagearcgisrest');\r\n    this.readLayersQueryParamsByType(params, 'tilearcgisrest');\r\n    this.readVectorQueryParams(params);\r\n  }\r\n\r\n  getQueryParam(name, url) {\r\n    let paramValue;\r\n    if (url.includes('?')) {\r\n      const httpParams = new HttpParams({ fromString: url.split('?')[1] });\r\n      paramValue = httpParams.get(name);\r\n    }\r\n    return paramValue;\r\n  }\r\n\r\n  private readLayersQueryParamsByType(params: Params, type) {\r\n    let nameParamLayersKey;\r\n    let urlsKey;\r\n    switch (type) {\r\n      case 'wms':\r\n        if ((params['layers'] || params['wmsLayers']) && params['wmsUrl']) {\r\n          urlsKey = 'wmsUrl';\r\n          nameParamLayersKey = params['wmsLayers'] ? 'wmsLayers' : 'layers'; // for maintain compatibility\r\n        }\r\n        break;\r\n      case 'wmts':\r\n        if (params['wmtsLayers'] && params['wmtsUrl']) {\r\n          urlsKey = 'wmtsUrl';\r\n          nameParamLayersKey = 'wmtsLayers';\r\n        }\r\n        break;\r\n      case 'arcgisrest':\r\n        if (params['arcgisLayers'] && params['arcgisUrl']) {\r\n          urlsKey = 'arcgisUrl';\r\n          nameParamLayersKey = 'arcgisLayers';\r\n        }\r\n        break;\r\n      case 'imagearcgisrest':\r\n        if (params['iarcgisLayers'] && params['iarcgisUrl']) {\r\n          urlsKey = 'iarcgisUrl';\r\n          nameParamLayersKey = 'iarcgisLayers';\r\n        }\r\n        break;\r\n      case 'tilearcgisrest':\r\n        if (params['tarcgisLayers'] && params['tarcgisUrl']) {\r\n          urlsKey = 'tarcgisUrl';\r\n          nameParamLayersKey = 'tarcgisLayers';\r\n        }\r\n        break;\r\n    }\r\n    if (!nameParamLayersKey || !urlsKey) {\r\n      return;\r\n    }\r\n    const layersByService = params[nameParamLayersKey].split('),(');\r\n    const urls = params[urlsKey].split(',');\r\n\r\n    let cnt = 0;\r\n    urls.forEach((urlSrc) => {\r\n      let url = urlSrc;\r\n      const version =\r\n        this.getQueryParam('VERSION', url) ||\r\n        this.getQueryParam('version', url) ||\r\n        undefined;\r\n      if (version) {\r\n        url = url.replace('VERSION=' + version, '').replace('version=' + version, '');\r\n      }\r\n\r\n      const currentLayersByService = this.extractLayersByService(\r\n        layersByService[cnt]\r\n      );\r\n      currentLayersByService.forEach((layer) => {\r\n        const layerFromUrl = layer.split(':igoz');\r\n        const layerOptions = ObjectUtils.removeUndefined({\r\n          type,\r\n          url: url,\r\n          layer: layerFromUrl[0],\r\n          params: type === 'wms' ? { LAYERS: layerFromUrl[0] } : undefined\r\n        });\r\n        const id = generateIdFromSourceOptions(layerOptions);\r\n        const visibility = this.computeLayerVisibilityFromUrl(params, id);\r\n        this.addLayerFromURL(\r\n          url,\r\n          layerFromUrl[0],\r\n          type,\r\n          version,\r\n          visibility,\r\n          layerFromUrl[1] ? parseInt(layerFromUrl[1], 10) : undefined\r\n        );\r\n      });\r\n      cnt += 1;\r\n    });\r\n  }\r\n\r\n  private readVectorQueryParams(params: Params) {\r\n    if (params['vector']) {\r\n      const url = params['vector'] as string;\r\n      const lastIndex = url.lastIndexOf('/');\r\n      const fileName = url.slice(lastIndex + 1, url.length);\r\n\r\n      this.http.get(`${url}`, { responseType: 'blob' }).subscribe((data) => {\r\n        const file = new File([data], fileName, {\r\n          type: data.type,\r\n          lastModified: Date.now()\r\n        });\r\n        this.importService.import(file).subscribe(\r\n          (features: Feature[]) => this.onFileImportSuccess(file, features),\r\n          (error: Error) => this.onFileImportError(file, error)\r\n        );\r\n      });\r\n    }\r\n  }\r\n\r\n  private onFileImportSuccess(file: File, features: Feature[]) {\r\n    handleFileImportSuccess(\r\n      file,\r\n      features,\r\n      this.map,\r\n      this.contextState.context$.value.uri,\r\n      this.messageService,\r\n      this.layerService\r\n    );\r\n  }\r\n\r\n  private onFileImportError(file: File, error: Error) {\r\n    handleFileImportError(\r\n      file,\r\n      error,\r\n      this.messageService\r\n    );\r\n  }\r\n\r\n  private extractLayersByService(layersByService: string): any[] {\r\n    let outLayersByService = layersByService;\r\n    outLayersByService = outLayersByService.startsWith('(')\r\n      ? outLayersByService.substr(1)\r\n      : outLayersByService;\r\n    outLayersByService = outLayersByService.endsWith(')')\r\n      ? outLayersByService.slice(0, -1)\r\n      : outLayersByService;\r\n    return outLayersByService.split(',');\r\n  }\r\n  private addLayerFromURL(\r\n    url: string,\r\n    name: string,\r\n    type: 'wms' | 'wmts' | 'arcgisrest' | 'imagearcgisrest' | 'tilearcgisrest',\r\n    version: string,\r\n    visibility: boolean = true,\r\n    zIndex: number\r\n  ) {\r\n    if (!this.contextLoaded) {\r\n      return;\r\n    }\r\n    const commonSourceOptions = {\r\n      optionsFromCapabilities: true,\r\n      optionsFromApi: true,\r\n      crossOrigin: true,\r\n      type,\r\n      url\r\n    };\r\n    const arcgisClause = (type === 'arcgisrest' || type === 'imagearcgisrest' || type === 'tilearcgisrest');\r\n    let sourceOptions = {\r\n      version: type === 'wmts' ? '1.0.0' : undefined,\r\n      queryable: arcgisClause ? true : false,\r\n      queryFormat: arcgisClause ? 'esrijson' : undefined,\r\n      layer: name\r\n    };\r\n    if (type === 'wms') {\r\n      sourceOptions = { params: { LAYERS: name, VERSION: version } } as any;\r\n    }\r\n\r\n    sourceOptions = ObjectUtils.removeUndefined(Object.assign({}, sourceOptions, commonSourceOptions));\r\n\r\n    this.addedLayers$$.push(\r\n      this.layerService\r\n        .createAsyncLayer({\r\n          zIndex: zIndex,\r\n          visible: visibility,\r\n          sourceOptions\r\n        })\r\n        .subscribe((l) => {\r\n          this.map.addLayer(l);\r\n        })\r\n    );\r\n  }\r\n\r\n  private computeLayerVisibilityFromUrl(\r\n    params: Params,\r\n    currentLayerid: string\r\n  ): boolean {\r\n    const queryParams = params;\r\n    let visible = true;\r\n    if (!queryParams || !currentLayerid) {\r\n      return visible;\r\n    }\r\n    let visibleOnLayersParams = '';\r\n    let visibleOffLayersParams = '';\r\n    let visiblelayers: string[] = [];\r\n    let invisiblelayers: string[] = [];\r\n    if (queryParams['visiblelayers']) {\r\n      visibleOnLayersParams = queryParams['visiblelayers'];\r\n    }\r\n    if (queryParams['invisiblelayers']) {\r\n      visibleOffLayersParams = queryParams['invisiblelayers'];\r\n    }\r\n\r\n    /* This order is important because to control whichever\r\n     the order of * param. First whe open and close everything.*/\r\n    if (visibleOnLayersParams === '*') {\r\n      visible = true;\r\n    }\r\n    if (visibleOffLayersParams === '*') {\r\n      visible = false;\r\n    }\r\n\r\n    // After, managing named layer by id (context.json OR id from datasource)\r\n    visiblelayers = visibleOnLayersParams.split(',');\r\n    invisiblelayers = visibleOffLayersParams.split(',');\r\n    if (visiblelayers.indexOf(currentLayerid) > -1 || visiblelayers.indexOf(currentLayerid.toString()) > -1) {\r\n      visible = true;\r\n    }\r\n    if (invisiblelayers.indexOf(currentLayerid) > -1 || invisiblelayers.indexOf(currentLayerid.toString()) > -1) {\r\n      visible = false;\r\n    }\r\n    return visible;\r\n  }\r\n\r\n}\r\n","import './portal.variables.scss';\r\n\r\nimport {\r\n  trigger,\r\n  state,\r\n  style,\r\n  transition,\r\n  animate,\r\n  AnimationTriggerMetadata\r\n} from '@angular/animations';\r\n\r\nexport function controlSlideX(): AnimationTriggerMetadata {\r\n  return trigger('controlStateX', [\r\n    state(\r\n      'left',\r\n      style({\r\n        left: '60px'\r\n      })\r\n    ),\r\n    state(\r\n      'right',\r\n      style({\r\n        left: '465px'\r\n      })\r\n    ),\r\n    transition('* => *', animate('200ms'))\r\n  ]);\r\n}\r\n\r\nexport function controlSlideY(): AnimationTriggerMetadata {\r\n  return trigger('controlStateY', [\r\n    state('close', style({})),\r\n    state(\r\n      'firstRowFromBottom',\r\n      style({\r\n        bottom: '2px',\r\n        'margin-left': '0px'\r\n      })\r\n    ),\r\n    state(\r\n      'firstRowFromBottom-expanded',\r\n      style({\r\n        bottom: '285px',\r\n        'margin-left': '-55px'\r\n      })\r\n    ),\r\n    state(\r\n      'firstRowFromBottom-expanded-maximized',\r\n      style({\r\n        bottom: '500px', // workspace full size\r\n        'margin-left': '-55px'\r\n      })\r\n    ),\r\n    transition('* => *', animate('200ms'))\r\n  ]);\r\n}\r\n\r\nexport function controlsAnimations(): AnimationTriggerMetadata[] {\r\n  return [\r\n    trigger('controlsOffsetY', [\r\n      state('close', style({})),\r\n      state(\r\n        'firstRowFromBottom',\r\n        style({\r\n          bottom: '5px'\r\n        })\r\n      ),\r\n      state(\r\n        'firstRowFromBottom-expanded',\r\n        style({\r\n          bottom: '5px'\r\n        })\r\n      ),\r\n      state(\r\n        'firstRowFromBottom-expanded-maximized',\r\n        style({\r\n          bottom: '500px'\r\n        })\r\n      ),\r\n      state(\r\n        'secondRowFromBottom',\r\n        style({\r\n          bottom: '47px'\r\n        })\r\n      ),\r\n      state(\r\n        'thirdRowFromBottom',\r\n        style({\r\n          bottom: '104px'\r\n        })\r\n      ),\r\n      state(\r\n        '',\r\n        style({\r\n          bottom: 'calc(285px)'\r\n        })\r\n      ),\r\n      state(\r\n        'secondRowFromBottom-expanded',\r\n        style({\r\n          bottom: 'calc(285px + 52px)'\r\n        })\r\n      ),\r\n      state(\r\n        'thirdRowFromBottom-expanded',\r\n        style({\r\n          bottom: 'calc(285px + 104px)'\r\n        })\r\n      ),\r\n      transition('* => *', animate('200ms'))\r\n    ])\r\n  ];\r\n}\r\n","import { Component } from '@angular/core';\r\nimport { ConfigService } from '@igo2/core';\r\n\r\n@Component({\r\n  selector: 'app-map',\r\n  templateUrl: './map.component.html',\r\n  styleUrls: ['./map.component.scss']\r\n})\r\nexport class MapComponent {\r\n  public hasHeader = true;\r\n\r\n  constructor(private configService: ConfigService) {\r\n\r\n    this.hasHeader = this.configService.getConfig('header.hasHeader') === undefined ? false :\r\n      this.configService.getConfig('header.hasHeader');\r\n   }\r\n\r\n}\r\n","<app-portal \r\n    [ngClass]=\" hasHeader? 'portal-hasHeader-hasMenu' : 'portal-hasMenu' \">\r\n</app-portal>\r\n","import { HomeComponent } from '../menu-pages/home/home.component';\r\nimport { AboutComponent } from '../menu-pages/about/about.component';\r\nimport { MapComponent } from '../menu-pages/map/map.component';\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nconst routes: Routes = [\r\n    { path: '', component: HomeComponent },\r\n    { path: 'carte', component: MapComponent },\r\n    { path: 'en-savoir-plus', component: AboutComponent }\r\n  ];\r\n\r\n\r\n@NgModule({\r\n    imports: [RouterModule.forRoot(routes, {\r\n      onSameUrlNavigation: 'reload',\r\n      relativeLinkResolution: 'legacy'\r\n  })],\r\n    exports: [RouterModule],\r\n  })\r\n  export class MenuRoutingModule { }\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { HeaderComponent } from './header.component';\r\nimport { IgoLanguageModule } from '@igo2/core';\r\nimport { MatToolbarModule } from '@angular/material/toolbar';\r\nimport { MenuRoutingModule } from '../menu/menu-routing/menu-routing.module';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    HeaderComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    IgoLanguageModule,\r\n    MatToolbarModule,\r\n    MenuRoutingModule\r\n    ],\r\n  exports: [\r\n    HeaderComponent\r\n  ]\r\n})\r\nexport class HeaderModule { }\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FooterComponent } from './footer.component';\r\nimport { IgoLanguageModule } from '@igo2/core';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    FooterComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    IgoLanguageModule\r\n  ],\r\n  exports: [\r\n    FooterComponent\r\n  ]\r\n})\r\nexport class FooterModule { }\r\n","import { LegendDialogComponent } from './legend-dialog.component';\r\nimport { NgModule } from '@angular/core';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { IgoMapModule, IgoLayerModule } from '@igo2/geo';\r\nimport { MatTooltipModule } from '@angular/material/tooltip';\r\nimport { IgoLanguageModule } from '@igo2/core';\r\nimport { MatDialogModule } from '@angular/material/dialog';\r\n\r\n@NgModule({\r\n  declarations: [LegendDialogComponent],\r\n  imports: [\r\n    MatIconModule,\r\n    MatDialogModule,\r\n    IgoLayerModule,\r\n    IgoMapModule,\r\n    MatButtonModule,\r\n    MatTooltipModule,\r\n    IgoLanguageModule\r\n  ],\r\n  exports: [\r\n    LegendDialogComponent\r\n  ]\r\n})\r\nexport class LegendDialogModule { }\r\n","import { LegendButtonComponent } from './legend-button.component';\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { LegendDialogModule } from '../legend-dialog/legend-dialog.module';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { IgoMapModule, IgoLayerModule } from '@igo2/geo';\r\nimport { MatTooltipModule } from '@angular/material/tooltip';\r\nimport { IgoLanguageModule } from '@igo2/core';\r\nimport { MatDialogModule } from '@angular/material/dialog';\r\n\r\n@NgModule({\r\n  declarations: [LegendButtonComponent],\r\n  imports: [\r\n    CommonModule,\r\n    MatIconModule,\r\n    MatButtonModule,\r\n    IgoMapModule, IgoLayerModule,\r\n    MatTooltipModule,\r\n    IgoLanguageModule,\r\n    MatDialogModule,\r\n    LegendDialogModule\r\n  ],\r\n  exports: [LegendButtonComponent]\r\n})\r\nexport class LegendButtonModule { }\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\n\r\nimport { MapOverlayComponent } from './map-overlay.component';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule\r\n  ],\r\n  exports: [MapOverlayComponent],\r\n  declarations: [MapOverlayComponent]\r\n})\r\nexport class MapOverlayModule {}\r\n","import { NgModule, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatBadgeModule } from '@angular/material/badge';\r\nimport { MatTooltipModule } from '@angular/material/tooltip';\r\n\r\nimport { IgoLanguageModule } from '@igo2/core';\r\nimport { IgoFlexibleModule, IgoCustomHtmlModule, IgoPanelModule } from '@igo2/common';\r\nimport {\r\n  IgoFeatureModule,\r\n  IgoSearchModule,\r\n  IgoFeatureDetailsModule\r\n} from '@igo2/geo';\r\n\r\nimport { SearchResultsToolComponent } from './search-results-tool.component';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    MatIconModule,\r\n    MatBadgeModule,\r\n    MatTooltipModule,\r\n    MatButtonModule,\r\n    IgoLanguageModule,\r\n    IgoFeatureModule,\r\n    IgoSearchModule,\r\n    IgoFlexibleModule,\r\n    IgoPanelModule,\r\n    IgoFeatureDetailsModule,\r\n    IgoCustomHtmlModule\r\n  ],\r\n  declarations: [SearchResultsToolComponent],\r\n  exports: [SearchResultsToolComponent],\r\n  schemas: [CUSTOM_ELEMENTS_SCHEMA]\r\n})\r\nexport class IgoAppSearchResultsToolModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatTooltipModule } from '@angular/material/tooltip';\r\nimport { IgoLanguageModule } from '@igo2/core';\r\nimport { IgoKeyValueModule, IgoImageModule } from '@igo2/common';\r\nimport { RouterModule } from '@angular/router';\r\n\r\nimport { FeatureDetailsComponent } from './feature-details.component';\r\nimport { FeatureDetailsCustomComponent } from './feature-details-custom.component';\r\nimport { FeatureDetailsDirective } from './feature-details.directive';\r\n\r\n/**\r\n * @ignore\r\n */\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    MatIconModule,\r\n    IgoLanguageModule,\r\n    IgoKeyValueModule,\r\n    RouterModule,\r\n    IgoImageModule,\r\n    MatTooltipModule\r\n  ],\r\n  exports: [\r\n    FeatureDetailsComponent,\r\n    FeatureDetailsCustomComponent,\r\n    FeatureDetailsDirective],\r\n  declarations: [\r\n    FeatureDetailsComponent,\r\n    FeatureDetailsCustomComponent,\r\n    FeatureDetailsDirective]\r\n})\r\nexport class IgoFeatureDetailsModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { IgoFeatureDetailsModule } from './feature-details/feature-details.module';\r\nimport { IgoFeatureFormModule } from '@igo2/geo';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule\r\n  ],\r\n  exports: [\r\n    IgoFeatureDetailsModule,\r\n    IgoFeatureFormModule\r\n  ],\r\n  declarations: [],\r\n  providers: []\r\n})\r\nexport class IgoFeatureModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatTooltipModule } from '@angular/material/tooltip';\r\nimport { IgoStopPropagationModule } from '@igo2/common';\r\nimport { IgoLanguageModule } from '@igo2/core';\r\nimport { IgoSearchResultsModule } from '@igo2/geo';\r\nimport { IgoFeatureModule } from '../feature.module';\r\nimport { FeatureInfoComponent } from './feature-info.component';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    MatIconModule,\r\n    MatButtonModule,\r\n    MatTooltipModule,\r\n    IgoLanguageModule,\r\n    IgoStopPropagationModule,\r\n    IgoFeatureModule,\r\n    IgoSearchResultsModule\r\n  ],\r\n  exports: [FeatureInfoComponent],\r\n  declarations: [FeatureInfoComponent]\r\n})\r\nexport class AppFeatureInfoModule {}\r\n","import { IgoAppSearchModule } from '@igo2/integration';\r\nimport { IgoAppSearchResultsToolModule } from './search-results-tool/search-results-tool.module';\r\nimport { MatCardModule } from '@angular/material/card';\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatSidenavModule } from '@angular/material/sidenav';\r\nimport { MatTooltipModule } from '@angular/material/tooltip';\r\nimport {MatExpansionModule} from '@angular/material/expansion'; // mobile\r\nimport { IgoLanguageModule } from '@igo2/core';\r\nimport { IgoMessageModule } from '@igo2/core';\r\nimport { AppFeatureInfoModule} from './feature/feature-info/feature-info.module';\r\nimport { IgoFeatureModule } from './feature/feature.module';\r\nimport { IgoFeatureDetailsModule} from './feature/feature-details/feature-details.module';\r\n\r\nimport {\r\n  IgoPanelModule,\r\n  IgoFlexibleModule,\r\n  IgoToolModule,\r\n  IgoActionbarModule,\r\n  IgoContextMenuModule\r\n} from '@igo2/common';\r\nimport {\r\n  IgoMapModule,\r\n  IgoSearchModule,\r\n  IgoLayerModule,\r\n  IgoSearchResultsModule\r\n} from '@igo2/geo';\r\nimport { IgoContextManagerModule } from '@igo2/context';\r\nimport { SidePanelComponent } from './sidepanel/sidepanel.component';\r\nimport { BottomPanelComponent } from './bottompanel/bottompanel.component';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    MatIconModule,\r\n    MatButtonModule,\r\n    MatSidenavModule,\r\n    MatTooltipModule,\r\n    IgoLanguageModule,\r\n    IgoPanelModule,\r\n    IgoFlexibleModule,\r\n    IgoContextManagerModule,\r\n    IgoToolModule,\r\n    //SEARCH\r\n    MatCardModule,\r\n    IgoMessageModule,\r\n    IgoMapModule,\r\n    IgoSearchModule,\r\n    IgoActionbarModule,\r\n    IgoContextMenuModule,\r\n    IgoAppSearchModule,\r\n    IgoSearchModule.forRoot(),\r\n    IgoAppSearchResultsToolModule,\r\n    MatExpansionModule,\r\n    AppFeatureInfoModule,\r\n    IgoFeatureModule,\r\n    IgoFeatureDetailsModule,\r\n    IgoLayerModule,\r\n    IgoSearchResultsModule\r\n  ],\r\n  exports: [SidePanelComponent, BottomPanelComponent],\r\n  //SEARCH\r\n  declarations: [SidePanelComponent, BottomPanelComponent]\r\n})\r\nexport class AppPanelsModule {}\r\n","import { LegendButtonModule } from './legend-button/legend-button.module';\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatTooltipModule } from '@angular/material/tooltip';\r\nimport { MatDialogModule } from '@angular/material/dialog';\r\nimport { LegendDialogModule} from './legend-dialog/legend-dialog.module';\r\nimport { IgoCoreModule } from '@igo2/core';\r\nimport {\r\n  IgoActionModule,\r\n  IgoWorkspaceModule,\r\n  IgoEntityModule,\r\n  IgoPanelModule,\r\n  IgoBackdropModule,\r\n  IgoFlexibleModule,\r\n  IgoContextMenuModule,\r\n  IgoToolModule,\r\n  IgoEntityTableModule,\r\n  IgoEntityTablePaginatorModule\r\n} from '@igo2/common';\r\n\r\nimport {\r\n  IgoGeoWorkspaceModule,\r\n  IgoFeatureModule,\r\n  IgoImportExportModule,\r\n  IgoMapModule,\r\n  IgoQueryModule,\r\n  IgoLayerModule,\r\n  IgoSearchModule\r\n} from '@igo2/geo';\r\nimport {\r\n  IgoContextManagerModule,\r\n  IgoContextMapButtonModule\r\n} from '@igo2/context';\r\n\r\nimport { MatSidenavModule } from '@angular/material/sidenav';\r\nimport { IgoAppSearchBarModule, IgoIntegrationModule } from '@igo2/integration';\r\nimport { MapOverlayModule } from './map-overlay/map-overlay.module';\r\n\r\nimport { PortalComponent } from './portal.component';\r\nimport { FooterModule } from './../footer/footer.module';\r\nimport { AppPanelsModule } from './panels/panels.module';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    MatTooltipModule,\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    IgoCoreModule,\r\n    IgoFeatureModule,\r\n    IgoMapModule,\r\n    IgoEntityModule,\r\n    IgoFlexibleModule,\r\n    IgoIntegrationModule,\r\n    IgoContextManagerModule,\r\n    FooterModule,\r\n    IgoLayerModule,\r\n    IgoWorkspaceModule,\r\n    IgoGeoWorkspaceModule,\r\n    IgoQueryModule.forRoot(),\r\n    IgoSearchModule.forRoot(),\r\n    IgoContextMapButtonModule,\r\n    MatDialogModule,\r\n    IgoActionModule,\r\n    IgoImportExportModule,\r\n    MapOverlayModule,\r\n    AppPanelsModule,\r\n    IgoPanelModule,\r\n    IgoBackdropModule,\r\n    IgoContextMenuModule,\r\n    IgoToolModule,\r\n    IgoEntityTableModule,\r\n    IgoEntityTablePaginatorModule,\r\n    LegendDialogModule,\r\n    MatSidenavModule,\r\n    IgoAppSearchBarModule,\r\n    IgoSearchModule,\r\n    LegendButtonModule\r\n  ],\r\n  exports: [PortalComponent],\r\n  declarations: [PortalComponent]\r\n})\r\nexport class PortalModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { MenuComponent } from './menu.component';\r\nimport { HomeComponent } from './menu-pages/home/home.component';\r\nimport { MenuRoutingModule } from './menu-routing/menu-routing.module';\r\nimport { AboutComponent } from './menu-pages/about/about.component';\r\nimport { MapComponent } from './menu-pages/map/map.component';\r\nimport { HeaderModule } from '../header/header.module';\r\nimport { FooterModule } from '../footer/footer.module';\r\nimport { PortalModule } from '../portal';\r\nimport { MatToolbarModule } from '@angular/material/toolbar';\r\n@NgModule({\r\n  declarations: [\r\n    MenuComponent,\r\n    HomeComponent,\r\n    AboutComponent,\r\n    MapComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    MenuRoutingModule,\r\n    PortalModule,\r\n    HeaderModule,\r\n    FooterModule,\r\n    MatToolbarModule\r\n  ],\r\n  exports:[\r\n    MenuComponent,\r\n    MenuRoutingModule\r\n  ]\r\n})\r\nexport class MenuModule { }\r\n","import { LanguageOptions } from '@igo2/core';\r\nimport {\r\n  Projection,\r\n  SearchSourceOptions,\r\n  CommonVectorStyleOptions\r\n} from '@igo2/geo';\r\n\r\nimport { AppOptions } from './environnement.interface';\r\ninterface Environment {\r\n  production: boolean;\r\n  igo: {\r\n    app: AppOptions,\r\n    language?: LanguageOptions;\r\n    projections?: Projection[];\r\n    searchSources?: { [key: string]: SearchSourceOptions };\r\n    queryOverlayStyle?: {\r\n      base?: CommonVectorStyleOptions,\r\n      selection?: CommonVectorStyleOptions,\r\n      focus?: CommonVectorStyleOptions\r\n    };\r\n    searchOverlayStyle?: {\r\n      base?: CommonVectorStyleOptions,\r\n      selection?: CommonVectorStyleOptions,\r\n      focus?: CommonVectorStyleOptions\r\n    };\r\n  };\r\n}\r\n\r\nexport const environment: Environment = {\r\n  production: true,\r\n  igo: {\r\n    app: {\r\n      forceCoordsNA: false,\r\n      install: {\r\n        enabled: true,\r\n        promote: true,\r\n        manifestPath: './config/github.webmanifest'\r\n      },\r\n      pwa: {\r\n        enabled: false,\r\n      }\r\n    },\r\n    language: {\r\n      prefix: ['./locale/']\r\n    },\r\n    searchSources: {\r\n      nominatim: {\r\n        available: false\r\n      },\r\n      storedqueries: {\r\n        enabled: false,\r\n        available: false\r\n      },\r\n      icherche: {\r\n        searchUrl: 'https://geoegl.msp.gouv.qc.ca/apis/icherche',\r\n        order: 2,\r\n        params: {\r\n          limit: '5'\r\n        }\r\n      },\r\n      coordinatesreverse: {\r\n        showInPointerSummary: true\r\n      },\r\n      icherchereverse: {\r\n        showInPointerSummary: true,\r\n        searchUrl: 'https://geoegl.msp.gouv.qc.ca/apis/terrapi',\r\n        order: 3,\r\n        enabled: true\r\n      },\r\n      ilayer: {\r\n        searchUrl: 'https://geoegl.msp.gouv.qc.ca/apis/icherche/layers',\r\n        order: 4,\r\n        params: {\r\n          limit: '3'\r\n        }\r\n      }\r\n    },\r\n    projections: [\r\n      {\r\n        code: 'EPSG:32198',\r\n        alias: 'Quebec Lambert',\r\n        def:\r\n          '+proj=lcc +lat_1=60 +lat_2=46 +lat_0=44 +lon_0=-68.5 +x_0=0 +y_0=0 \\\r\n          +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs',\r\n        extent: [-799574, 45802, 891595.4, 1849567.5]\r\n      },\r\n      {\r\n        code: 'EPSG:3798',\r\n        alias: 'MTQ Lambert',\r\n        def:\r\n          '+proj=lcc +lat_1=50 +lat_2=46 +lat_0=44 +lon_0=-70 +x_0=800000 +y_0=0 \\\r\n          +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs',\r\n        extent: [31796.5834, 158846.2231, 1813323.4284, 2141241.0978]\r\n      }\r\n    ],\r\n    searchOverlayStyle: {\r\n      base: {\r\n        markerColor: '#5ed0fb', // marker fill\r\n        markerOpacity: 0.8, // marker opacity not applied if a rgba markerColor is provided\r\n        markerOutlineColor: '#a7e7ff', // marker contour\r\n        fillColor: '#5ed0fb', // poly\r\n        fillOpacity: 0.2, // poly fill opacity not applied if a rgba fillColor is provided\r\n        strokeColor: '#5ed0fb', // line and poly\r\n        strokeOpacity: 0.7, // line and poly not applied if a rgba strokeColor is provided\r\n        strokeWidth: 2 // line and poly\r\n      },\r\n      focus: {\r\n        markerColor: '#5ed0fb', // marker fill\r\n        markerOpacity: 1, // marker opacity not applied if a rgba markerColor is provided\r\n        markerOutlineColor: '#DFF7FF', // marker contour\r\n        fillColor: '#5ed0fb', // poly\r\n        fillOpacity: 0.3, // poly fill opacity not applied if a rgba fillColor is provided\r\n        strokeColor: '#DFF7FF', // line and poly\r\n        strokeOpacity: 1, // line and poly not applied if a rgba strokeColor is provided\r\n        strokeWidth: 2 // line and poly\r\n      },\r\n      selection: {\r\n        markerColor: '#00a1de', // marker fill\r\n        markerOpacity: 1, // marker opacity not applied if a rgba markerColor is provided\r\n        markerOutlineColor: '#ffffff', // marker contour\r\n        fillColor: '#00a1de', // poly\r\n        fillOpacity: 0.3, // poly fill opacity not applied if a rgba fillColor is provided\r\n        strokeColor: '#00A1DE', // line and poly\r\n        strokeOpacity: 1, // line and poly not applied if a rgba strokeColor is provided\r\n        strokeWidth: 2 // line and poly\r\n      }\r\n    },\r\n    queryOverlayStyle: {\r\n      base: {\r\n        markerColor: '#5ed0fb', // marker fill\r\n        markerOpacity: 0.8, // marker opacity not applied if a rgba markerColor is provided\r\n        markerOutlineColor: '#a7e7ff', // marker contour\r\n        fillColor: '#5ed0fb', // poly\r\n        fillOpacity: 0.2, // poly fill opacity not applied if a rgba fillColor is provided\r\n        strokeColor: '#5ed0fb', // line and poly\r\n        strokeOpacity: 0.7, // line and poly not applied if a rgba strokeColor is provided\r\n        strokeWidth: 2 // line and poly\r\n      },\r\n      focus: {\r\n        markerColor: '#5ed0fb', // marker fill\r\n        markerOpacity: 1, // marker opacity not applied if a rgba markerColor is provided\r\n        markerOutlineColor: '#DFF7FF', // marker contour\r\n        fillColor: '#5ed0fb', // poly\r\n        fillOpacity: 0.3, // poly fill opacity not applied if a rgba fillColor is provided\r\n        strokeColor: '#DFF7FF', // line and poly\r\n        strokeOpacity: 1, // line and poly not applied if a rgba strokeColor is provided\r\n        strokeWidth: 2 // line and poly\r\n      },\r\n      selection: {\r\n        markerColor: '#00a1de', // marker fill\r\n        markerOpacity: 1, // marker opacity not applied if a rgba markerColor is provided\r\n        markerOutlineColor: '#ffffff', // marker contour\r\n        fillColor: '#00a1de', // poly\r\n        fillOpacity: 0.3, // poly fill opacity not applied if a rgba fillColor is provided\r\n        strokeColor: '#00A1DE', // line and poly\r\n        strokeOpacity: 1, // line and poly not applied if a rgba strokeColor is provided\r\n        strokeWidth: 2 // line and poly\r\n      }\r\n    }\r\n  }\r\n};\r\n","import { Component } from '@angular/core';\r\nimport { ConfigService, LanguageService } from '@igo2/core';\r\n\r\n@Component({\r\n  selector: 'app-header',\r\n  templateUrl: './header.component.html',\r\n  styleUrls: ['./header.component.scss']\r\n})\r\nexport class HeaderComponent {\r\n\r\n  public headerLogo: string;\r\n  public headerLogoPrint: string;\r\n\r\n  constructor(\r\n    private configService: ConfigService,\r\n    protected languageService: LanguageService) {\r\n      this.computeHeader();\r\n    }\r\n\r\n  computeHeader() {\r\n    this.headerLogo = this.configService.getConfig('header.logo');\r\n    this.headerLogoPrint = this.configService.getConfig('header.logoPrint');\r\n  }\r\n\r\n  // Future translation system\r\n  /*changeLanguage() {\r\n    if (this.languageService.getLanguage() === 'fr'){\r\n      this.languageService.setLanguage('en');\r\n    } else {\r\n      this.languageService.setLanguage('fr');\r\n    }\r\n  }*/\r\n\r\n}\r\n","<mat-toolbar class = banner role = banner color=\"primary\">\r\n\t<div class=\"container\">\r\n\t\t<div class=\"row\">\r\n\t\t\t<div class=\"col-6 col-md-10 d-flex flex-wrap align-items-center zone-logo-title\">\r\n\t\t\t\t<a class=\"logo\" tabindex=\"5\" routerLink=\"\">\r\n                    <img id=\"header-logo\" alt=\"Logo\" src=\"{{headerLogo}}\">\r\n\t\t\t\t\t\r\n                </a>\r\n\t\t\t\t<img id=\"header-logo-print\" alt=\"Logo\" src=\"{{headerLogoPrint}}\" width=\"199\" height=\"60\" />\r\n\t\t\t\t<p lang=\"fr\" id=\"title-desktop\" class=\"zone-title  d-none d-md-block\">{{'header.title' | translate}}</p>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"col-6 col-md-2 d-flex justify-content-end zone-links\">\r\n\t\t\t\t<ul class=\"nav flex-column\">\r\n\t\t\t\t\t<!--<li><button class=\"buttonLanguage\" disabled (click)=\"changeLanguage()\">{{'header.language'}}</button></li>-->\r\n\t\t\t\t\t<li><a rel=\"noopener noreferrer\" alt=\"('header.contactUsUrl' | translate)\" href=\"{{'header.contactUsUrl' | translate}}\" target=\"_blank\">{{'header.contactUs' | translate}}</a></li>\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t\t<p lang=\"fr\" id=\"title-mobile\" class=\"zone-title d-md-none col-12\"><a>{{'header.title' | translate}}</a></p>\r\n\t\t</div>\r\n\t</div>\r\n</mat-toolbar>","import { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-menu',\r\n  templateUrl: './menu.component.html',\r\n  styleUrls: ['./menu.component.scss']\r\n})\r\nexport class MenuComponent {\r\n  public color = 'accent';\r\n\r\n  constructor() { }\r\n\r\n}\r\n","<mat-toolbar class=\"container headline\" color=\"accent\">\r\n  <div class=\"col-12 align-self-end\">\r\n    <nav class=\"navbar\">\r\n      <a class=\"nav-link nav-arrow left\" href=\"#menu-left\" routerLinkActive=\"active\">❮</a>\r\n      <div class=\"main-nav slick-track\">\r\n          <a class=\"nav-link\" routerLink=\"/\" routerLinkActive=\"active\" id=\"menu-left\" [routerLinkActiveOptions]=\"{exact:true}\">Accueil</a>\r\n          <a class=\"nav-link\" routerLink=\"/carte\" routerLinkActive=\"active\">Carte</a>\r\n          <a class=\"nav-link\" routerLink=\"/en-savoir-plus\" id=\"menu-right\" routerLinkActive=\"active\">En savoir plus</a>\r\n      </div>\r\n      <a class=\"nav-link nav-arrow right\" color=\"accent\" href=\"#menu-right\" routerLinkActive=\"active\">❯</a>\r\n    </nav>\r\n  </div>\r\n</mat-toolbar>\r\n<router-outlet></router-outlet>\r\n","<igo-spinner igoSpinnerActivity></igo-spinner>\r\n\r\n<app-header *ngIf=\"hasHeader\" #header></app-header>\r\n\r\n<app-menu *ngIf=\"hasMenu\"></app-menu>\r\n\r\n<app-portal *ngIf=\"!hasMenu\" [ngClass]=\"hasHeader? 'portal-hasHeader': 'portal'\"></app-portal>","import { Component, ElementRef, Renderer2, ViewChild } from '@angular/core';\r\nimport { Title, Meta } from '@angular/platform-browser';\r\nimport { userAgent } from '@igo2/utils';\r\nimport {\r\n  LanguageService,\r\n  ConfigService,\r\n  MessageService\r\n} from '@igo2/core';\r\nimport { AuthOptions } from '@igo2/auth';\r\nimport { PwaService } from './services/pwa.service';\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: './app.component.html',\r\n  styleUrls: ['./app.component.scss']\r\n})\r\nexport class AppComponent {\r\n  public authConfig: AuthOptions;\r\n  private themeClass = 'qcca-theme';\r\n  public hasHeader: boolean = true;\r\n  public hasFooter: boolean = true;\r\n  private promptEvent: any;\r\n  public hasMenu: boolean = false;\r\n\r\n  @ViewChild('searchBar', { read: ElementRef, static: true })\r\n  searchBar: ElementRef;\r\n\r\n  constructor(\r\n    protected languageService: LanguageService,\r\n    private configService: ConfigService,\r\n    private renderer: Renderer2,\r\n    private titleService: Title,\r\n    private metaService: Meta,\r\n    private messageService: MessageService,\r\n    private pwaService: PwaService\r\n  ) {\r\n    this.readTitleConfig();\r\n    this.readThemeConfig();\r\n    this.readDescriptionConfig();\r\n\r\n    this.detectOldBrowser();\r\n\r\n    this.hasHeader = this.configService.getConfig('header.hasHeader') === undefined ? false :\r\n      this.configService.getConfig('header.hasHeader');\r\n\r\n    this.hasFooter = this.configService.getConfig('hasFooter') === undefined ? false :\r\n      this.configService.getConfig('hasFooter');\r\n\r\n    this.hasMenu = this.configService.getConfig('hasMenu') === undefined ? false :\r\n      this.configService.getConfig('hasMenu');\r\n\r\n    this.setManifest();\r\n    this.installPrompt();\r\n    this.pwaService.checkForUpdates();\r\n  }\r\n\r\n  private readTitleConfig() {\r\n    this.languageService.translate.get(this.configService.getConfig('title')).subscribe(title => {\r\n      if (title) {\r\n        this.titleService.setTitle(title);\r\n        this.metaService.addTag({ name: 'title', content: title });\r\n      }\r\n    });\r\n  }\r\n\r\n  private setManifest() {\r\n    const appConfig = this.configService.getConfig('app');\r\n    if (appConfig?.install?.enabled) {\r\n      const manifestPath = appConfig.install.manifestPath || 'manifest.webmanifest';\r\n      document.querySelector('#igoManifestByConfig').setAttribute('href', manifestPath);\r\n    }\r\n  }\r\n\r\n  private installPrompt() {\r\n    const appConfig = this.configService.getConfig('app');\r\n    if (appConfig?.install?.enabled && appConfig?.install?.promote) {\r\n      if (userAgent.getOSName() !== 'iOS') {\r\n        window.addEventListener('beforeinstallprompt', (event: any) => {\r\n          event.preventDefault();\r\n          this.promptEvent = event;\r\n          window.addEventListener('click', () => {\r\n            setTimeout(() => {\r\n              this.promptEvent.prompt();\r\n              this.promptEvent = undefined;\r\n            }, 750);\r\n          }, { once: true });\r\n        }, { once: true });\r\n      }\r\n    }\r\n  }\r\n\r\n  private readThemeConfig() {\r\n    const theme = this.configService.getConfig('theme') || this.themeClass;\r\n    if (theme) {\r\n      this.renderer.addClass(document.body, theme);\r\n    }\r\n  }\r\n\r\n  private readDescriptionConfig() {\r\n    const description = this.configService.getConfig('description');\r\n    if (description) {\r\n      this.metaService.addTag({ name: 'description', content: description });\r\n    }\r\n  }\r\n\r\n  private detectOldBrowser() {\r\n    const oldBrowser = userAgent.satisfies({\r\n      ie: '<=11',\r\n      chrome: '<64',\r\n      firefox: '<60',\r\n      safari: '<=11'\r\n    });\r\n\r\n    if (oldBrowser) {\r\n      this.messageService.alert('oldBrowser.message', 'oldBrowser.title', {\r\n        timeOut: 15000\r\n      });\r\n    }\r\n  }\r\n}\r\n","import { BrowserModule, HammerModule } from '@angular/platform-browser';\r\nimport { APP_INITIALIZER, ApplicationRef, Injector, NgModule } from '@angular/core';\r\nimport { RouterModule } from '@angular/router';\r\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\r\nimport { HeaderModule } from './pages/header/header.module';\r\nimport { FooterModule } from './pages/footer/footer.module';\r\nimport { MenuModule } from './pages/menu/menu.module';\r\nimport {\r\n  provideConfigOptions,\r\n  IgoMessageModule,\r\n  IgoGestureModule,\r\n  RouteService,\r\n  LanguageService\r\n} from '@igo2/core';\r\nimport { IgoSpinnerModule, IgoStopPropagationModule } from '@igo2/common';\r\nimport {\r\n  provideIChercheSearchSource,\r\n  provideIChercheReverseSearchSource,\r\n  provideCoordinatesReverseSearchSource,\r\n  provideILayerSearchSource,\r\n  provideOptionsApi,\r\n  provideStyleListOptions,\r\n  provideWorkspaceSearchSource,\r\n  SearchService,\r\n  provideOsrmDirectionsSource,\r\n  provideNominatimSearchSource,\r\n  CoordinatesSearchResultFormatter,\r\n  provideDefaultCoordinatesSearchResultFormatter,\r\n  provideDefaultIChercheSearchResultFormatter,\r\n  provideSearchSourceService,\r\n  IChercheSearchSource\r\n} from '@igo2/geo';\r\n\r\n\r\nimport { environment } from '../environments/environment';\r\nimport { PortalModule } from './pages';\r\nimport { AppComponent } from './app.component';\r\nimport { ServiceWorkerModule } from '@angular/service-worker';\r\n\r\nimport { MAT_TOOLTIP_DEFAULT_OPTIONS, MatTooltipDefaultOptions } from '@angular/material/tooltip';\r\nimport { concatMap, first } from 'rxjs';\r\n\r\nexport const defaultTooltipOptions: MatTooltipDefaultOptions = {\r\n  showDelay: 500,\r\n  hideDelay: 0,\r\n  touchendHideDelay: 0,\r\n  disableTooltipInteractivity: true\r\n};\r\n\r\n@NgModule({\r\n  declarations: [AppComponent],\r\n  imports: [\r\n    BrowserModule,\r\n    BrowserAnimationsModule,\r\n    RouterModule.forRoot([]),\r\n    IgoGestureModule.forRoot(),\r\n    IgoMessageModule,\r\n    IgoSpinnerModule,\r\n    IgoStopPropagationModule,\r\n    PortalModule,\r\n    HammerModule,\r\n    HeaderModule,\r\n    FooterModule,\r\n    MenuModule,\r\n    ServiceWorkerModule.register('ngsw-worker.js', {\r\n      enabled: environment.igo.app.pwa.enabled,\r\n      registrationStrategy: 'registerWithDelay:5000'\r\n    })\r\n  ],\r\n  providers: [\r\n    provideConfigOptions({\r\n      default: environment.igo,\r\n      path: './config/config.json'\r\n    }),\r\n    provideCoordinatesReverseSearchSource(),\r\n    provideIChercheSearchSource(),\r\n    provideNominatimSearchSource(),\r\n    provideIChercheReverseSearchSource(),\r\n    provideILayerSearchSource(),\r\n    provideOsrmDirectionsSource(),\r\n    provideOptionsApi(),\r\n    CoordinatesSearchResultFormatter,\r\n    provideDefaultCoordinatesSearchResultFormatter(),\r\n    provideDefaultIChercheSearchResultFormatter(),\r\n    provideSearchSourceService(),\r\n    SearchService,\r\n    IChercheSearchSource,\r\n    provideStyleListOptions({\r\n      path: './assets/list-style.json'\r\n    }),\r\n    RouteService,\r\n    provideWorkspaceSearchSource(),\r\n    {\r\n      provide: APP_INITIALIZER,\r\n      useFactory: appInitializerFactory,\r\n      deps: [Injector, ApplicationRef],\r\n      multi: true\r\n    },\r\n    provideStyleListOptions({\r\n      path: './assets/list-style.json'\r\n    }),\r\n    { provide: MAT_TOOLTIP_DEFAULT_OPTIONS, useValue: defaultTooltipOptions }\r\n  ],\r\n  bootstrap: [AppComponent]\r\n})\r\nexport class AppModule { }\r\n\r\nfunction appInitializerFactory(\r\n  injector: Injector,\r\n  applicationRef: ApplicationRef\r\n) {\r\n  // ensure to have the proper translations loaded once, whe the app is stable.\r\n  return () => new Promise<any>((resolve: any) => {\r\n    applicationRef.isStable.pipe(\r\n      first(isStable => isStable === true),\r\n      concatMap(() => {\r\n        const languageService = injector.get(LanguageService);\r\n        const lang = languageService.getLanguage();\r\n        return languageService.translate.getTranslation(lang);\r\n      }))\r\n      .subscribe((translations) => {\r\n        const languageService = injector.get(LanguageService);\r\n        const lang = languageService.getLanguage();\r\n        languageService.translate.setTranslation(lang, translations);\r\n        resolve();\r\n      });\r\n  });\r\n}\r\n","import { enableProdMode } from '@angular/core';\r\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\n\r\nimport { AppModule } from './app/app.module';\r\nimport { environment } from './environments/environment';\r\n\r\nimport 'hammerjs';\r\n\r\nif (environment.production) {\r\n  enableProdMode();\r\n}\r\n\r\nplatformBrowserDynamic()\r\n  .bootstrapModule(AppModule)\r\n  .catch(err => console.log(err));\r\n","var map = {\n\t\"./af\": 58685,\n\t\"./af.js\": 58685,\n\t\"./ar\": 254,\n\t\"./ar-dz\": 4312,\n\t\"./ar-dz.js\": 4312,\n\t\"./ar-kw\": 32614,\n\t\"./ar-kw.js\": 32614,\n\t\"./ar-ly\": 18630,\n\t\"./ar-ly.js\": 18630,\n\t\"./ar-ma\": 28674,\n\t\"./ar-ma.js\": 28674,\n\t\"./ar-sa\": 49032,\n\t\"./ar-sa.js\": 49032,\n\t\"./ar-tn\": 24730,\n\t\"./ar-tn.js\": 24730,\n\t\"./ar.js\": 254,\n\t\"./az\": 53052,\n\t\"./az.js\": 53052,\n\t\"./be\": 60150,\n\t\"./be.js\": 60150,\n\t\"./bg\": 63069,\n\t\"./bg.js\": 63069,\n\t\"./bm\": 13466,\n\t\"./bm.js\": 13466,\n\t\"./bn\": 18516,\n\t\"./bn-bd\": 90557,\n\t\"./bn-bd.js\": 90557,\n\t\"./bn.js\": 18516,\n\t\"./bo\": 26273,\n\t\"./bo.js\": 26273,\n\t\"./br\": 9588,\n\t\"./br.js\": 9588,\n\t\"./bs\": 19815,\n\t\"./bs.js\": 19815,\n\t\"./ca\": 83331,\n\t\"./ca.js\": 83331,\n\t\"./cs\": 21320,\n\t\"./cs.js\": 21320,\n\t\"./cv\": 72219,\n\t\"./cv.js\": 72219,\n\t\"./cy\": 68266,\n\t\"./cy.js\": 68266,\n\t\"./da\": 66427,\n\t\"./da.js\": 66427,\n\t\"./de\": 67435,\n\t\"./de-at\": 52871,\n\t\"./de-at.js\": 52871,\n\t\"./de-ch\": 12994,\n\t\"./de-ch.js\": 12994,\n\t\"./de.js\": 67435,\n\t\"./dv\": 82357,\n\t\"./dv.js\": 82357,\n\t\"./el\": 95649,\n\t\"./el.js\": 95649,\n\t\"./en-au\": 59961,\n\t\"./en-au.js\": 59961,\n\t\"./en-ca\": 19878,\n\t\"./en-ca.js\": 19878,\n\t\"./en-gb\": 3924,\n\t\"./en-gb.js\": 3924,\n\t\"./en-ie\": 70864,\n\t\"./en-ie.js\": 70864,\n\t\"./en-il\": 91579,\n\t\"./en-il.js\": 91579,\n\t\"./en-in\": 30940,\n\t\"./en-in.js\": 30940,\n\t\"./en-nz\": 16181,\n\t\"./en-nz.js\": 16181,\n\t\"./en-sg\": 44301,\n\t\"./en-sg.js\": 44301,\n\t\"./eo\": 85291,\n\t\"./eo.js\": 85291,\n\t\"./es\": 54529,\n\t\"./es-do\": 53764,\n\t\"./es-do.js\": 53764,\n\t\"./es-mx\": 12584,\n\t\"./es-mx.js\": 12584,\n\t\"./es-us\": 63425,\n\t\"./es-us.js\": 63425,\n\t\"./es.js\": 54529,\n\t\"./et\": 35203,\n\t\"./et.js\": 35203,\n\t\"./eu\": 70678,\n\t\"./eu.js\": 70678,\n\t\"./fa\": 83483,\n\t\"./fa.js\": 83483,\n\t\"./fi\": 96262,\n\t\"./fi.js\": 96262,\n\t\"./fil\": 52521,\n\t\"./fil.js\": 52521,\n\t\"./fo\": 34555,\n\t\"./fo.js\": 34555,\n\t\"./fr\": 63131,\n\t\"./fr-ca\": 88239,\n\t\"./fr-ca.js\": 88239,\n\t\"./fr-ch\": 21702,\n\t\"./fr-ch.js\": 21702,\n\t\"./fr.js\": 63131,\n\t\"./fy\": 267,\n\t\"./fy.js\": 267,\n\t\"./ga\": 23821,\n\t\"./ga.js\": 23821,\n\t\"./gd\": 71753,\n\t\"./gd.js\": 71753,\n\t\"./gl\": 4074,\n\t\"./gl.js\": 4074,\n\t\"./gom-deva\": 92762,\n\t\"./gom-deva.js\": 92762,\n\t\"./gom-latn\": 5969,\n\t\"./gom-latn.js\": 5969,\n\t\"./gu\": 82809,\n\t\"./gu.js\": 82809,\n\t\"./he\": 45402,\n\t\"./he.js\": 45402,\n\t\"./hi\": 315,\n\t\"./hi.js\": 315,\n\t\"./hr\": 10410,\n\t\"./hr.js\": 10410,\n\t\"./hu\": 38288,\n\t\"./hu.js\": 38288,\n\t\"./hy-am\": 67928,\n\t\"./hy-am.js\": 67928,\n\t\"./id\": 71334,\n\t\"./id.js\": 71334,\n\t\"./is\": 86959,\n\t\"./is.js\": 86959,\n\t\"./it\": 34864,\n\t\"./it-ch\": 51124,\n\t\"./it-ch.js\": 51124,\n\t\"./it.js\": 34864,\n\t\"./ja\": 36141,\n\t\"./ja.js\": 36141,\n\t\"./jv\": 29187,\n\t\"./jv.js\": 29187,\n\t\"./ka\": 42136,\n\t\"./ka.js\": 42136,\n\t\"./kk\": 94332,\n\t\"./kk.js\": 94332,\n\t\"./km\": 18607,\n\t\"./km.js\": 18607,\n\t\"./kn\": 84305,\n\t\"./kn.js\": 84305,\n\t\"./ko\": 70234,\n\t\"./ko.js\": 70234,\n\t\"./ku\": 16003,\n\t\"./ku.js\": 16003,\n\t\"./ky\": 75061,\n\t\"./ky.js\": 75061,\n\t\"./lb\": 32786,\n\t\"./lb.js\": 32786,\n\t\"./lo\": 66183,\n\t\"./lo.js\": 66183,\n\t\"./lt\": 50029,\n\t\"./lt.js\": 50029,\n\t\"./lv\": 24169,\n\t\"./lv.js\": 24169,\n\t\"./me\": 68577,\n\t\"./me.js\": 68577,\n\t\"./mi\": 68177,\n\t\"./mi.js\": 68177,\n\t\"./mk\": 50337,\n\t\"./mk.js\": 50337,\n\t\"./ml\": 65260,\n\t\"./ml.js\": 65260,\n\t\"./mn\": 52325,\n\t\"./mn.js\": 52325,\n\t\"./mr\": 14695,\n\t\"./mr.js\": 14695,\n\t\"./ms\": 75334,\n\t\"./ms-my\": 37151,\n\t\"./ms-my.js\": 37151,\n\t\"./ms.js\": 75334,\n\t\"./mt\": 63570,\n\t\"./mt.js\": 63570,\n\t\"./my\": 97963,\n\t\"./my.js\": 97963,\n\t\"./nb\": 88028,\n\t\"./nb.js\": 88028,\n\t\"./ne\": 86638,\n\t\"./ne.js\": 86638,\n\t\"./nl\": 50302,\n\t\"./nl-be\": 66782,\n\t\"./nl-be.js\": 66782,\n\t\"./nl.js\": 50302,\n\t\"./nn\": 33501,\n\t\"./nn.js\": 33501,\n\t\"./oc-lnc\": 50563,\n\t\"./oc-lnc.js\": 50563,\n\t\"./pa-in\": 50869,\n\t\"./pa-in.js\": 50869,\n\t\"./pl\": 65302,\n\t\"./pl.js\": 65302,\n\t\"./pt\": 49687,\n\t\"./pt-br\": 74884,\n\t\"./pt-br.js\": 74884,\n\t\"./pt.js\": 49687,\n\t\"./ro\": 79107,\n\t\"./ro.js\": 79107,\n\t\"./ru\": 33627,\n\t\"./ru.js\": 33627,\n\t\"./sd\": 30355,\n\t\"./sd.js\": 30355,\n\t\"./se\": 83427,\n\t\"./se.js\": 83427,\n\t\"./si\": 11848,\n\t\"./si.js\": 11848,\n\t\"./sk\": 54590,\n\t\"./sk.js\": 54590,\n\t\"./sl\": 20184,\n\t\"./sl.js\": 20184,\n\t\"./sq\": 56361,\n\t\"./sq.js\": 56361,\n\t\"./sr\": 78965,\n\t\"./sr-cyrl\": 81287,\n\t\"./sr-cyrl.js\": 81287,\n\t\"./sr.js\": 78965,\n\t\"./ss\": 25456,\n\t\"./ss.js\": 25456,\n\t\"./sv\": 70451,\n\t\"./sv.js\": 70451,\n\t\"./sw\": 77558,\n\t\"./sw.js\": 77558,\n\t\"./ta\": 51356,\n\t\"./ta.js\": 51356,\n\t\"./te\": 73693,\n\t\"./te.js\": 73693,\n\t\"./tet\": 21243,\n\t\"./tet.js\": 21243,\n\t\"./tg\": 42500,\n\t\"./tg.js\": 42500,\n\t\"./th\": 55768,\n\t\"./th.js\": 55768,\n\t\"./tk\": 77761,\n\t\"./tk.js\": 77761,\n\t\"./tl-ph\": 35780,\n\t\"./tl-ph.js\": 35780,\n\t\"./tlh\": 29590,\n\t\"./tlh.js\": 29590,\n\t\"./tr\": 33807,\n\t\"./tr.js\": 33807,\n\t\"./tzl\": 93857,\n\t\"./tzl.js\": 93857,\n\t\"./tzm\": 60654,\n\t\"./tzm-latn\": 8806,\n\t\"./tzm-latn.js\": 8806,\n\t\"./tzm.js\": 60654,\n\t\"./ug-cn\": 30845,\n\t\"./ug-cn.js\": 30845,\n\t\"./uk\": 19232,\n\t\"./uk.js\": 19232,\n\t\"./ur\": 47052,\n\t\"./ur.js\": 47052,\n\t\"./uz\": 77967,\n\t\"./uz-latn\": 32233,\n\t\"./uz-latn.js\": 32233,\n\t\"./uz.js\": 77967,\n\t\"./vi\": 98615,\n\t\"./vi.js\": 98615,\n\t\"./x-pseudo\": 12320,\n\t\"./x-pseudo.js\": 12320,\n\t\"./yo\": 31313,\n\t\"./yo.js\": 31313,\n\t\"./zh-cn\": 64490,\n\t\"./zh-cn.js\": 64490,\n\t\"./zh-hk\": 55910,\n\t\"./zh-hk.js\": 55910,\n\t\"./zh-mo\": 98262,\n\t\"./zh-mo.js\": 98262,\n\t\"./zh-tw\": 44223,\n\t\"./zh-tw.js\": 44223\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 46700;"],"x_google_ignoreList":[53]}